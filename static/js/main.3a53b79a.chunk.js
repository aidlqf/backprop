(this["webpackJsonpbackprop-explainer"]=this["webpackJsonpbackprop-explainer"]||[]).push([[0],{176:function(e,t,a){},568:function(e,t){},569:function(e,t){},577:function(e,t){},580:function(e,t){},581:function(e,t){},584:function(e,t,a){},585:function(e,t,a){"use strict";a.r(t);var n={};a.r(n),a.d(n,"formatWeightArray",(function(){return Fe})),a.d(n,"toFunc2DArray",(function(){return Ae})),a.d(n,"flatten",(function(){return Ne})),a.d(n,"getRandomInt",(function(){return Le})),a.d(n,"tensorToArray",(function(){return Ee}));var r={};a.r(r),a.d(r,"generateLinearScale",(function(){return Te})),a.d(r,"generateLink",(function(){return Pe})),a.d(r,"generateNeuronPlacement",(function(){return Be})),a.d(r,"generateLinksPlacement",(function(){return De}));var i=a(10),s=a.n(i),c=a(60),o=a.n(c),l=a(5),h=a(11),d=a(14),u=a(15),j=a(265),b=a(388),p=a(623),x=a(625),f=a(615),m=a(39),O=(a(176),a(1)),y=function(e){var t=e.source,a=e.target,n=e.color,r=e.isAnimating;return Object(O.jsxs)("g",{children:[Object(O.jsx)("defs",{children:Object(O.jsx)("marker",{id:"head",orient:"auto",markerWidth:"3",markerHeight:"4",refX:"0.1",refY:"2",children:Object(O.jsx)("path",{d:"M0,0 V4 L2,2 Z",fill:n})})}),Object(O.jsx)("path",{className:r?"absorb":"arrow",id:"arrow-line",markerEnd:"url(#head)",fill:"none",stroke:n,d:"M".concat(t.x,",").concat(t.y,", ").concat(a.x,", ").concat(a.y)})]})},g=function(e){var t=function(e){return"undefined"===typeof e},a=function(e,a,n,r){return t(e[a])||t(e[a][n])||t(e[a][n][r])},n=function(e,t,a,n,r){var i=n?-a:a;return Object(O.jsx)(y,{source:{x:e,y:t},target:{x:e,y:t+i},color:r,isAnimating:"transition"===h})},r=e.playing,i=e.mode,s=e.shapedLinks,c=e.shapedWeights,o=e.shapedRects,l=e.miniNN,h=e.subEpoch,d=e.keyFrameLoss,u=e.keyFrameLayer,j=e.lr,b=e.isAnimating,p="orange",x="black",f=32,g=m.j().x((function(e){return e.x})).y((function(e){return e.y})),v=Object(O.jsx)("svg",{id:"p",width:"810",height:"500",overflow:"visible",children:Object(O.jsxs)("g",{id:"ee",children:[Object(O.jsx)("path",{d:"M 750, 234 L 750, 300",stroke:2===d||1===d?p:x,className:i&&d>0?1===d?"edgeForward":2===d?"edgeBackward":"edgePaused":r}),Object(O.jsx)("path",{d:g({source:{x:766,y:315},target:{x:890,y:430}}),stroke:x,fill:"none",className:r}),Object(O.jsx)("path",{d:g({source:{x:766,y:250},target:{x:890,y:150}}),stroke:x,fill:"none",className:r}),s.map((function(e,t){return e.map((function(e,n){var s="edgePaused",o=!1;return i&&"forward"===h&&t===u?(s="edgeForward",o=!0):i&&"backward"===h&&t===u&&(s="edgeBackward",o=!0),e.map((function(e,d){var u=a(c,t,n,d),j=u?[]:c[t][n][d],p=u?1:2*Math.abs(j)+.1,x=u?"lightgrey":j>0?"#4BA3C3":"#D62839";if(i&&"update"===h&&!0===b){var f=2*l.model[t][n].dWeights[d],y=.01*f;m.q("#nn").select("#p").select("#ee").select("#cpath".concat(t).concat(n).concat(d)).transition().duration(750).ease(m.d).attr("stroke-width",p-f).transition().duration(750).ease(m.e).attr("stroke-width",p-y)}return Object(O.jsx)("path",{id:"cpath".concat(t).concat(n).concat(d),d:e,className:i?s:r,strokeWidth:p,stroke:o?"orange":x,fill:"none"},"".concat(t).concat(n).concat(d))}))}))})),Object(O.jsx)("rect",{x:55,y:234,width:f,height:f,fill:"darkgrey"}),o.map((function(e,t){return e.map((function(e,a){var r=!1,s="backward"===h||"transition"===h;return(i&&t<=u||s||"update"===h)&&(r=!0),Object(O.jsxs)("g",{children:[Object(O.jsx)("rect",{x:e.x,y:e.y,width:f,height:f,fill:734===e.x&&234===e.y&&i?"#C6C6C6":m.n(104,104,104).brighter(r?l.model[t][a].actStep+j:1),stroke:734===e.x&&234===e.y?"#507BB6":"black",strokeWidth:3}),null!==l&&i&&s&&t>=u-1&&0!==l.model[t][a].dActStep?n(e.x+16,e.y+16,Math.abs(l.model[t][a].dActStep),l.model[t][a].dActStep<0,p):""]},"".concat(t,",").concat(a))}))})),Object(O.jsx)("rect",{x:734,y:300,width:f,height:f,fill:"none",stroke:"black"}),Object(O.jsx)("text",{fontFamily:"sans-serif",fontSize:"12px",x:739,y:318,children:"loss"})]})});return Object(O.jsx)("div",{id:"nn",children:v})},v=a(3),w=a.n(v),k=a(13),S=function(e){Object(d.a)(a,e);var t=Object(u.a)(a);function a(){return Object(l.a)(this,a),t.apply(this,arguments)}return Object(h.a)(a,[{key:"plotPoints",value:function(e,t,a){e.selectAll("circle").data(t).enter().append("circle").attr("cx",(function(e){return e.x})).attr("cy",(function(e){return e.y})).attr("r",(function(e,t){return t===a?5:2})).style("fill",(function(e,t){return t===a?"orange":"grey"}))}},{key:"generateScales",value:function(e,t,a,n,r){return{xScale:m.o().domain([e,t]).range([0,a-2*r]),yScale:m.o().domain([e,t]).range([n-2*r,0])}}},{key:"componentDidMount",value:function(){var e=Object(k.a)(w.a.mark((function e(){var t,a,n,r,i,s,c,o,l,h,d,u,j,b;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.props,a=t.width,n=t.height,r=t.padding,i=t.start,s=t.stop,c=t.id,o=m.q("#scatter".concat(c)),(l=o.append("svg").attr("width",a).attr("height",n).style("overflow","visible")).append("rect").attr("width",a).attr("height",n).attr("class","cord"),h=this.generateScales(i,s,a,n,r),d=h.xScale,u=h.yScale,j=m.a().scale(d),b=m.b().scale(u),l.append("g").attr("class","axis").attr("transform","translate(0,".concat(n-2*r,")")).call(j),l.append("g").attr("class","axis").attr("transform","translate("+(a-2*r)+",0)").call(b),l.append("line").attr("x1",0).attr("y1",(n+1)/2).attr("x2",a).attr("y2",(n+1)/2).attr("class","split"),l.append("line").attr("x1",(a+1)/2).attr("y1",0).attr("x2",(a+1)/2).attr("y2",n).attr("class","split"),l.append("path").attr("id","scatterline").attr("stroke","none").attr("fill","none");case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){for(var e=this.props,t=e.width,a=e.height,n=e.padding,r=e.start,i=e.stop,s=e.X,c=e.y,o=e.yhat,l=e.id,h=e.select,d=e.duration,u=this.generateScales(r,i,t,a,n),j=u.xScale,b=u.yScale,p=m.q("#scatter".concat(l)).select("svg"),x=[],f=[],O=0;O<s.length;O++)x.push({x:j(s[O]),y:b(c[O])}),f.push([j(s[O]),b(o[O])]);p.selectAll("circle").remove(),this.plotPoints(p,x,h),p.select("#scatterline").transition().duration(d).attr("d",m.i()(f)).attr("stroke","black").attr("fill","none")}},{key:"render",value:function(){var e=this.props.id;return Object(O.jsx)("div",{id:"scatter".concat(e)})}}]),a}(i.Component),C=function(e){Object(d.a)(a,e);var t=Object(u.a)(a);function a(){return Object(l.a)(this,a),t.apply(this,arguments)}return Object(h.a)(a,[{key:"plotPoints",value:function(e,t,a){var n={x:this.props.X[a],y:this.props.y[a]},r=function(e,t){return e===t},i="#4BA3C3",s=5,c="grey",o=2;e.selectAll("circle").data(t).enter().append("circle").attr("cx",(function(e){return e.x})).attr("cy",(function(e){return e.y})).attr("r",(function(e,t){return r(t,a)?s:o})).style("fill",(function(e,t){return r(t,a)?i:c})),e.append("text").attr("x",t[a].x+10).attr("y",t[a].y).attr("fill",i).attr("font-size","12px").text("(".concat(n.x.toFixed(2),",").concat(n.y.toFixed(2),")"))}},{key:"generateScales",value:function(e,t,a,n,r){return{xScale:m.o().domain([e,t]).range([0,a-2*r]),yScale:m.o().domain([e,t]).range([n-2*r,0])}}},{key:"animateLineChange",value:function(e,t,a,n,r){e.attr("d",m.i()(a)).attr("stroke",t).attr("fill","none"),e.transition().duration(r).attr("d",m.i()(n))}},{key:"componentDidMount",value:function(){var e=Object(k.a)(w.a.mark((function e(){var t,a,n,r,i,s,c,o,l,h,d,u,j,b;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.props,a=t.width,n=t.height,r=t.padding,i=t.start,s=t.stop,c=t.id,o=m.q("#animatedPlot".concat(c)),(l=o.append("svg").attr("width",a).attr("height",n).style("overflow","visible")).append("rect").attr("width",a).attr("height",n).attr("class","cord"),h=this.generateScales(i,s,a,n,r),d=h.xScale,u=h.yScale,j=m.a().scale(d),b=m.b().scale(u),l.append("g").attr("class","axis").attr("transform","translate(0,".concat(n-2*r,")")).call(j),l.append("g").attr("class","axis").attr("transform","translate("+(a-2*r)+",0)").call(b),l.append("line").attr("x1",0).attr("y1",(n+1)/2).attr("x2",a).attr("y2",(n+1)/2).attr("class","split"),l.append("line").attr("x1",(a+1)/2).attr("y1",0).attr("x2",(a+1)/2).attr("y2",n).attr("class","split"),l.append("path").attr("id","scatterline").attr("stroke","none").attr("fill","none");case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"updateAll",value:function(){for(var e=this.props,t=e.width,a=e.height,n=e.padding,r=e.start,i=e.stop,s=e.X,c=e.y,o=e.yhat,l=e.id,h=e.select,d=e.potential,u=this.generateScales(r,i,t,a,n),j=u.xScale,b=u.yScale,p=m.q("#animatedPlot".concat(l)).select("svg"),x=[],f=[],O=[],y=[],g=0;g<s.length;g++){x.push({x:j(s[g]),y:b(c[g])});var v=j(s[g]);f.push([v,b(o[g])]),y.push([v,b(d[g])]),O.push([v,b(0)])}p.selectAll("circle").remove(),p.selectAll("text").remove();var w=p.select("#scatterline");this.plotPoints(p,x,h),"reset"===this.props.status?w.attr("id","scatterline").attr("stroke","none").attr("fill","none"):"real"===this.props.status?this.animateLineChange(w,"black",O,f,750):"pred"===this.props.status&&this.animateLineChange(w,"orangered",f,y,750)}},{key:"componentDidUpdate",value:function(){this.updateAll()}},{key:"shouldComponentUpdate",value:function(){return!this.props.shouldNotRender}},{key:"render",value:function(){var e=this.props.id;return Object(O.jsx)("div",{id:"animatedPlot".concat(e)})}}]),a}(i.Component),F=function(e){Object(d.a)(a,e);var t=Object(u.a)(a);function a(){return Object(l.a)(this,a),t.apply(this,arguments)}return Object(h.a)(a,[{key:"componentDidMount",value:function(){var e=m.q("#sweet"),t=100,a=300,n=m.o().domain([0,-1]).range([0,300]),r=m.o().domain([1,1]).range([100,0]),i=e.append("svg").attr("width",a).attr("height",t).style("overflow","visible");i.append("rect").attr("width",a).attr("height",t).attr("class","cord");var s=m.a().scale(n),c=m.b().scale(r);i.append("g").attr("class","axis").attr("id","x").attr("transform","translate(0,".concat(100,")")).call(s),i.append("g").attr("class","axis").attr("id","y").attr("transform","translate(300,0)").call(c.ticks(0)),i.append("path").attr("id","line").attr("stroke","none").attr("fill","none")}},{key:"componentDidUpdate",value:function(){for(var e=this.props,t=e.lossArray,a=e.duration,n=t.length-1,r=m.o().domain([0,n]).range([1,300]),i=m.l(t),s=m.k(t),c=m.o().domain([i,s]).range([100,0]),o=m.q("#sweet").select("svg"),l=[],h=0;h<t.length;h++)l.push([r(h),c(t[h])]);var d=m.a().scale(r),u=m.b().scale(c);o.select("#x").transition().duration(a).attr("transform","translate(0,".concat(100,")")).call(d.ticks(5)),o.select("#y").transition().duration(a).attr("transform","translate(300,0)").call(u.ticks(5)),o.select("#line").transition().duration(a).attr("d",m.i()(l)).attr("stroke","black").attr("fill","none")}},{key:"render",value:function(){return Object(O.jsx)("div",{id:"sweet"})}}]),a}(i.Component),A=(a(555),a(263)),N=function(e){return Object(O.jsx)(A.InlineMath,{math:e})},L=function(e){return Object(O.jsx)(A.BlockMath,{math:e})},E=a(612),T=a(627),P=a(602),B=a(604),D=a(605),M=a(608),z=a(609),R=a(616),W=a(617),I=a(64),q=a(50),H=a(44),X=function(e){Object(d.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={width:400,height:400},n}return Object(h.a)(a,[{key:"componentDidMount",value:function(){var e=Object(k.a)(w.a.mark((function e(){var t,a,n,r,i,s,c,o,l,h,d,u,j,b,p,x,f;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return b=function(e,t){for(var a=s.X,n=s.y,r=0,i=0;i<s.X.length;i++)r+=Math.pow(e*a[i]+t-n[i],2);return r/(2*a.length)},e.next=3,this.state;case 3:return t=e.sent,a=t.width,n=t.height,r=m.q("#divContour").select("#contour"),e.next=9,this.props;case 9:for(i=e.sent,s=i.data,c=i.darkness,o=a,l=n,h=new Array(o*l),d=.5,u=0;d<l;++d)for(j=.5;j<o;++j,++u)h[u]=b(j/o*10-5,d/l*20);return e.next=16,m.m(c,20,1).map((function(e){return Math.pow(2,e)}));case 16:p=e.sent,x=m.p(m.f(p),m.h),f=m.c().size([o,l]).thresholds(p)(h),r.append("g").attr("fill","none").selectAll("path").data(f).join("path").attr("fill",(function(e){return x(e.value)})).attr("d",m.g()),r.append("circle").attr("cx",a/2).attr("cy",0).attr("r",5).style("fill","none").style("stoke","none");case 21:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=this.state,t=e.width,a=e.height,n=this.props,r=n.loss,i=n.ms,s=n.m,c=n.b,o=m.q("#divContour").select("#contour");null!=r?r<1e3&&o.select("circle").transition().duration(200-i).attr("cx",t/2+s/10*t).attr("cy",c/20*a).attr("r",2*r+5).style("fill","red").style("opacity","0.5"):o.select("circle").attr("cx",t/2).attr("cy",0).attr("r",5).style("fill","none").style("stroke","none")}},{key:"render",value:function(){var e=this.state,t=e.width,a=e.height;return Object(O.jsx)("div",{id:"divContour",children:Object(O.jsx)("svg",{style:{width:t,height:a},id:"contour"})})}}]),a}(i.Component),G=a.p+"static/media/autoKey.c81582c4.svg",U=a(606),_=a(607),V=a(610),J=a(611),K=a(33),Y=function(e){Object(d.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={yhat:[],darkness:-4,playButton:!0,linreg:{meanSquaredError:0,rsquared:null,data:{X:[],y:[]},hyperparams:{learningRate:.03,epochs:0,loss:null,speed:200},tunableparams:{m:0,b:0}}},n.generateData=n.generateData.bind(Object(H.a)(n)),n.linearRegression=n.linearRegression.bind(Object(H.a)(n)),n.a=n.a.bind(Object(H.a)(n)),n.handleSlider=n.handleSlider.bind(Object(H.a)(n)),n.reset=n.reset.bind(Object(H.a)(n)),n}return Object(h.a)(a,[{key:"reset",value:function(){this.generateData(),this.setState(Object(q.a)(Object(q.a)({},this.state),{},{playButton:!0,linreg:Object(q.a)(Object(q.a)({},this.state.linreg),{},{rsquared:null,hyperparams:Object(q.a)(Object(q.a)({},this.state.linreg.hyperparams),{},{epochs:0,loss:null}),tunableparams:{m:0,b:0}})}))}},{key:"generateData",value:function(){var e=this;K.r((function(){var t=[0,1,2,3,4,5],a=[5,4,3,2,1,0],n=K.q(a),r=K.g(n).dataSync()[0],i=1/(2*t.length)*K.o(K.i(K.n(r,n),2)).dataSync()[0];e.setState(Object(q.a)(Object(q.a)({},e.state),{},{yhat:[0,0,0,0,0,0],linreg:Object(q.a)(Object(q.a)({},e.state.linreg),{},{meanSquaredError:i,data:{X:t,y:a}})}))}))}},{key:"linearRegression",value:function(){var e=this;K.r((function(){if(e.state.linreg.hyperparams.epochs>1e4)e.setState({playButton:!e.state.playButton});else{var t=e.state.linreg.tunableparams,a=t.m,n=t.b,r=e.state.linreg.hyperparams.learningRate,i=e.state.linreg.data,s=i.X,c=i.y,o=K.q(s),l=K.q(c),h=function(e,t,a){return K.a(K.h(e,t),a)}(o,a,n),d=o.shape[0],u=1/d*K.o(K.h(K.n(h,l),o)).dataSync()[0],j=1/d*K.o(K.n(h,l)).dataSync()[0],b=function(e,t){return 1/(2*d)*K.o(K.i(K.n(t,e),2)).dataSync()[0]}(l,h);a+=-r*u,n+=-r*j;var p=1-b/e.state.linreg.meanSquaredError,x=e.state.linreg.hyperparams.epochs+1,f=Array.from(h.dataSync());e.setState(Object(q.a)(Object(q.a)({},e.state),{},{yhat:f,linreg:Object(q.a)(Object(q.a)({},e.state.linreg),{},{rsquared:p,tunableparams:{m:a,b:n},hyperparams:Object(q.a)(Object(q.a)({},e.state.linreg.hyperparams),{},{epochs:x,loss:b})})}))}}))}},{key:"a",value:function(){var e=Object(k.a)(w.a.mark((function e(){var t,a,n,r;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=function(e){return new Promise((function(t){return setTimeout(t,e)}))},a=200;case 2:return n=this.state.linreg.hyperparams.speed,r=a-n,e.next=7,this.linearRegression();case 7:return e.next=9,t(r);case 9:if(!0!==this.state.playButton){e.next=11;break}return e.abrupt("break",13);case 11:e.next=2;break;case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"handleSlider",value:function(e,t){this.setState({linreg:Object(q.a)(Object(q.a)({},this.state.linreg),{},{hyperparams:Object(q.a)(Object(q.a)({},this.state.linreg.hyperparams),{},{speed:t})})})}},{key:"componentDidMount",value:function(){var e=Object(k.a)(w.a.mark((function e(){return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.generateData();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e,t,a,n=this,r=this.state.linreg.tunableparams,i=r.m,s=r.b,c=this.state.linreg.hyperparams,o=c.loss,l=c.speed,h=c.epochs,d=this.state.linreg.data;return Object(O.jsx)("div",{children:Object(O.jsxs)(x.a,{display:"flex",justifyContent:"center",marginTop:2,children:[Object(O.jsx)(x.a,{marginTop:10,marginRight:10,children:Object(O.jsx)(S,{width:400,height:400,padding:0,start:0,stop:5,X:d.X,y:d.y,yhat:this.state.yhat,id:420,select:-1,duration:0})}),Object(O.jsxs)(P.a,{variant:"outlined",children:[Object(O.jsxs)(B.a,{children:[Object(O.jsx)("h2",{children:"Auto Best Fit"}),Object(O.jsxs)(D.a,{variant:"h4",component:"h2",children:["EPOCH: ",h]}),Object(O.jsx)(D.a,{variant:"h6",component:"h2",style:{color:(a=o,null===a?"#dce0dd":"black")},children:" loss = ".concat((e=o,t=10,null===e?e:e.toPrecision(t)))}),Object(O.jsx)(U.a,{onClick:this.reset,children:Object(O.jsx)(_.a,{})}),Object(O.jsx)(M.a,{style:{background:this.state.playButton?"#175676":"#D62839",color:"white"},onClick:Object(k.a)(w.a.mark((function e(){return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.setState({playButton:!n.state.playButton});case 2:return e.next=4,n.a();case 4:case"end":return e.stop()}}),e)}))),disableTouchRipple:!0,children:this.state.playButton?Object(O.jsx)(z.a,{}):Object(O.jsx)(V.a,{})}),Object(O.jsx)(U.a,{style:{color:200===l?"grey":"#FFC006"},onClick:function(){n.setState({linreg:Object(q.a)(Object(q.a)({},n.state.linreg),{},{hyperparams:Object(q.a)(Object(q.a)({},n.state.linreg.hyperparams),{},{speed:200===l?120:200})})})},children:Object(O.jsx)(J.a,{})}),Object(O.jsx)("br",{}),Object(O.jsx)("img",{src:G,alt:"legend",width:"40%"})]}),Object(O.jsx)(X,{ms:l,data:d,m:isFinite(i)?i:0,b:isFinite(s)?s:0,loss:o,darkness:this.state.darkness})]})]})})}}]),a}(i.Component),Z=a(628),Q=function(e){Object(d.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={weight:-.82,bias:-.02,loss:0,domain:[],range:[],line:[],show:!1,width:400,biasColor:"#FFA500",weightColor:"#56A8C7",lossColor:"red"},n}return Object(h.a)(a,[{key:"loss",value:function(e,t,a){return K.r((function(){var n=K.q(e),r=K.q(t);return 1/(2*a)*K.o(K.i(K.n(r,n),2)).dataSync()[0]}))}},{key:"computeLine",value:function(e,t,a){for(var n,r=new Array(a.length),i=0;i<a.length;i++)r[i]=(n=a[i],e*n+t);return r}},{key:"zeros",value:function(e){for(var t=new Array(e),a=0;a<e;a++)t[a]=0;return t}},{key:"range",value:function(e,t,a){for(var n=[],r=e;r<=t;r+=a)n.push(r);return n}},{key:"dataGenerator",value:function(){var e=this.range(-1,1,.1),t=this.computeLine(.65,-.3,e),a=this.computeLine(this.state.weight,this.state.bias,e),n=this.loss(t,a,t.length);this.setState({domain:e,range:t,line:a,loss:n})}},{key:"componentDidMount",value:function(){this.dataGenerator()}},{key:"render",value:function(){var e=this,t=this.state,a=t.domain,n=t.range,r=t.bias,i=t.weight,s=t.line,c=t.loss,o=t.show,l=t.width,h=t.weightColor,d=t.biasColor,u=t.lossColor;return Object(O.jsxs)(x.a,{display:"flex",justifyContent:"center",children:[Object(O.jsx)(x.a,{style:{filter:"blur(".concat(o?0:25,"px)")},children:Object(O.jsx)(S,{width:l,height:l,padding:0,start:-1,stop:1,X:a,y:n,yhat:s,id:69,select:-1,duration:0})}),Object(O.jsx)(x.a,{marginLeft:7,children:Object(O.jsx)(P.a,{variant:"outlined",children:Object(O.jsxs)(B.a,{children:[Object(O.jsx)("h2",{children:"Manual Best Fit"}),Object(O.jsxs)("p",{children:["Manually tune"," ",Object(O.jsx)("em",{style:{color:h},children:"weight"})," ","and ",Object(O.jsx)("em",{style:{color:d},children:"bias"})," ","and try to reach a"," ",Object(O.jsx)("em",{style:{color:u},children:"loss"})," of 0"]}),Object(O.jsx)(Z.a,{style:{color:h},value:i,onChange:function(t,s){var c=e.computeLine(i,r,a),o=e.loss(n,c,n.length);e.setState({weight:s,line:c,loss:o})},min:-1,step:.01,max:1,valueLabelDisplay:"auto"}),Object(O.jsx)(Z.a,{style:{color:d},value:r,onChange:function(t,s){var c=e.computeLine(i,r,a),o=e.loss(n,c,n.length);e.setState({bias:s,line:c,loss:o})},min:-1,step:.01,valueLabelDisplay:"auto",max:1}),Object(O.jsxs)("h3",{children:[N("\\text{neuron}(x) = ")," ",Object(O.jsx)("em",{style:{color:h},children:N("".concat(i))}),N("x + ")," ",Object(O.jsx)("em",{style:{color:d},children:N("".concat(r))})]}),Object(O.jsxs)("h3",{children:[Object(O.jsx)("i",{style:{color:u},children:"loss"})," ",N(" = \\frac{1}{J}\\sum_{i = 1}^J (\\hat{y_i} - y_i)^2 ="),Object(O.jsxs)("em",{style:{color:u},children:[" ",N("".concat(c.toFixed(7)))]})]}),Object(O.jsx)(E.a,{size:"small",variant:"outlined",style:{borderColor:"#175676",color:"#175676"},onClick:function(){e.setState({show:!e.state.show})},children:"Click to Reveal Graph"})]})})})]})}}]),a}(i.Component),$=a(613),ee=function(e){Object(d.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={input:0,output1:0,output2:0,output3:0,weights:[],biases:[]},n.compute=n.compute.bind(Object(H.a)(n)),n.initParams=n.initParams.bind(Object(H.a)(n)),n}return Object(h.a)(a,[{key:"compute",value:function(e){var t=this.state,a=t.weights,n=t.biases,r=function(e,t,a){return t*e+a},i=r(e,a[0],n[0]).toFixed(3),s=r(i,a[1],n[1]).toFixed(3),c=r(s,a[2],n[2]).toFixed(3);this.setState({input:e,output1:i,output2:s,output3:c})}},{key:"genRandomArray",value:function(e){for(var t=new Array(e),a=0;a<t.length;a++)t[a]=+Math.random().toFixed(2);return t}},{key:"initParams",value:function(){var e=Object(k.a)(w.a.mark((function e(){var t,a;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.genRandomArray(3),a=this.genRandomArray(3),this.setState({weights:t,biases:a});case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){var e=Object(k.a)(w.a.mark((function e(){return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.initParams();case 2:this.compute(34);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.state,a=t.input,n=t.output1,r=t.output2,i=t.output3,s=t.weights,c=t.biases,o=a.toFixed(3),l=[{output:n,color:"#8db600"},{output:r,color:"#FF8F00"},{output:i,color:"#56A8C7"}];return Object(O.jsx)(x.a,{display:"flex",children:Object(O.jsx)(x.a,{width:580,children:Object(O.jsxs)(P.a,{variant:"outlined",children:[Object(O.jsxs)(B.a,{children:[Object(O.jsx)(Z.a,{value:this.state.input,onChange:function(t,a){e.compute(a)},color:"secondary"}),Object(O.jsx)(x.a,{display:"flex",justifyContent:"center",children:Object(O.jsx)(x.a,{justifyContent:"center",children:Object(O.jsxs)("svg",{width:500,height:64,children:[Object(O.jsx)("path",{d:"M".concat(36," 16, ",100," 16"),stroke:"#f50557",strokeDasharray:"25, 4",strokeWidth:3*s[0]+.2}),Object(O.jsx)("text",{x:40,y:40,fill:"#f50557",children:o}),l.map((function(e,t){return Object(O.jsxs)("g",{children:[Object(O.jsx)("rect",{x:100+100*t,y:0,width:32,height:32,fill:"lightgrey"}),Object(O.jsx)("text",{x:111+100*t,y:22,children:t+1}),Object(O.jsx)("path",{d:"M".concat(132+100*t," 16, ").concat(200+100*t," 16"),stroke:e.color,strokeDasharray:"25, 4",strokeWidth:t<2?3*s[t+1]+.2:1}),Object(O.jsx)("text",{x:140+100*t,y:40,fill:e.color,children:e.output})]},t)}))]})})}),Object(O.jsxs)(D.a,{variant:"h5",children:["neuron1(",Object(O.jsx)(D.a,{color:"secondary",variant:"inherit",children:o}),") = ",s[0],"(",Object(O.jsx)(D.a,{color:"secondary",variant:"inherit",children:o}),") + ",c[0]," ="," ",Object(O.jsx)(D.a,{style:{color:"#8db600"},variant:"inherit",children:this.state.output1})]}),Object(O.jsxs)(D.a,{variant:"h5",children:["neuron2(",Object(O.jsx)(D.a,{style:{color:"#8db600"},variant:"inherit",children:this.state.output1}),") = ",s[1],"(",Object(O.jsx)(D.a,{style:{color:"#8db600"},variant:"inherit",children:this.state.output1}),") + ",c[1]," ="," ",Object(O.jsx)(D.a,{style:{color:"#FF8F00"},variant:"inherit",children:this.state.output2})]}),Object(O.jsxs)(D.a,{variant:"h5",children:["neuron3(",Object(O.jsx)(D.a,{style:{color:"#FF8F00"},variant:"inherit",children:this.state.output2}),") = ",s[2],"(",Object(O.jsx)(D.a,{style:{color:"#FF8F00"},variant:"inherit",children:this.state.output2}),") + ",c[2]," ="," ",Object(O.jsx)(D.a,{style:{color:"#56A8C7"},variant:"inherit",children:this.state.output3})]})]}),Object(O.jsx)($.a,{children:Object(O.jsx)(E.a,{size:"small",variant:"outlined",style:{borderColor:"#175676",color:"#175676"},onClick:Object(k.a)(w.a.mark((function t(){return w.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.initParams();case 2:case"end":return t.stop()}}),t)}))),children:"new Weights and biases"})})]})})})}}]),a}(i.Component),te=function(e){Object(d.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={key:!1},n}return Object(h.a)(a,[{key:"render",value:function(){var e=this,t=this.state.key,a=this.props,n=a.noKeySVG,r=a.keySVG,i=a.title;return Object(O.jsx)("div",{children:Object(O.jsx)(P.a,{variant:"outlined",children:Object(O.jsxs)(B.a,{children:[i,Object(O.jsx)("img",{width:"100%",src:t?r:n,alt:""}),Object(O.jsx)(E.a,{onClick:function(){e.setState({key:!t})},variant:"outlined",style:{borderColor:"#175676",color:"#175676"},children:"Click here to see descriptions of the diagram above"})]})})})}}]),a}(i.Component),ae=a.p+"static/media/summary.c45974a2.svg",ne=a.p+"static/media/forward-key.faefbb8b.svg",re=a.p+"static/media/forward.ff39da98.svg",ie=a.p+"static/media/forwardComputation.42bcf438.svg",se=a.p+"static/media/backward-key.af99d48b.svg",ce=a.p+"static/media/backward.6cd01f92.svg",oe=a.p+"static/media/backwardComputation.6427121a.svg",le=function(){var e,t,a="#FFA500",n="#56A8C7",r=Object(O.jsx)("em",{style:{color:a},children:"orange"}),i=Object(O.jsx)("em",{style:{color:n},children:"blue"}),s=Object(O.jsx)("em",{style:{color:"#8db600"},children:"green"}),c=Object(O.jsx)("em",{style:{color:"#F50257"},children:"pink"}),o=function(e,t){return Object(O.jsx)(T.a,{style:{backgroundColor:"#56A8C7",color:"black"},title:Object(O.jsx)(P.a,{children:Object(O.jsx)(B.a,{children:t})}),placement:"top",arrow:!0,children:e})},l=function(e){return Object(O.jsx)(D.a,{variant:"h3",children:e})},h=function(e){return Object(O.jsx)(D.a,{variant:"h4",children:e})},d=Object(O.jsxs)(x.a,{children:[Object(O.jsx)("br",{}),Object(O.jsx)(I.Element,{name:"article",children:l("Introduction")}),Object(O.jsx)(f.a,{}),Object(O.jsx)("br",{}),Object(O.jsxs)(D.a,{variant:"h6",children:["Most people abstract the idea of ",Object(O.jsx)("b",{children:"backprop"}),"(",Object(O.jsx)("b",{children:"backprop"}),"agation) when learning neural networks because it is by far the most notation heavy part. The goal of this article is to build an intuition for why and how we perform backpropagation. By marrying explanation, notation, and interactive tools, the aim is to get a understanding of the foundations. Note that throughout the article there will be"," ",o(Object(O.jsx)("span",{children:"highlighted"}),Object(O.jsx)(D.a,{variant:"h6",children:"Example explanation"}))," ","words that will give extra explanation on mouse over."]}),Object(O.jsx)("br",{}),Object(O.jsx)(I.Element,{name:"oneNeuron",children:l("Grasping the Concept")}),Object(O.jsx)(f.a,{}),Object(O.jsx)(I.Element,{name:"getting",children:h("Getting Started")}),Object(O.jsxs)(D.a,{variant:"h6",children:["The goal in a neural network, or any optimization problem for that matter, is to lower and minimize whatever"," ",o(Object(O.jsx)("span",{children:"loss"}),Object(O.jsxs)(D.a,{variant:"body1",children:["Error between predicted values ",N("\\hat{y}")," and true values ",N("y")]}))," ","function we define. For this article, we will be performing regression and using mean squared error loss"," ",o(Object(O.jsx)("span",{children:"MSE"}),Object(O.jsxs)(x.a,{children:[Object(O.jsx)(D.a,{variant:"h6",children:L("\\text{MSE} = \\frac{1}{J}\\sum_{i = 1}^{J}(\\hat{y_i} - y_i)^2")}),Object(O.jsxs)(D.a,{variant:"body1",children:[Object(O.jsx)("b",{children:"Input Variables"}),Object(O.jsx)("br",{}),"length of data ",N("J"),Object(O.jsx)("br",{}),"index ",N("i"),Object(O.jsx)("br",{}),"predicted values ",N("\\hat{y}"),Object(O.jsx)("br",{}),"true values ",N("y")]})]})),"."]}),Object(O.jsxs)(D.a,{variant:"h6",children:["Before hitting the calculus, tune the"," ",o(Object(O.jsx)("span",{children:"weight and bias on one neuron"}),Object(O.jsxs)(x.a,{children:[Object(O.jsx)(D.a,{variant:"h6",children:L("\\text{neuron}(x) = w_0x + b ")}),Object(O.jsxs)(D.a,{variant:"body1",children:[Object(O.jsx)("b",{children:"Neuron as a Function"}),Object(O.jsx)("br",{}),"input ",N("x"),Object(O.jsx)("br",{}),"output ",N("\\text{neuron}(x)"),Object(O.jsx)("br",{}),Object(O.jsx)("b",{children:"Tunable Parameters"}),Object(O.jsx)("br",{}),"weight ",N("w_0"),Object(O.jsx)("br",{}),"bias ",N("b")]})]}))," ","by sliding the sliders under ",Object(O.jsx)("b",{children:"Manual Best Fit"}),". By observing changes in the ",Object(O.jsx)("em",{style:{color:"red"},children:"loss"}),", try to make it reach 0. When you feel like you've lowered the"," ",Object(O.jsx)("em",{style:{color:"red"},children:"loss"})," enough (or need some help), press the"," ",Object(O.jsx)(E.a,{disabled:!0,variant:"outlined",size:"small",style:{borderColor:"#175676",color:"#175676"},children:"Click to reveal the graph"})," ","button below."]}),Object(O.jsx)("br",{}),Object(O.jsx)(I.Element,{name:"structMan",children:Object(O.jsx)(Q,{})}),Object(O.jsx)("br",{}),h("Reflection"),Object(O.jsx)(D.a,{variant:"h6",children:Object(O.jsx)("b",{children:"The intuition and logic from the exercise above, is the foundation for what backpropagation and optimization aims to achieve."})}),Object(O.jsxs)(D.a,{variant:"h6",children:["\u2003\u2003\u2003\u2003When you start to change the weight, you observe where the loss moves, if it moves up, you move the weight the other direction to lower the loss. This, without the math, is the main principle behind gauging the rate of change and optimizing a neural network."," ",Object(O.jsx)("b",{children:"Let's apply this method of thinking!"})]}),Object(O.jsx)("br",{}),Object(O.jsx)(I.Element,{name:"definition",children:h("Defining Backpropagation")}),Object(O.jsxs)(D.a,{variant:"h6",children:["First to get the"," ",o(Object(O.jsx)("span",{children:"instantaneous rate of change"}),Object(O.jsxs)(x.a,{children:[Object(O.jsx)(D.a,{style:{color:n},variant:"h6",children:L("\\lim_{h \\to 0} \\frac{f(x + h) - f(x)}{h}")}),Object(O.jsx)(D.a,{variant:"h6",style:{color:a},children:L("\\frac{df}{dx}")}),Object(O.jsxs)(D.a,{style:{color:n},variant:"body1",children:["Limit definition of derivative of ",N("f(x)")," with respect to ",N("x")]}),Object(O.jsxs)(D.a,{style:{color:a},variant:"body1",children:["Notation for derivative of ",N("f(x)")," with respect to ",N("x")]})]})),"(derivative), we get our point of interest and another point that is infinitely close and calculate slope, this can be visualized as a tangent line at the point of interest for a function with one variable like ",N("f(x)"),"."]}),Object(O.jsxs)(D.a,{variant:"h6",children:["\u2003\u2003\u2003\u2003In the context of our one neuron neural network, we can compose the whole network as a nested function",L("\\text{loss}(\\text{neuron}(x,w,b),y)")]}),Object(O.jsxs)(D.a,{variant:"h6",children:["Since want to tune the parameters weight ",N("w")," and bias"," ",N("b"),", we want to know how each parameters will affect the loss, or in other words, the"," ",o(Object(O.jsx)("span",{children:"partial derivative"}),Object(O.jsxs)(x.a,{children:[Object(O.jsx)(D.a,{style:{color:n},variant:"h6",children:L("\\lim_{h \\to 0} \\frac{f(x + h, y) - f(x,y)}{h}")}),Object(O.jsx)(D.a,{variant:"h6",style:{color:a},children:L("\\frac{\\partial f}{\\partial x}")}),Object(O.jsxs)(D.a,{style:{color:n},variant:"body1",children:["Limit definition of partial derivative of"," ",N("f(x,y)")," with respect to ",N("x")]}),Object(O.jsxs)(D.a,{style:{color:a},variant:"body1",children:["Notation for partial derivative of ",N("f(x,y)")," ","with respect to ",N("x")]}),Object(O.jsx)(D.a,{style:{color:n},variant:"h6",children:L("\\lim_{h \\to 0} \\frac{f(x, y + h) - f(x,y)}{h}")}),Object(O.jsx)(D.a,{variant:"h6",style:{color:a},children:L("\\frac{\\partial f}{\\partial y}")}),Object(O.jsxs)(D.a,{style:{color:n},variant:"body1",children:["Limit definition of partial Derivative of"," ",N("f(x,y)")," with respect to ",N("y")]}),Object(O.jsxs)(D.a,{style:{color:a},variant:"body1",children:["Notation for partial derivative of ",N("f(x,y)")," ","with respect to ",N("y")]})]}))," ","of loss with respect to each parameter, also called the"," ",o(Object(O.jsx)("span",{children:"gradient"}),Object(O.jsx)(x.a,{children:Object(O.jsx)(D.a,{variant:"h6",children:L("\\nabla f(x,y) = \\begin{bmatrix} \\frac{\\partial f}{\\partial x} \\\\[4pt] \\frac{\\partial f}{\\partial y} \\\\ \\end{bmatrix}")})})),". By computing the gradient, we effectively have gauged how changing each parameter will affect the loss: the direction of steepest ascent. But we want to lower loss, therefore we use the opposite direction to get the direction of steepest descent, to perform"," ",o(Object(O.jsx)("span",{children:"gradient descent"}),Object(O.jsxs)(x.a,{children:[Object(O.jsx)(D.a,{variant:"body1",children:N("\\text{param} := \\text{param} -lr \\cdot \\frac{\\partial \\text{loss}}{\\partial \\text{param}}")}),Object(O.jsx)("br",{}),Object(O.jsxs)(D.a,{variant:"body2",children:["Since the gradient of the loss will be the direction of steepest ",Object(O.jsx)("em",{children:"ascent"}),", by going the opposite direction, we go in the direction of steepest"," ",Object(O.jsx)("em",{children:"descent"}),". Learning rate lr then decides how large of a step in the direction of steepest descent would like."]})]})),"."]}),Object(O.jsx)(D.a,{variant:"h4",children:L("\\nabla \\text{loss} = \\begin{bmatrix} \\frac{ \\partial \\text{loss}}{\\partial w} \\\\[4pt] \\frac{ \\partial \\text{loss}}{\\partial b} \\\\ \\end{bmatrix}")}),Object(O.jsx)(D.a,{variant:"h6",children:"In order to calculate these derivatives we must use the chain rule due to the nested nature of neural networks."}),Object(O.jsxs)(D.a,{variant:"h6",children:["\u2003\u2003\u2003\u2003"," ",Object(O.jsx)("b",{children:"Below is a color coded example of the chain rule."})," Start by sliding the slider and notice how the output is the input to the next function and so forth."," ",Object(O.jsx)("b",{children:"Then read the explanation below"}),"."]}),Object(O.jsx)("br",{}),Object(O.jsx)(x.a,{display:"flex",justifyContent:"center",children:Object(O.jsx)(x.a,{children:Object(O.jsx)(ee,{})})}),Object(O.jsx)("br",{}),Object(O.jsxs)(D.a,{variant:"h6",children:[Object(O.jsxs)("b",{children:["Suppose we wanted to see how ",i," was affected by"," ",c,"."]}),Object(O.jsx)("br",{}),"First lets start at ",i,", then",Object(O.jsxs)("ol",{children:[Object(O.jsxs)("li",{children:["observe how ",i," was affected by ",r]}),Object(O.jsxs)("li",{children:["observe how ",r," was affected by ",s]}),Object(O.jsxs)("li",{children:["observe how ",s," was affected by ",c]})]}),"By chaining these observations together, we get how how ",i," ","was affected by ",c,"."]}),Object(O.jsx)("br",{}),Object(O.jsx)(D.a,{variant:"h6",children:Object(O.jsx)("b",{children:"This logic applied to our one neuron neural network looks like"})}),Object(O.jsxs)(D.a,{variant:"h6",children:[L("\\frac{ \\partial \\text{loss}}{\\partial w} = \\frac{ \\partial \\text{loss}}{\\partial \\text{neuron}} \\frac{ \\partial \\text{neuron}}{\\partial w} "),L("\\frac{ \\partial \\text{loss}}{\\partial b} = \\frac{ \\partial \\text{loss}}{\\partial \\text{neuron}} \\frac{ \\partial \\text{neuron}}{\\partial b} ")]}),Object(O.jsxs)(D.a,{variant:"h6",children:["These chains can be broken up into more intermediate derivatives all the way down to their primitives (basis of automatic differentiation). ",Object(O.jsx)("b",{children:"The main takeaway"})," is that we first observe how the loss output was affected by the neuron output"," ",N(" \\frac{ \\partial \\text{loss}}{\\partial \\text{neuron}}"),", then we observe how the neuron output was affected by each parameter"," ",N(" \\frac{ \\partial \\text{neuron}}{\\partial \\text{parameter}}")," ","and can chain these to observe how the loss was affected by the parameter"," ",N(" \\frac{ \\partial \\text{loss}}{\\partial \\text{parameter}}"),". Notice that we compute these derivatives going ",Object(O.jsx)("b",{children:"backward"})," ","(where the term ",Object(O.jsx)("b",{children:"back"}),"propagation comes from), which has the added benefit of reusing values computed in the forward propagation (for more on this check out"," ",(e="https://rufflewind.com/2016-12-30/reverse-mode-automatic-differentiation",t="reverse mode automatic differentiation",Object(O.jsx)(E.a,{size:"small",style:{color:"#155676"},href:e,target:"_blank",rel:"noopener noreferrer",children:t})),")."]}),Object(O.jsx)("br",{}),Object(O.jsx)(I.Element,{name:"concrete",children:h("Concrete Example")}),Object(O.jsxs)(D.a,{variant:"h6",children:["Let's go through a concrete example of forward propagation, then an emphasis on backward propagation. The training example will be (",N("x = 2.1"),", ",N("y = 4"),"), the weight will be"," ",N("w = 1"),", and the bias will be ",N("b = 0"),". ",N("\\hat{y}")," ","represents the neuron output and predicted value, and"," ",N("\\text{loss}")," represents squared error loss."]}),Object(O.jsx)("br",{}),Object(O.jsx)(te,{title:Object(O.jsx)(D.a,{variant:"h5",children:"Forward Overview"}),noKeySVG:re,keySVG:ne}),Object(O.jsx)("br",{}),Object(O.jsx)(D.a,{variant:"h5",children:"Forward Computation"}),Object(O.jsx)("img",{src:ie,width:"100%",alt:"forward computation"}),Object(O.jsx)("br",{}),Object(O.jsxs)(D.a,{variant:"h6",children:["Now we can go backward and compute partial derivatives with the chain rule to get the ",N("\\nabla \\text{loss}")]}),Object(O.jsx)("br",{}),Object(O.jsx)(te,{title:Object(O.jsx)(D.a,{variant:"h5",children:"Backward Overview"}),noKeySVG:ce,keySVG:se}),Object(O.jsx)("br",{}),Object(O.jsx)(D.a,{variant:"h5",children:"Backward Computation"}),Object(O.jsx)("img",{src:oe,width:"100%",alt:"backward computation"}),Object(O.jsxs)(D.a,{variant:"h5",children:[L("\\frac{\\partial \\text{loss}}{\\partial w} = -7.98"),L("\\frac{\\partial \\text{loss}}{\\partial b} = -3.8")]}),Object(O.jsxs)(D.a,{variant:"h6",children:["Then, we update the parameters with opposite gradient to descend loss, in this case learning rate is ",N("\\text{lr} = 0.01"),L("w := w - \\text{lr} \\cdot \\frac{\\partial \\text{loss}}{\\partial w} = (1) - (0.01) \\cdot (-7.98) = 1.0798"),L("b := b - \\text{lr} \\cdot \\frac{\\partial \\text{loss}}{\\partial b} = (0) - (0.01) \\cdot (-3.8) = 0.038 "),Object(O.jsx)("b",{children:"To see how well our tuned parameters do, let's do one more forward pass"}),L("\\text{loss} = ((1.0798)(2.1) + 0.038) - 4)^2 = 2.87")]}),Object(O.jsxs)(D.a,{variant:"h6",children:["Total loss decrease of ",N("3.61 - 2.87 = 0.74"),". Loss went down!"]}),Object(O.jsx)("br",{}),Object(O.jsx)(I.Element,{name:"see1",children:h("See it in Action")}),Object(O.jsxs)(D.a,{variant:"h6",children:["To see the what we just did (forward, backward, update) on more data and on the entire batch as opposed to a single training example, press"," ",Object(O.jsx)(M.a,{style:{background:"#175676",color:"white"},size:"small",disabled:!0,children:Object(O.jsx)(z.a,{fontSize:"small"})})," ","to start the training process under ",Object(O.jsx)("b",{children:"Auto Best Fit"}),". Watch how as the line gets better fit, the red dot descends the loss contour."]}),Object(O.jsx)(I.Element,{name:"structLin",children:Object(O.jsx)(Y,{})}),Object(O.jsx)("br",{}),Object(O.jsx)(I.Element,{name:"scaling",children:l("Implementation on (larger) Neural Network")}),Object(O.jsx)(f.a,{}),Object(O.jsx)(I.Element,{name:"changes",children:h("The Changes")}),Object(O.jsxs)(D.a,{variant:"h6",children:["To fit more interesting data that is non-linear (e.g. sine wave or quadratic), we need to add complexity to vary output to make sure we are not constrained to only linear outputs. We can do this by adding more neurons, more layers, and activation functions. If you think of our entire neural network as a function, then by adding more neurons and more layers we are creating a more nested function. Not only does this create more parameters that we can tune to vary the output, it also maintains the property of"," ",o(Object(O.jsx)("span",{children:"differentiability"}),Object(O.jsx)(x.a,{children:Object(O.jsx)(D.a,{variant:"h6",children:"The derivative exists for all inputs"})})),": important so we can compute the gradient. And by adding non-linear activation functions with points of deactivation, certain neurons may have no effect on the output while others may become more activated, contributing to outputs that don't have to follow linear constraints. We will be using the"," ",o(Object(O.jsx)("span",{children:"ReLU"}),Object(O.jsxs)(x.a,{children:[Object(O.jsxs)(D.a,{variant:"h6",children:[Object(O.jsx)("b",{children:"Re"}),"ctified ",Object(O.jsx)("b",{children:"L"}),"inear ",Object(O.jsx)("b",{children:"U"}),"nit"]}),Object(O.jsx)(D.a,{variant:"h6",children:N(" \\text{ReLU}(x) = \\left\\{ \\begin{array}{ll} 0 & x\\leq 0  \\\\ x & x > 0 \\\\ \\end{array} \\right. ")})]}))," ","activation function in the hidden layers."]}),Object(O.jsx)(x.a,{display:"flex",justifyContent:"center",children:Object(O.jsx)(x.a,{children:Object(O.jsx)("img",{alt:"summary",src:ae,width:"100%"})})}),Object(O.jsxs)(D.a,{variant:"h6",children:[Object(O.jsx)("b",{children:"Above"})," is an example of a neural network with one input, three hidden layers with eight neurons each, and one output neuron. The output of each neuron is fed into the neurons of the next layer and so forth (like a nested function). Each link represents a weight and a corresponding input into the respective neuron, notice how the more neurons we add, the more links there are and the more parameters we can tune to get our desired output."]}),Object(O.jsx)("br",{}),Object(O.jsx)(I.Element,{name:"training",children:h("Training Process")}),Object(O.jsx)(D.a,{variant:"h6",children:Object(O.jsxs)("ol",{children:[Object(O.jsx)("li",{children:"Forward propagation resulting in an output and loss"}),Object(O.jsx)("li",{children:"Backward propagation using the chain rule to compute the gradient"}),Object(O.jsx)("li",{children:"Descend the loss by performing gradient descent"})]})}),Object(O.jsxs)(D.a,{variant:"h6",children:[Object(O.jsx)("b",{children:"The process doesn't change from the single neuron example!"})," ","Since the network is deeper, we have to calculate more derivatives going backwards and have to tune more parameters with gradient descent, but the logic stays the same."]}),Object(O.jsxs)(D.a,{variant:"h6",children:["\u2003\u2003\u2003\u2003A great way to visualize backpropagation in a large network is with vertical arrows representing which direction we need to nudge the neuron output in order to lower loss:"," ",N("-\\frac{\\partial \\text{loss}}{\\partial \\text{activation} }"),". In the ",Object(O.jsx)("b",{children:"EPOCH Tool"})," below, you will be able to visualize all phases of a single epoch with an emphasis on"," ",Object(O.jsx)("b",{children:"backpropagation"}),"."]}),Object(O.jsx)("br",{}),Object(O.jsx)(I.Element,{name:"see2",children:Object(O.jsx)(D.a,{variant:"h4",children:"Backprop Explainer Quick Start"})}),Object(O.jsx)(D.a,{variant:"h6",children:Object(O.jsxs)("ol",{children:[Object(O.jsxs)("li",{children:["Press"," ",Object(O.jsx)(M.a,{style:{background:"#175676",color:"white"},size:"small",disabled:!0,children:Object(O.jsx)(z.a,{fontSize:"small"})})," ","to start training"]}),Object(O.jsxs)("li",{children:["Then press"," ",Object(O.jsx)(E.a,{variant:"outlined",size:"small",style:{borderColor:"#175676",color:"#175676"},disabled:!0,children:"Click to animate epoch #"})," ","to see forward propagation, ",Object(O.jsx)("b",{children:"backward propagation"})," ","and, update animation at the epoch #"]}),Object(O.jsxs)("li",{children:["To go back to fitting mode click"," ",Object(O.jsxs)(E.a,{variant:"outlined",size:"small",style:{borderColor:"#175676",color:"#175676"},disabled:!0,children:[Object(O.jsx)(R.a,{})," Go back to fitting"]})," "]})]})}),Object(O.jsxs)(D.a,{variant:"h6",children:[Object(O.jsx)("b",{children:" Click on "}),Object(O.jsx)(W.a,{variant:"small",style:{color:"#FFA500"}})," ",Object(O.jsx)("b",{children:"to reveal extra descriptions"})]}),Object(O.jsx)("br",{})]});return Object(O.jsx)(x.a,{justifyContent:"center",display:"flex",children:Object(O.jsx)(x.a,{maxWidth:"60%",children:d})})},he=a.p+"static/media/headerTitle.66b764c3.svg",de=function(){return Object(O.jsx)("div",{children:Object(O.jsx)("img",{src:he,alt:"header with title",width:"100%"})})},ue=a(21),je=a(264),be=a.n(je),pe=a(629),xe=a(626),fe=a(619),me=a(621),Oe=a(618),ye=a(620),ge=a.p+"static/media/singleSummary.8525cefd.svg",ve=a.p+"static/media/epochMode.0ae87189.png",we=a.p+"static/media/key.84fb58e0.svg",ke=function(){function e(t,a){Object(l.a)(this,e),this.weights=t,this.bias=a}return Object(h.a)(e,[{key:"mult",value:function(e,t){return e.map((function(e,a){return e*t[a]}))}},{key:"dMult",value:function(e,t){return this.mult(e,t)}},{key:"sum",value:function(e){return e.reduce((function(e,t){return e+t}))}},{key:"dSum",value:function(e,t){for(var a=[],n=0;n<t;n++)a.push(e);return a}},{key:"linear",value:function(e){return e}},{key:"forward",value:function(e,t){var a=this.weights,n=this.bias,r=this.mult,i=this.sum,s=r(e,a),c=i(s)+n,o=t(c);this.inputs=e,this.multStep=s,this.sumStep=c,this.actStep=o,this.output=o}},{key:"backward",value:function(e,t){var a=this.inputs,n=this.weights,r=this.actStep,i=this.dSum,s=this.mult,c=this.sum,o=t(r)*e,l=i(o,a.length),h=o,d=s(l,a),u=s(l,n),j=c(u);this.dvalue=e,this.dActStep=o,this.dSumStep=l,this.dBias=h,this.dWeights=d,this.dInputs=u,this.dInputsSum=j}}]),e}(),Se=function(){function e(){Object(l.a)(this,e)}return Object(h.a)(e,[{key:"forward",value:function(e,t){var a=e-t,n=this.output=Math.pow(e-t,2);this.subStep=a,this.squareStep=n,this.output=n}},{key:"backward",value:function(){this.dInputs=2*this.subStep}}]),e}(),Ce=function(){function e(t,a,n){Object(l.a)(this,e),this.model=[],this.loss=new Se,this.shape=t;for(var r=0;r<a.length;r++){for(var i=[],s=0;s<a[r].length;s++)i.push(new ke(a[r][s],n[r][s]));this.model.push(i)}}return Object(h.a)(e,[{key:"sum",value:function(e){return e.reduce((function(e,t){return e+t}))}},{key:"add",value:function(e,t){var a=e.length,n=t.length;if(n!==a)return console.error("".concat(a," does not match ").concat(n,", so returned empty array")),[];for(var r=new Array(a),i=0;i<e.length;i++)r[i]=e[i]+t[i];return r}},{key:"zeros",value:function(e){for(var t=new Array(e),a=0;a<e;a++)t[a]=0;return t}},{key:"dReLU",value:function(e){return e>0?1:0}},{key:"dLinear",value:function(e){return 1}},{key:"ReLU",value:function(e){return Math.max(0,e)}},{key:"linear",value:function(e){return e}},{key:"forward",value:function(e,t){for(var a=[e],n=this.model.length,r=0;r<n-1;r++){for(var i=[],s=0;s<this.model[r].length;s++)this.model[r][s].forward(a,this.ReLU),i.push(this.model[r][s].output);a=i}this.model[n-1][0].forward(a,this.linear),this.yhat=this.model[n-1][0].output,this.loss.forward(this.yhat,t)}},{key:"backward",value:function(){var e=this.add,t=this.zeros;this.loss.backward();var a=[this.loss.dInputs],n=this.model.length;this.model[n-1][0].backward(a[0],this.dLinear),a=this.model[n-1][0].dInputs;for(var r=n-2;r>=0;r--){for(var i=t(this.model[r][0].inputs.length),s=0;s<this.model[r].length;s++)this.model[r][s].backward(a[s],this.dReLU),i=e(i,this.model[r][s].dInputs);a=i}}},{key:"update",value:function(e){for(var t=function(e,t,a){return e-t*a},a=0;a<this.model.length;a++)for(var n=0;n<this.model[a].length;n++)for(var r=0;r<this.model[a][n].dWeights.length;r++){var i=t(this.model[a][n].weights[r],e,this.model[a][n].dWeights[r]),s=t(this.model[a][n].bias,e,this.model[a][n].dBias);this.model[a][n].weights[r]=i,this.model[a][n].bias=s}}}]),e}();function Fe(e,t){for(var a=[],n=0;n<e.length;n++){for(var r=t[n+1],i=[],s=0;s<r;s++){for(var c=[],o=s;o<e[n].length;o+=r)c.push(e[n][o]);i.push(c)}a.push(i)}return a}function Ae(e,t){for(var a=0;a<e.length;a++)for(var n=0;n<e[a].length;n++)e[a][n]=+e[a][n].toFixed(t);return e}function Ne(e){for(var t=[],a=0;a<e.length;a++)for(var n=0;n<e[a].length;n++)t.push(e[a][n]);return t}function Le(e){return Math.floor(Math.random()*Math.floor(e))}function Ee(e){return Array.from(e.dataSync())}function Te(e,t){return{xScale:m.o().domain(e.domain).range(e.range),yScale:m.o().domain(t.domain).range(t.range)}}function Pe(e){return m.j().x((function(t){return t.x+e})).y((function(t){return t.y+e}))}function Be(e,t,a,n,r,i,s){var c=[];c.push([n]);for(var o=1;o<e.length-1;o++){for(var l=[],h=0;h<e[o];h++){var d={x:i(t[o])-a/2,y:s(92-12*h)-a/2};l.push(d)}c.push(l)}return c.push([r]),c}function De(e,t,a){for(var n=[],r=[],i=[],s=1;s<e.length;s++){i=[];for(var c=0;c<e[s];c++){n=[];for(var o=0;o<e[s-1];o++)n.push(a({source:t[s-1][o],target:t[s][c]}));i.push(n)}r.push(i)}return r}var Me=function(e){Object(d.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={tensorFlowNN:null,miniNN:null,X:[],y:[],yhat:[],shape:[1,8,8,8,1],lr:.001,epoch:0,cpyEpoch:0,biasesData:[],weightsData:[],lossArray:[],loss:null,scale:5,shapedWeights:[],shapedRects:[],shapedLinks:[],direction:"edgePaused",curve:"sin",controls:{playing:!1,speed:100},mode:!1,stopRender:!1,keyFrameLayer:0,keyFrameLoss:0,keyFrameScatter:0,subEpoch:"",isAnimating:!1,lossSavings:0,lossDifference:0,singleInputExample:0,singleLabelExample:0,newOutput:0,controlCenterHelp:!1,customizationHelp:!1,neuralNetworkHelp:!1,lossChange:0,potentialYhat:[],singleInputIndex:-1,shouldNotRender:!1,status:"reset",zoom:1},n.initNeuralNetwork=n.initNeuralNetwork.bind(Object(H.a)(n)),n.run=n.run.bind(Object(H.a)(n)),n.genTensorData=n.genTensorData.bind(Object(H.a)(n)),n.mutate=n.mutate.bind(Object(H.a)(n)),n.train=n.train.bind(Object(H.a)(n)),n.printParameters=n.printParameters.bind(Object(H.a)(n)),n.reset=n.reset.bind(Object(H.a)(n)),n.resetParameters=n.resetParameters.bind(Object(H.a)(n)),n.asyncPause=n.asyncPause.bind(Object(H.a)(n)),n.changeModelLr=n.changeModelLr.bind(Object(H.a)(n)),n.anim=n.anim.bind(Object(H.a)(n)),n.randExampleEpoch=n.randExampleEpoch.bind(Object(H.a)(n)),n}return Object(h.a)(a,[{key:"randExampleEpoch",value:function(e,t,a,r,i,s){var c=n.getRandomInt(this.state.X.length),o=e[c],l=t[c],h=n.formatWeightArray(a,i),d=new Ce(i,h,r),u=new Ce(i,h,r);d.forward(o,l),d.backward(),u.forward(o,l),u.backward(),u.update(s),u.forward(o,l);var j=u.yhat,b=u.loss.output,p=b,x=d.loss.output-b,f=function(e){for(var t=e.length,a=new Array(t),n=0;n<t;n++)u.forward(e[n],0),a[n]=u.yhat;return a}(e);this.setState(Object(q.a)(Object(q.a)({},this.state),{},{miniNN:d,potentialYhat:f,mode:!0,lossSavings:p,lossDifference:x,singleInputIndex:c,singleInputExample:o,singleLabelExample:l,newOutput:j,controls:Object(q.a)(Object(q.a)({},this.state.controls),{},{playing:!1})}))}},{key:"anim",value:function(){var e=Object(k.a)(w.a.mark((function e(){var t,a,n,r,i;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.state.shape,a=750,n=function(e){return new Promise((function(t){return setTimeout(t,e)}))},this.setState({subEpoch:"forward",status:"reset",isAnimating:!0,lossChange:0,cpyEpoch:this.state.epoch,keyFrameScatter:0}),r=0;case 5:if(!(r<t.length)){e.next=14;break}if(this.setState({keyFrameLayer:r}),r!==t.length-1){e.next=9;break}return e.abrupt("continue",11);case 9:return e.next=11,n(a);case 11:r++,e.next=5;break;case 14:return this.setState({keyFrameLoss:1,keyFrameScatter:1,status:"real",shouldNotRender:!0}),e.next=17,n(a);case 17:return this.setState({keyFrameLoss:2,shouldNotRender:!0}),e.next=20,n(a);case 20:this.setState({keyFrameLoss:3}),this.setState({lossChange:this.state.miniNN.loss.output}),this.setState({subEpoch:"backward",keyFrameScatter:2}),i=t.length-1;case 24:if(!(i>=0)){e.next=31;break}return this.setState({keyFrameLayer:i}),e.next=28,n(a);case 28:i--,e.next=24;break;case 31:return this.setState({keyFrameLayer:-1}),e.next=34,n(a);case 34:return this.setState({subEpoch:"transition"}),e.next=37,n(1e3);case 37:return this.setState({subEpoch:"update",shouldNotRender:!1}),e.next=40,n(1e3);case 40:this.setState({isAnimating:!1,lossChange:this.state.lossSavings,keyFrameScatter:4,cpyEpoch:this.state.cpyEpoch+1,status:"pred"});case 41:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"initNeuralNetwork",value:function(e){var t=this.state.controls.playing;if(t){if(t){var a=this.state,i=a.weightsData,s=a.shape,c=n.formatWeightArray(i,s);this.setState({shapedWeights:c})}}else{var o=32,l=r.generateLinearScale({domain:[0,100],range:[50,750]},{domain:[0,100],range:[500,0]}),h=l.xScale,d=l.yScale,u={x:55,y:234},j={x:734,y:234},b=r.generateLink(16),p=r.generateNeuronPlacement(e,[0,25,50,75,0],o,u,j,h,d),x=r.generateLinksPlacement(e,p,b);p.splice(0,1),this.setState({shapedLinks:x,shapedRects:p})}}},{key:"changeModelLr",value:function(e){var t=this;K.r((function(){t.setState({lr:e})}))}},{key:"run",value:function(){var e=Object(k.a)(w.a.mark((function e(){var t;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=!this.state.controls.playing,this.mutate("controls","playing",t),!0!==t){e.next=5;break}return e.next=5,this.train(this.state.X,this.state.y);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"mutate",value:function(e,t,a){var n=this;K.r((function(){var r=Object(q.a)({},n.state);e in r&&t in r[e]?(r[e][t]=a,n.setState({state:r})):console.error("Could not be found in state")}))}},{key:"addModel",value:function(e){var t=this;return K.r((function(){var a=t.state.shape;e.add(K.d.dense({inputShape:[1],units:a[1],activation:"relu",useBias:!0}));for(var n=2;n<a.length-1;n++)e.add(K.d.dense({units:a[n],activation:"relu",useBias:!0}));return e.add(K.d.dense({units:1,activation:"linear",useBias:!0})),e}))}},{key:"modelCompile",value:function(e){var t=K.k();return this.addModel(t),t.compile({optimizer:K.s.sgd(e),loss:"meanSquaredError"}),t}},{key:"train",value:function(){var e=Object(k.a)(w.a.mark((function e(t,a){var r,i,s,c,o,l,h,d,u=this;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=K.r((function(){return K.q(t)})),i=K.r((function(){return K.q(a)})),s=K.r((function(){return u.state.tensorFlowNN})),c=function(e){return new Promise((function(t){return setTimeout(t,e)}))},o=this.state.controls.playing;case 5:if(!1===o){e.next=17;break}return this.setState({stopRender:!0}),l=this.state.controls,h=l.playing,d=l.speed,o=h,e.next=11,s.fit(r,i,{epochs:1,batchSize:1});case 11:return K.r((function(){var e=s.predict(r),t=n.tensorToArray(e),i=K.f.meanSquaredError(a,t).dataSync()[0];u.printParameters(s,i,t,u.state.epoch+1)})),this.setState({stopRender:!1}),e.next=15,c(d);case 15:e.next=5;break;case 17:this.setState({tensorFlowNN:s}),K.c(r),K.c(i);case 20:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"genTensorData",value:function(){var e=Object(k.a)(w.a.mark((function e(t,a,r){var i=this;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,K.j();case 2:K.r((function(){var e=K.e(-i.state.scale,i.state.scale,r),s=K.h(t(e),a),c=K.t(e),o=n.tensorToArray(e),l=n.tensorToArray(s),h=n.tensorToArray(c);i.setState({X:o,y:l,yhat:h})}));case 3:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}()},{key:"printParameters",value:function(e,t,a,n){for(var r=[],i=[],s=0;s<e.getWeights().length;s++)(s%2===0?r:i).push(Array.from(e.getWeights()[s].dataSync()));var c=[].concat(Object(ue.a)(this.state.lossArray),[t]);this.setState({biasesData:i,weightsData:r,loss:t,yhat:a,epoch:n,lossArray:c}),this.initNeuralNetwork(this.state.shape)}},{key:"asyncPause",value:function(){var e=Object(k.a)(w.a.mark((function e(){return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.setState({controls:Object(q.a)(Object(q.a)({},this.state.controls),{},{playing:!1})});case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"resetParameters",value:function(){var e=Object(k.a)(w.a.mark((function e(t){var a,n,r,i=this;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return K.c(this.state.tensorFlowNN),a=this.state.curve,K.r((function(){"sin"===a?n=K.m:"tanh"===a?n=K.p:"cos"===a&&(n=K.b)})),e.next=5,this.genTensorData(n,t,50);case 5:r=K.r((function(){return i.modelCompile(i.state.lr)})),this.setState({epoch:0,loss:null,miniNN:null,tensorFlowNN:r,shapedWeights:[],lossArray:[]}),K.c(undefined);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"reset",value:function(){var e=Object(k.a)(w.a.mark((function e(t){return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.asyncPause(),this.resetParameters(t);case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"correctZoom",value:function(e){var t=.25/474;return Math.min(1,t*e+.26845991561181437-.2)}},{key:"componentDidMount",value:function(){var e=Object(k.a)(w.a.mark((function e(){var t,a,n,r=this;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:K.l("cpu"),this.genTensorData(K.m,this.state.scale,50),this.initNeuralNetwork(this.state.shape),t=K.r((function(){return r.modelCompile(r.state.lr)})),a=document.body.clientWidth,n=this.correctZoom(a),this.setState({tensorFlowNN:t,zoom:n});case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"shouldComponentUpdate",value:function(){return!this.state.stopRender}},{key:"render",value:function(){var e=this,t=this.state,a=t.X,n=t.y,r=t.shape,i=t.scale,s=t.miniNN,c=t.weightsData,o=t.biasesData,l=t.yhat,h=t.mode,d=t.epoch,u=t.curve,j=t.lr,b=t.loss,p=t.controls,f=t.shapedWeights,m=t.shapedLinks,y=t.shapedRects,v=t.keyFrameLayer,A=t.keyFrameLoss,N=t.subEpoch,L=t.isAnimating,I=t.singleInputExample,H=t.singleLabelExample,X=t.lossSavings,G=t.controlCenterHelp,J=t.customizationHelp,Y=t.neuralNetworkHelp,Z=t.lossChange,Q=t.keyFrameScatter,ee=t.zoom,te=p.playing,ne=p.speed,re=[{label:"sin",eqn:K.m,scale:5},{label:"cos",eqn:K.b,scale:5},{label:"tanh",eqn:K.p,scale:5}],ie=Object(O.jsx)(M.a,{style:{background:this.state.controls.playing?"#D62839":"#175676",color:"white"},disableTouchRipple:!0,onClick:function(){return e.run()},children:te?Object(O.jsx)(V.a,{}):Object(O.jsx)(z.a,{})}),se=Object(O.jsxs)($.a,{children:[Object(O.jsx)(T.a,{title:"reset",arrow:!0,children:Object(O.jsx)(U.a,{disabled:te,onClick:function(){e.reset(i)},children:Object(O.jsx)(_.a,{})})}),ie,Object(O.jsx)(T.a,{title:"speed up",arrow:!0,children:Object(O.jsx)(U.a,{style:{color:0===ne?"#FFC006":"grey"},onClick:function(){e.setState({controls:Object(q.a)(Object(q.a)({},p),{},{speed:0===ne?100:0})})},children:Object(O.jsx)(Oe.a,{})})})]}),ce=Object(O.jsx)(x.a,{marginTop:2,children:Object(O.jsxs)($.a,{children:[Object(O.jsx)(E.a,{onClick:Object(k.a)(w.a.mark((function t(){return w.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.anim();case 2:case"end":return t.stop()}}),t)}))),disabled:L,style:{color:L?"lightgrey":"black",borderColor:L?"lightgrey":"black"},variant:"outlined",size:"small",children:"REPLAY"}),Object(O.jsx)(E.a,{onClick:Object(k.a)(w.a.mark((function t(){return w.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.randExampleEpoch(a,n,c,o,r,j,h),t.next=3,e.anim();case 3:case"end":return t.stop()}}),t)}))),style:{color:L?"lightgrey":"#4BA3C3",borderColor:L?"lightgrey":"#4BA3C3"},disabled:L,variant:"outlined",size:"small",children:"New Training Example"})]})}),oe=Object(O.jsxs)(x.a,{width:400,marginLeft:10,children:[Object(O.jsx)(P.a,{variant:"outlined",children:Object(O.jsxs)(B.a,{children:[Object(O.jsxs)(D.a,{variant:"caption",style:{color:"#4BA3C3"},children:["Control Center",Object(O.jsx)(U.a,{size:"small",style:{color:"orange"},onClick:function(){e.setState({controlCenterHelp:!0})},children:Object(O.jsx)(W.a,{})})]}),Object(O.jsx)("div",{}),Object(O.jsxs)(D.a,{variant:"h4",children:["EPOCH: ",h?this.state.cpyEpoch:d]}),h?Object(O.jsxs)($.a,{children:[Object(O.jsx)(D.a,{style:{color:"orange"},variant:"h6",children:"Phase:"}),Object(O.jsx)(E.a,{disabled:!0,style:{color:"forward"===N?"orange":"grey"},children:"Forward"}),Object(O.jsx)(E.a,{disabled:!0,style:{color:"backward"===N?"orange":"grey"},children:"Backward"}),Object(O.jsx)(E.a,{disabled:!0,style:{color:"update"===N?"orange":"grey"},children:"Update"})]}):"",Object(O.jsx)(D.a,{variant:"h6",children:null==b||h?"":"Loss: ".concat(b.toPrecision(6))}),Object(O.jsx)(D.a,{variant:"h6",style:{color:"#4BA3C3"},children:h?"Training Example: (".concat(I.toPrecision(3),", ").concat(H.toPrecision(3),")"):""}),Object(O.jsxs)(D.a,{variant:"h5",style:{color:Q<3?"black":"orangered"},children:[h&&0!==Z?Q<3?"loss: ":"new loss: ":"",h&&0!==Z?Object(O.jsx)(be.a,{value:Z,formatValue:function(e){return e.toPrecision(6)},duration:750}):""]}),Object(O.jsxs)(D.a,{style:{color:"grey"},variant:"caption",children:[Q>3&&h?"loss decrease: ":"",Q>3&&h?Object(O.jsx)(be.a,{value:this.state.lossDifference,formatValue:function(e){return e.toPrecision(6)},duration:750}):""]}),h?ce:se,Object(O.jsx)($.a,{children:null==b||L?"":Object(O.jsxs)(E.a,{variant:"outlined",style:{color:"#175676",borderColor:"#175676"},onClick:Object(k.a)(w.a.mark((function t(){return w.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!h){t.next=5;break}e.setState({subEpoch:"",mode:!h}),e.run(),t.next=8;break;case 5:return e.randExampleEpoch(a,n,c,o,r,j,h),t.next=8,e.anim();case 8:case"end":return t.stop()}}),t)}))),children:[h?Object(O.jsx)(R.a,{}):"",h?"go back to fitting":"Click to Animate epoch ".concat(d)]})})]})}),Object(O.jsx)(x.a,{marginTop:5,children:Object(O.jsx)(P.a,{variant:"outlined",children:Object(O.jsxs)(B.a,{children:[Object(O.jsxs)(D.a,{variant:"caption",style:{color:"#4BA3C3"},children:["Customization",Object(O.jsx)(U.a,{size:"small",style:{color:"orange"},onClick:function(){e.setState({customizationHelp:!0})},children:Object(O.jsx)(W.a,{})})]}),Object(O.jsxs)($.a,{children:[Object(O.jsx)(D.a,{variant:"caption",children:"Learning Rate"}),[1e-4,.001,.003,.005].map((function(t,a){return Object(O.jsx)(pe.a,{disabled:te||h,label:"".concat(t),style:{color:j===t?"white":"grey",background:j===t?"#175676":"lightgrey"},onClick:function(){K.r((function(){e.changeModelLr(t),e.reset(i)}))}},a)}))]}),Object(O.jsxs)($.a,{children:[Object(O.jsx)(D.a,{variant:"caption",children:"Data Set"}),re.map((function(t,a){return Object(O.jsx)(pe.a,{disabled:te||h,label:t.label,style:{color:u===t.label?"white":"grey",background:u===t.label?"#175676":"lightgrey"},onClick:function(){e.setState({shape:r,curve:t.label}),e.reset(i),K.r((function(){e.genTensorData(t.eqn,t.scale,50)}))}},a)}))]}),Object(O.jsxs)($.a,{children:[Object(O.jsx)(D.a,{variant:"caption",children:"Layer"}),Object(O.jsx)(E.a,{disabled:te||h,onClick:function(){var t=r;t.length<5&&(t[t.length-1]=8,t.push(1),e.setState({shape:t}),e.initNeuralNetwork(t),e.reset(i))},children:"+"}),Object(O.jsx)(E.a,{disabled:te||h,onClick:function(){var t=r;t.length>3&&(t.splice(t.length-2,1),e.setState({shape:t}),e.initNeuralNetwork(t),e.reset(i))},children:"\u2013"})]})]})})})]}),le=Object(O.jsxs)(x.a,{marginLeft:10,children:[Object(O.jsx)(x.a,{children:h?Object(O.jsx)(C,{width:300,height:300,padding:0,start:-i,stop:i,X:a,y:n,yhat:l,potential:this.state.potentialYhat,id:2,select:this.state.singleInputIndex,times:this.state.keyFrameScatter,shouldNotRender:this.state.shouldNotRender,status:this.state.status}):Object(O.jsx)(S,{width:300,height:300,padding:0,start:-i,stop:i,X:a,y:n,yhat:l,id:1,duration:200,select:-1})}),Object(O.jsx)(x.a,{marginTop:10,children:Object(O.jsx)(F,{lossArray:this.state.lossArray,duration:100})})]}),he=Object(O.jsxs)(x.a,{children:[Object(O.jsx)(g,{miniNN:s,input:I,label:H,shapedWeights:f,shapedLinks:m,shapedRects:y,shape:r,biases:o,playing:te?0===ne?"edgeForward":"edgeSlowed":"edgePaused",show:te,mode:h,backward:this.state.direction,keyFrameLayer:v,keyFrameLoss:A,subEpoch:N,lossSavings:X,isAnimating:L,lr:j}),Object(O.jsx)(U.a,{size:"small",style:{color:"orange",position:"relative",bottom:"500px",left:"100px"},onClick:function(){e.setState({neuralNetworkHelp:!0})},children:Object(O.jsx)(W.a,{})})]}),de=Object(O.jsxs)("div",{children:[Object(O.jsxs)(xe.a,{PaperProps:{style:{backgroundColor:"#F7F7F7"}},open:G,children:[Object(O.jsx)(fe.a,{children:Object(O.jsx)(U.a,{onClick:function(){e.setState({controlCenterHelp:!1})},children:Object(O.jsx)(ye.a,{})})}),Object(O.jsx)(me.a,{children:Object(O.jsx)(x.a,{display:"flex",justifyContent:"center",children:Object(O.jsxs)(x.a,{marginBottom:1,children:[Object(O.jsx)(D.a,{variant:"h5",children:Object(O.jsx)("b",{children:"Getting Stuck?"})}),Object(O.jsx)(D.a,{variant:"body1",children:Object(O.jsxs)("ol",{children:[Object(O.jsxs)("li",{children:["Press"," ",Object(O.jsx)(M.a,{style:{background:"#175676",color:"white"},size:"small",disabled:!0,children:Object(O.jsx)(z.a,{fontSize:"small"})})," ","to start training and fitting the curve to the data"]}),Object(O.jsxs)("li",{children:["Then press"," ",Object(O.jsx)(E.a,{variant:"outlined",size:"small",style:{borderColor:"#175676",color:"#175676"},disabled:!0,children:"Click to animate epoch #"})," ","to see forward propagation,"," ",Object(O.jsx)("b",{children:"backward propagation"}),", and update animation at the epoch #. While in this mode, you will have access to the control center"," ",Object(O.jsx)("b",{children:"below"}),Object(O.jsx)("img",{alt:"epochMode",src:ve,width:"100%"})]}),Object(O.jsxs)("li",{children:["To go back to training and fitting the curve to the data click"," ",Object(O.jsxs)(E.a,{variant:"outlined",size:"small",style:{borderColor:"#175676",color:"#175676"},disabled:!0,children:[Object(O.jsx)(R.a,{})," Go back to fitting"]})," "]})]})})]})})})]}),Object(O.jsxs)(xe.a,{PaperProps:{style:{backgroundColor:"#F7F7F7"}},open:J,children:[Object(O.jsx)(fe.a,{children:Object(O.jsx)(U.a,{onClick:function(){e.setState({customizationHelp:!1})},children:Object(O.jsx)(ye.a,{})})}),Object(O.jsx)(me.a,{children:Object(O.jsx)(x.a,{display:"flex",justifyContent:"center",children:Object(O.jsxs)(x.a,{marginBottom:5,children:[Object(O.jsx)(D.a,{variant:"h5",children:Object(O.jsx)("b",{children:"What you can't and can change"})}),Object(O.jsx)("br",{}),Object(O.jsx)(D.a,{variant:"h6",children:Object(O.jsx)("b",{children:"Fixed"})}),Object(O.jsxs)(D.a,{variant:"body1",children:["By default, this Neural Network stays fixed with",Object(O.jsxs)("ol",{children:[Object(O.jsx)("li",{children:"one input neuron, at least one hidden layer of eight ReLU neurons, and an output layer with one linear neuron."}),Object(O.jsx)("li",{children:"Stochastic Gradient Descent (one training example per epoch)"})]})]}),Object(O.jsx)(D.a,{variant:"h6",children:Object(O.jsx)("b",{children:"Variable"})}),Object(O.jsxs)(D.a,{variant:"body1",children:["You have the ability to change",Object(O.jsxs)("ol",{children:[Object(O.jsx)("li",{children:"Learning Rate (0.0001, 0.001, 0.003, or 0.005)"}),Object(O.jsx)("li",{children:"Data set (sine wave, cosine wave, or tanh curve)"}),Object(O.jsx)("li",{children:"Hidden layer neurons (min 1 and max 3)"})]})]})]})})})]}),Object(O.jsxs)(xe.a,{PaperProps:{style:{backgroundColor:"#FAFAFA"}},open:Y,children:[Object(O.jsx)(fe.a,{children:Object(O.jsx)(U.a,{onClick:function(){e.setState({neuralNetworkHelp:!1})},children:Object(O.jsx)(ye.a,{})})}),Object(O.jsxs)(me.a,{children:[Object(O.jsx)(x.a,{display:"flex",justifyContent:"center",children:Object(O.jsx)(x.a,{children:Object(O.jsx)("img",{src:ae,alt:"summary",width:"400"})})}),Object(O.jsx)(x.a,{display:"flex",justifyContent:"center",children:Object(O.jsxs)(x.a,{marginBottom:5,children:[Object(O.jsx)(D.a,{variant:"h6",children:Object(O.jsx)("b",{children:"Neural Network"})}),Object(O.jsx)(D.a,{variant:"body1",children:"Each square is a neuron in the neural network. To see what activation function the neuron has, check the key located right above the neural network."})]})}),Object(O.jsx)("img",{src:ge,alt:"singleSummary",width:"100%"}),Object(O.jsx)(x.a,{display:"flex",justifyContent:"center",children:Object(O.jsxs)(x.a,{marginBottom:5,children:[Object(O.jsx)(D.a,{variant:"h6",children:Object(O.jsx)("b",{children:"Single EPOCH mode"})}),Object(O.jsxs)(D.a,{variant:"body1",children:["During a single epoch after clicking"," ",Object(O.jsx)(E.a,{variant:"outlined",size:"small",style:{borderColor:"#175676",color:"#175676"},disabled:!0,children:"Click to animate epoch #"})," ",", each arrow will represent the direction to nudge the output to lower loss."]}),Object(O.jsx)(D.a,{variant:"body1",children:"The fill color shows the activation output, brighter is more active."})]})})]})]})]});return Object(O.jsxs)("div",{id:"app",children:[Object(O.jsx)(P.a,{variant:"outlined",style:{background:"#FAFAFA",outlineColor:"white",paddingBottom:"1em"},children:Object(O.jsxs)(B.a,{style:{transform:"scale(".concat(ee,")")},children:[Object(O.jsxs)(x.a,{display:"flex",justifyContent:"center",children:[Object(O.jsx)(x.a,{marginRight:90,children:Object(O.jsx)("img",{src:we,alt:"key"})}),Object(O.jsx)(x.a,{children:Object(O.jsx)(D.a,{variant:"h3",children:"Backprop Explainer"})})]}),Object(O.jsxs)(x.a,{className:"regular",display:"flex",justifyContent:"center",marginTop:2,children:[he,le,oe]})]})}),de]})}}]),a}(i.Component),ze=a(622),Re=function(e,t,a){return Object(O.jsx)(E.a,{style:{color:a?"#FFA500":"#155676"},href:e,target:"_blank",rel:"noopener noreferrer",children:t})},We=function(){return Object(O.jsx)(x.a,{display:"flex",justifyContent:"center",children:Object(O.jsxs)(x.a,{width:"60%",children:[Object(O.jsx)(D.a,{variant:"h3",children:"Acknowledgements"}),Object(O.jsx)(f.a,{}),Object(O.jsx)("br",{}),Object(O.jsxs)(D.a,{variant:"body1",children:[Re("https://playground.tensorflow.org/","TensorFlow Playground",!1),"by",Re("https://smilkov.com/","Daniel Smilkov",!0),Re("http://shancarter.com/","Shan Carter",!0),Object(O.jsxs)("ul",{children:[Object(O.jsx)("li",{children:"Inspiration for the representation of the neural network"}),Object(O.jsx)("li",{children:"Adapted d3 code for the loss graph\u2019s and best fit graphs axis scaling"}),Object(O.jsx)("li",{children:"Adapted css code for the links keyframe animation"})]})]}),Object(O.jsx)("br",{}),Object(O.jsxs)(D.a,{variant:"body1",children:[Re("https://www.youtube.com/watch?v=Ilg3gGewQ5U","What is backpropagation really doing?",!1),"by",Re("https://www.3blue1brown.com/","3Blue1Brown",!0),Object(O.jsxs)("ul",{children:[Object(O.jsx)("li",{children:"Inspiration to use arrows to represent where to nudge outputs to lower loss"}),Object(O.jsx)("li",{children:"Inspiration for weights color scheme"})]})]}),Object(O.jsx)("br",{}),Object(O.jsxs)(D.a,{variant:"body1",children:[Re("https://poloclub.github.io/cnn-explainer/","CNN explainer",!1),"by",Re("https://zijie.wang/","Jay Wang",!0),Re("https://www.linkedin.com/in/robert-turko/","Robert Turko",!0),Re("https://oshaikh.com/","Omar Shaikh",!0),Re("https://haekyu.com/","Haekyu Park",!0),Re("http://nilakshdas.com/","Nilaksh Das",!0),Re("https://fredhohman.com/","Fred Hohman",!0),Re("https://minsuk.com/","Minsuk Kahng",!0),Re("https://www.cc.gatech.edu/~dchau/","Polo Chau",!0),Object(O.jsxs)("ul",{children:[Object(O.jsx)("li",{children:"Model for what good animation look like"}),Object(O.jsx)("li",{children:"Inspiration for the article format with components"}),Object(O.jsx)("li",{children:"Inspiration for the name backprop explainer"})]})]}),Object(O.jsx)("br",{}),Object(O.jsxs)(D.a,{variant:"body1",children:[Re("https://distill.pub/2020/communicating-with-interactive-articles/","Communicating with Interactive Articles",!1),Re("https://fredhohman.com/","Fred Hohman",!0),Re("https://mathisonian.com/","Matthew Conlen",!0),Re("https://homes.cs.washington.edu/~jheer/","Jeffrey Heer",!0),Re("https://www.cc.gatech.edu/~dchau/","Polo Chau",!0),Object(O.jsx)("ul",{children:Object(O.jsx)("li",{children:"Used colored labeling to toggle labels for notation"})})]}),Object(O.jsx)("br",{}),Object(O.jsx)(D.a,{variant:"h4",children:"Who made this?"}),Object(O.jsxs)(D.a,{variant:"body1",children:["Created by",Re("http://donnybertucci.com/","Donny Bertucci",!0)," and",Re("http://minsuk.com/","Minsuk Kahng",!0)," (project advisor)"]}),Object(O.jsx)(D.a,{variant:"h4",children:"How was this made?"}),Object(O.jsxs)(D.a,{variant:"body1",children:["Made with",Re("https://d3js.org/","d3.js",!1),"and",Re("https://reactjs.org/","react.js",!1),"for interactive visualization components,",Re("https://www.tensorflow.org/js","tensorflow.js",!1),"for neural network training and fast math operations, and",Re("https://katex.org/",N("\\KaTeX"),!1),"to render ",N("\\LaTeX")," math equations."]}),Object(O.jsx)(D.a,{variant:"h4",children:"Found any errors?"}),Object(O.jsxs)(D.a,{variant:"body1",children:["Please create an issue on",Object(O.jsx)(U.a,{href:"https://github.com/xnought/backprop-explainer",children:Object(O.jsx)(ze.a,{})}),"if you found an issue in the article, any of the components, or in the Backprop Explainer."]}),Object(O.jsx)("br",{})]})})},Ie=a.p+"static/media/demo.53081202.gif",qe=function(){var e=function(e,t){return Object(O.jsx)(E.a,{style:{color:"#5B5B5B"},size:"small",onClick:function(){I.scroller.scrollTo(t,{duration:1500,delay:100,smooth:!0})},children:e})},t=function(e,t){return Object(O.jsx)(E.a,{onClick:function(){I.scroller.scrollTo(t,{duration:1500,delay:100,smooth:!0})},children:e})};return Object(O.jsxs)(x.a,{display:"flex",children:[Object(O.jsxs)(x.a,{children:[Object(O.jsx)(D.a,{variant:"h4",children:"Table Of Contents"}),Object(O.jsxs)("ul",{style:{listStyleType:"none"},children:[Object(O.jsx)("li",{children:t("Introduction","article")}),Object(O.jsxs)("li",{children:[t("Grasping the concept","oneNeuron"),Object(O.jsxs)("ul",{style:{listStyleType:"none"},children:[Object(O.jsx)("li",{children:e("Getting started","getting")}),Object(O.jsx)("li",{children:e("defining backpropagation","definition")}),Object(O.jsx)("li",{children:e("concrete example","concrete")}),Object(O.jsx)("li",{children:e("see it in action","see1")})]})]}),Object(O.jsxs)("li",{children:[t("Implementation on Neural Network","scaling"),Object(O.jsxs)("ul",{style:{listStyleType:"none"},children:[Object(O.jsx)("li",{children:e("the changes","changes")}),Object(O.jsx)("li",{children:e("training process","training")}),Object(O.jsx)("li",{children:e("Backprop Explainer","see2")})]})]}),Object(O.jsx)("li",{children:t("acknowledgements","acknowledgements")})]})]}),Object(O.jsxs)(x.a,{margin:7,width:"50%",children:[Object(O.jsx)(D.a,{variant:"caption",children:"Preview of Backprop Explainer"}),Object(O.jsx)("br",{}),Object(O.jsx)(E.a,{onClick:function(){I.scroller.scrollTo("see2",{duration:1500,delay:100,smooth:!0})},children:Object(O.jsx)("img",{src:Ie,alt:"demo"})})]})]})},He=350,Xe=Object(b.a)({overrides:{MuiTypography:{h1:{fontWeight:He},h2:{fontWeight:He},h3:{marginTop:15,fontWeight:He},h4:{marginTop:15,fontWeight:He},h5:{fontWeight:He},h6:{fontWeight:He},body1:{fontWeight:He},body2:{fontWeight:He}}}}),Ge=function(e){Object(d.a)(a,e);var t=Object(u.a)(a);function a(){return Object(l.a)(this,a),t.apply(this,arguments)}return Object(h.a)(a,[{key:"componentDidMount",value:function(){j.a.initialize("UA-192166007-1"),j.a.pageview("/")}},{key:"render",value:function(){return Object(O.jsx)(p.a,{theme:Xe,children:Object(O.jsxs)("div",{children:[Object(O.jsx)(de,{}),Object(O.jsx)(x.a,{justifyContent:"center",display:"flex",children:Object(O.jsx)(x.a,{children:Object(O.jsx)(qe,{})})}),Object(O.jsx)("br",{}),Object(O.jsx)(f.a,{}),Object(O.jsx)(le,{}),Object(O.jsx)(I.Element,{name:"mainTool",children:Object(O.jsx)(Me,{})}),Object(O.jsx)(I.Element,{name:"acknowledgements",children:Object(O.jsx)(We,{})}),Object(O.jsx)("br",{})]})})}}]),a}(i.Component),Ue=(a(584),function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,632)).then((function(t){var a=t.getCLS,n=t.getFID,r=t.getFCP,i=t.getLCP,s=t.getTTFB;a(e),n(e),r(e),i(e),s(e)}))});o.a.render(Object(O.jsx)(s.a.StrictMode,{children:Object(O.jsx)(Ge,{})}),document.getElementById("root")),Ue()}},[[585,1,2]]]);
//# sourceMappingURL=main.3a53b79a.chunk.js.map