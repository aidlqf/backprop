(this["webpackJsonpBackpropagation-Visualizer"]=this["webpackJsonpBackpropagation-Visualizer"]||[]).push([[0],{441:function(t,e,a){},447:function(t,e,a){},452:function(t,e){},453:function(t,e){},461:function(t,e){},464:function(t,e){},465:function(t,e){},466:function(t,e,a){"use strict";a.r(e);var n=a(17),r=a.n(n),s=a(159),c=a.n(s),i=a(19),o=a(169),l=a(3),u=a.n(l),h=a(11),p=a(4),d=a(10),f=a(48),v=a(12),j=a(13),b=a(480),g=a(481),y=a(482),m=a(491),O=a(483),x=a(484),k=a(485),w=a(486),C=a(493),S=a(489),A=a(487),M=a(488),D=(a(441),a(477)),F=a(478),P=a(479),T=a(34),z=function(t){var e=t.playing;return Object(T.jsx)(D.a,{style:{background:e?"#f44336":"#4caf50",color:"#FFFFFF"},children:e?Object(T.jsx)(F.a,{}):Object(T.jsx)(P.a,{})})},L=a(54),N=function(t){Object(v.a)(a,t);var e=Object(j.a)(a);function a(t){var n;return Object(p.a)(this,a),(n=e.call(this,t)).state={},n.initNeuralNetwork=n.initNeuralNetwork.bind(Object(f.a)(n)),n}return Object(d.a)(a,[{key:"initNeuralNetwork",value:function(t){var e=this.props,a=e.playing,n=e.shape,r=e.weights,s=e.slowed,c=t,i=L.e().domain([0,100]).range([50,750]),o=L.e().domain([0,100]).range([500,0]),l={x:34,y:234},u={x:734,y:234},h=L.d().x((function(t){return t.x+16})).y((function(t){return t.y+16})),p=[0,25,50,75,0],d=[],f=[];d.push([l]),f.push(l);for(var v=1;v<n.length-1;v++){for(var j=[],b=0;b<n[v];b++){var g={x:i(p[v])-16,y:o(92-12*b)-16};j.push(g),f.push(g)}d.push(j)}f.push(u),d.push([u]);for(var y=[],m=n.length-1;m>0;m--)for(var O=0;O<n[m-1];O++)for(var x=0;x<n[m];x++)y.push(h({source:d[m-1][O],target:d[m][x]}));var k=this.flatten(r);c.selectAll("path").data(y).enter().append("path").attr("fill","none").attr("class","edgeForward").attr("stroke","green").attr("stroke-width","0.5").attr("d",(function(t){return t})),c.selectAll("path").data(k).attr("stroke-width",(function(t){return Math.pow(t,2)+.2})).attr("stroke",(function(t){return t>0?"#48b778":"#f50257"})),c.selectAll("rect").data(f).enter().append("rect").attr("x",(function(t){return t.x})).attr("y",(function(t){return t.y})).attr("width",32).attr("height",32).attr("class","node"),a?a&&c.selectAll("path").attr("class",s?"edgeSlowed":"edgeForward"):c.selectAll("path").attr("class","edgePaused")}},{key:"componentDidMount",value:function(){var t=L.f("#nn").append("svg").attr("width",800).attr("height",500).attr("overflow","visible");this.initNeuralNetwork(t)}},{key:"flatten",value:function(t){for(var e=[],a=0;a<t.length;a++)for(var n=0;n<t[a].length;n++)e.push(t[a][n]);return e}},{key:"revereseFlatten",value:function(t){for(var e=[],a=t.length-1;a>=0;a--)for(var n=0;n<t[a].length;n++)e.push(t[a][n]);return e}},{key:"perNeuron",value:function(t,e){var a=[];if(t.length>0){var n=this.revereseFlatten(t);console.log(n),console.log(t);for(var r=0,s=e.length-1;s>0;s--){for(var c=[],i=0;i<e[s];i++){for(var o=e[s-1],l=[],u=0;u<o;u++)l.push(n[r]),r++;c.push(l)}a.push(c)}}return a.reverse()}},{key:"componentDidUpdate",value:function(){var t=L.f("#nn").select("svg");this.initNeuralNetwork(t)}},{key:"render",value:function(){var t=this.props.children;return Object(T.jsx)("div",{id:"nn",children:t})}}]),a}(n.Component),E=(a(447),function(t){Object(v.a)(a,t);var e=Object(j.a)(a);function a(t){var n;return Object(p.a)(this,a),(n=e.call(this,t)).state={},n}return Object(d.a)(a,[{key:"plotPoints",value:function(t,e){t.selectAll("circle").data(e).enter().append("circle").attr("cx",(function(t){return t.x})).attr("cy",(function(t){return t.y})).attr("r",2).style("fill","#F50257")}},{key:"componentDidMount",value:function(){var t=Object(h.a)(u.a.mark((function t(){var e,a,n,r,s,c,i,o,l,h,p,d;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=this.props,a=e.width,n=e.height,r=e.padding,s=e.start,c=e.stop,i=L.f("#nice"),(o=i.append("svg").attr("width",a).attr("height",n).style("overflow","visible")).append("rect").attr("width",a).attr("height",n).attr("class","cord"),l=L.e().domain([s,c]).range([0,a-2*r]),h=L.e().domain([s,c]).range([n-2*r,0]),p=L.a().scale(l),d=L.b().scale(h),o.append("g").attr("class","axis").attr("transform","translate(0,".concat(n-2*r,")")).call(p),o.append("g").attr("class","axis").attr("transform","translate("+(a-2*r)+",0)").call(d),o.append("line").attr("x1",0).attr("y1",(n+1)/2).attr("x2",a).attr("y2",(n+1)/2).attr("class","split"),o.append("line").attr("x1",(a+1)/2).attr("y1",0).attr("x2",(a+1)/2).attr("y2",n).attr("class","split"),o.append("path").attr("id","epic").attr("stroke","none").attr("fill","none");case 13:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){for(var t=this.props,e=t.width,a=t.height,n=t.padding,r=t.start,s=t.stop,c=t.X,i=t.y,o=t.yhat,l=L.e().domain([r,s]).range([0,e-2*n]),u=L.e().domain([r,s]).range([a-2*n,0]),h=L.f("#nice").select("svg"),p=[],d=0;d<c.length;d++)p.push({x:l(c[d]),y:u(i[d])});for(var f=[],v=0;v<c.length;v++)f.push([l(c[v]),u(o[v])]);h.selectAll("circle").remove(),this.plotPoints(h,p),h.select("#epic").attr("d",L.c()(f)).attr("stroke","black").attr("fill","none")}},{key:"render",value:function(){return Object(T.jsx)("div",{id:"nice"})}}]),a}(n.Component)),B=a(42);a(223);B.j("webgl");var q=function(t){Object(v.a)(a,t);var e=Object(j.a)(a);function a(t){var n;return Object(p.a)(this,a),(n=e.call(this,t)).state={loss:null,duringEpoch:!1,X:null,y:null,shape:[1,4,4,1],epoch:0,yhat:[],biasData:[],weightsData:[],lr:.1,data:{X:[],y:[]},scale:5,model:{seq:{},neurons:[],shape:[1,4,4,1],loss:null,y:null,yhat:[],dlossdyhat:null,epoch:0,lr:.01,curve:"sin",optimizer:"adam",scale:5},controls:{playing:!1,speed:0}},n.run=n.run.bind(Object(f.a)(n)),n.genTensorData=n.genTensorData.bind(Object(f.a)(n)),n.mutate=n.mutate.bind(Object(f.a)(n)),n.train=n.train.bind(Object(f.a)(n)),n.printParameters=n.printParameters.bind(Object(f.a)(n)),n.reset=n.reset.bind(Object(f.a)(n)),n.asyncPause=n.asyncPause.bind(Object(f.a)(n)),n.resetParameters=n.resetParameters.bind(Object(f.a)(n)),n.changeModelLr=n.changeModelLr.bind(Object(f.a)(n)),n.changeModelOptimizer=n.changeModelOptimizer.bind(Object(f.a)(n)),n}return Object(d.a)(a,[{key:"changeModelOptimizer",value:function(){var t=Object(h.a)(u.a.mark((function t(e){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},{key:"changeModelLr",value:function(t){var e=this;B.n((function(){e.setState({lr:t})}))}},{key:"ReLU",value:function(t){return Math.max(0,t)}},{key:"mseDerivative",value:function(t,e){return 2*(t-e)}},{key:"mseLoss",value:function(t,e){return Math.pow(t-e,2)}},{key:"mult",value:function(t,e){return t.map((function(t,a){return t*e[a]}))}},{key:"sum",value:function(t){return t.reduce((function(t,e){return t+e}))}},{key:"getRandomInt",value:function(t){return Math.floor(Math.random()*Math.floor(t))}},{key:"run",value:function(){var t=Object(h.a)(u.a.mark((function t(){var e;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=!this.state.controls.playing,this.mutate("controls","playing",e),!0!==e){t.next=5;break}return t.next=5,this.train(this.state.data.X,this.state.data.y);case 5:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"mutate",value:function(t,e,a){var n=this;B.n((function(){var r=Object(o.a)({},n.state);t in r&&e in r[t]?(r[t][e]=a,n.setState({state:r})):console.error("Could not be found in state")}))}},{key:"tensorToArray",value:function(t){return Array.from(t.dataSync())}},{key:"addModel",value:function(t){var e=this;return B.n((function(){var a=e.state.shape;t.add(B.c.dense({inputShape:[1],units:a[1],activation:"relu",useBias:!0}));for(var n=2;n<a.length-1;n++)t.add(B.c.dense({units:a[n],activation:"relu",useBias:!0}));return t.add(B.c.dense({units:1,activation:"linear",useBias:!0})),t}))}},{key:"modelCompile",value:function(t,e){var a=B.i();return this.addModel(a),a.compile({optimizer:t(e),loss:"meanSquaredError"}),a}},{key:"train",value:function(){var t=Object(h.a)(u.a.mark((function t(e,a){var n,r,s,c,i,o=this;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=B.n((function(){return B.m(e)})),r=B.n((function(){return B.m(a)})),s=this.modelCompile(B.o.adam,this.state.lr),this.setState({epoch:0}),c=this.state.controls.playing;case 5:if(!1===c){t.next=15;break}return this.setState({duringEpoch:!0}),i=this.state.controls.playing,c=i,t.next=11,s.fit(n,r,{epochs:1});case 11:B.n((function(){var t=s.predict(n),e=o.tensorToArray(t),r=B.e.meanSquaredError(a,e).dataSync()[0];o.printParameters(s,r,e,o.state.epoch+1)})),this.setState({duringEpoch:!1}),t.next=5;break;case 15:B.b(s),B.b(n),B.b(r);case 18:case"end":return t.stop()}}),t,this)})));return function(e,a){return t.apply(this,arguments)}}()},{key:"genTensorData",value:function(){var t=Object(h.a)(u.a.mark((function t(e,a){var n=this;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,B.h();case 2:B.n((function(){var t,r=B.d(-n.state.scale,n.state.scale,50);t=B.g(e(r),a);var s=B.p(r),c=n.tensorToArray(r),i=n.tensorToArray(t),l=n.tensorToArray(s);n.setState(Object(o.a)(Object(o.a)({},n.state),{},{data:{X:c,y:i},yhat:l}))}));case 3:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}()},{key:"printParameters",value:function(t,e,a,n){for(var r=performance.now(),s=[],c=[],i=0;i<t.getWeights().length;i++)(i%2===0?s:c).push(Array.from(t.getWeights()[i].dataSync()));this.setState({weightsData:s,loss:e,yhat:a,epoch:n});var o=performance.now();console.log("PRINT SPEED: ".concat(o-r))}},{key:"asyncPause",value:function(){var t=Object(h.a)(u.a.mark((function t(){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.mutate("controls","playing",!1);case 1:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"resetParameters",value:function(){var t=Object(h.a)(u.a.mark((function t(e){var a,n;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"sin"===this.state.model.curve?a=B.k:"tanh"===this.state.model.curve?a=B.l:"cos"===this.state.model.curve&&(a=B.a),"adam"===this.state.model.optimizer?n=B.o.adam:"sgd"===this.state.model.optimizer&&(n=B.o.sgd),t.next=4,this.genTensorData(a,e);case 4:this.setState(Object(o.a)(Object(o.a)({},this.state),{},{epoch:0,loss:null})),B.b(n);case 6:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"reset",value:function(){var t=Object(h.a)(u.a.mark((function t(e){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.asyncPause(),this.resetParameters(e);case 2:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){var t=Object(h.a)(u.a.mark((function t(){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.genTensorData(B.k,this.state.model.scale);case 1:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"shouldComponentUpdate",value:function(){return!this.state.duringEpoch}},{key:"render",value:function(){var t=this,e=this.state,a=e.model,n=e.controls,r=(a.epoch,a.loss,this.state.shape),s=Object(i.a)(r);s.splice(0,1),s.splice(s.length-1,1);var c=[.001,.01,.1,.3,1..toFixed(1)],o=[{label:"sin",eqn:B.k,scale:5},{label:"cos",eqn:B.a,scale:5},{label:"tanh",eqn:B.l,scale:5}],l=Object(T.jsx)("a",{onClick:Object(h.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.run();case 2:case"end":return e.stop()}}),e)}))),children:Object(T.jsx)(z,{playing:n.playing})});return Object(T.jsxs)("div",{id:"app",children:[Object(T.jsx)(b.a,{position:"static",style:{background:"#f50257",color:"white"},children:Object(T.jsx)(g.a,{children:Object(T.jsx)(y.a,{variant:"h6",children:"Backpropagation Visualizer"})})}),Object(T.jsxs)(m.a,{display:"flex",justifyContent:"center",marginTop:10,children:[Object(T.jsxs)(m.a,{width:400,children:[Object(T.jsx)(O.a,{variant:"outlined",children:Object(T.jsxs)(x.a,{children:[Object(T.jsx)(y.a,{variant:"caption",style:{color:"rgb(245, 2, 87, 0.5)"},children:"Control Center"}),Object(T.jsxs)(y.a,{variant:"h4",children:["Epoch: ",this.state.epoch]}),Object(T.jsxs)(y.a,{variant:"h6",children:["loss:"," ",null==this.state.loss?"":this.state.loss.toFixed(6)]}),Object(T.jsxs)(k.a,{children:[Object(T.jsx)(w.a,{disabled:this.state.controls.playing,onClick:function(){t.reset(a.scale)},children:Object(T.jsx)(A.a,{})}),l,Object(T.jsx)(w.a,{style:{color:0===this.state.controls.speed?"grey":"#FFC006"},onClick:function(){t.mutate("controls","speed",0===t.state.controls.speed?100:0)},children:Object(T.jsx)(M.a,{})})]})]})}),Object(T.jsx)(m.a,{marginTop:5,children:Object(T.jsx)(O.a,{variant:"outlined",children:Object(T.jsxs)(x.a,{children:[Object(T.jsx)(y.a,{variant:"caption",style:{color:"rgb(245, 2, 87, 0.5)"},children:"Model Initialization"}),Object(T.jsxs)(k.a,{children:[Object(T.jsx)(y.a,{variant:"caption",children:"Optimizer"}),["adam","sgd"].map((function(e,n){return Object(T.jsx)(C.a,{disabled:t.state.controls.playing,label:e,color:t.state.model.optimizer===e?"secondary":"default",onClick:function(){t.mutate("model","optimizer",e);var n=B.o.sgd,r=B.o.adam;t.changeModelOptimizer("sgd"===e?n:r),B.b(n),B.b(r),t.reset(a.scale)}},n)}))]}),Object(T.jsxs)(k.a,{children:[Object(T.jsx)(y.a,{variant:"caption",children:"Learning Rate"}),c.map((function(e,a){return Object(T.jsx)(C.a,{label:"".concat(e),color:t.state.lr===e?"secondary":"default",onClick:function(){B.n((function(){t.changeModelLr(e)}))}},a)}))]}),Object(T.jsxs)(k.a,{children:[Object(T.jsx)(y.a,{variant:"caption",children:"Data Set"}),o.map((function(e,n){return Object(T.jsx)(C.a,{disabled:t.state.controls.playing,label:e.label,color:t.state.model.curve===e.label?"secondary":"default",onClick:function(){t.setState({shape:r}),t.reset(a.scale),t.mutate("model","curve",e.label),B.n((function(){t.genTensorData(e.eqn,e.scale)}))}},n)}))]})]})})})]}),Object(T.jsx)(m.a,{marginLeft:10,children:Object(T.jsx)(N,{weights:this.state.weightsData,biases:this.state.biasData,shape:this.state.shape,playing:this.state.controls.playing,slowed:0!==this.state.controls.speed,children:Object(T.jsx)(O.a,{variant:"outlined",style:{minWidth:875},children:Object(T.jsx)(m.a,{justifyContent:"start",display:"flex",children:Object(T.jsxs)(k.a,{children:[Object(T.jsx)(m.a,{marginRight:11.5,children:Object(T.jsx)(S.a,{color:"secondary",onClick:function(){var e=t.state.shape;e.length>4||B.n((function(){e.splice(e.length-1),e.push(2),e.push(1),L.f("#app").select("#nn").select("svg").selectAll("path").remove(),L.f("#app").select("#nn").select("svg").selectAll("rect").remove(),t.setState({shape:e}),t.reset(t.state.scale)}))},children:"Add Layer"})}),s.map((function(e,a){return Object(T.jsxs)(m.a,{marginRight:17,children:[Object(T.jsx)(m.a,{marginBottom:1,children:Object(T.jsx)(C.a,{label:"\u2013",onClick:function(){var e=t.state.shape,n=a+1;e[n]=1===e[n]?e[n]:e[n]-1,e[n]>0&&B.n((function(){L.f("#app").select("#nn").select("svg").selectAll("path").remove(),L.f("#app").select("#nn").select("svg").selectAll("rect").remove(),t.setState({shape:e}),t.reset(t.state.scale)}))}})}),Object(T.jsx)(m.a,{children:Object(T.jsx)(C.a,{label:"+",onClick:function(){var e=t.state.shape,n=a+1;e[n]=e[n]>=8?e[n]:e[n]+1,e[a]<=8&&B.n((function(){L.f("#app").select("#nn").select("svg").selectAll("path").remove(),L.f("#app").select("#nn").select("svg").selectAll("rect").remove(),t.setState({shape:e}),t.reset(t.state.scale)}))}})})]},a)})),Object(T.jsx)(m.a,{children:Object(T.jsx)(S.a,{color:"secondary",onClick:function(){var e=a.shape;e.length>2&&(e.splice(e.length-1),e.splice(e.length-1),e.push(1),L.f("#app").select("#nn").select("svg").selectAll("path").remove(),L.f("#app").select("#nn").select("svg").selectAll("rect").remove(),t.setState({shape:e}),t.reset(a.scale))},children:"Remove Layer"})})]})})})})}),Object(T.jsx)(m.a,{marginLeft:10,children:Object(T.jsx)(E,{width:300,height:300,padding:0,start:-this.state.model.scale,stop:this.state.model.scale,X:this.state.data.X,y:this.state.data.y,yhat:this.state.yhat})})]}),Object(T.jsx)(S.a,{onClick:function(){console.table(B.f())},children:"MEM"})]})}}]),a}(n.Component),R=function(t){t&&t instanceof Function&&a.e(3).then(a.bind(null,495)).then((function(e){var a=e.getCLS,n=e.getFID,r=e.getFCP,s=e.getLCP,c=e.getTTFB;a(t),n(t),r(t),s(t),c(t)}))};c.a.render(Object(T.jsx)(r.a.StrictMode,{children:Object(T.jsx)(q,{})}),document.getElementById("root")),R()}},[[466,1,2]]]);
//# sourceMappingURL=main.db9877ff.chunk.js.map