(this["webpackJsonpbackprop-explainer"]=this["webpackJsonpbackprop-explainer"]||[]).push([[0],{176:function(t,e,a){},565:function(t,e){},566:function(t,e){},574:function(t,e){},577:function(t,e){},578:function(t,e){},579:function(t,e,a){},580:function(t,e,a){"use strict";a.r(e);var n={};a.r(n),a.d(n,"$",(function(){return F})),a.d(n,"$$",(function(){return A}));var r={};a.r(r),a.d(r,"formatWeightArray",(function(){return kt})),a.d(r,"toFunc2DArray",(function(){return St})),a.d(r,"flatten",(function(){return Ct})),a.d(r,"getRandomInt",(function(){return Ft})),a.d(r,"tensorToArray",(function(){return At}));var s={};a.r(s),a.d(s,"generateLinearScale",(function(){return Nt})),a.d(s,"generateLink",(function(){return Lt})),a.d(s,"generateNeuronPlacement",(function(){return Tt})),a.d(s,"generateLinksPlacement",(function(){return Pt}));var i=a(10),c=a.n(i),o=a(59),l=a.n(o),h=a(5),d=a(11),u=a(14),j=a(15),p=a.p+"static/media/headerTitle.cff466f0.svg",b=a(263),x=a(33),f=(a(176),a(4)),m=function(t){var e=t.source,a=t.target,n=t.color,r=t.isAnimating;return Object(f.jsxs)("g",{children:[Object(f.jsx)("defs",{children:Object(f.jsx)("marker",{id:"head",orient:"auto",markerWidth:"3",markerHeight:"4",refX:"0.1",refY:"2",children:Object(f.jsx)("path",{d:"M0,0 V4 L2,2 Z",fill:n})})}),Object(f.jsx)("path",{className:r?"absorb":"arrow",id:"arrow-line",markerEnd:"url(#head)",fill:"none",stroke:n,d:"M".concat(e.x,",").concat(e.y,", ").concat(a.x,", ").concat(a.y)})]})},O=function(t){Object(u.a)(a,t);var e=Object(j.a)(a);function a(t){var n;return Object(h.a)(this,a),(n=e.call(this,t)).state={},n}return Object(d.a)(a,[{key:"flatten",value:function(t){for(var e=[],a=0;a<t.length;a++)for(var n=0;n<t[a].length;n++)e.push(t[a][n]);return e}},{key:"isEmpty",value:function(t){return 0===t.length}},{key:"isUndefined",value:function(t){return"undefined"===typeof t}},{key:"isUndefined3d",value:function(t,e,a,n){return this.isUndefined(t[e])||this.isUndefined(t[e][a])||this.isUndefined(t[e][a][n])}},{key:"render",value:function(){var t=this,e=this.props,a=e.playing,n=e.mode,r=e.shapedLinks,s=e.shapedWeights,i=e.shapedRects,c=e.miniNN,o=e.subEpoch,l=e.keyFrameLoss,h=e.keyFrameLayer,d="orange",u=x.k().x((function(t){return t.x})).y((function(t){return t.y})),j="black",p=32,b=function(t,e,a,n,r){var s=n?-a:a;return Object(f.jsx)(m,{source:{x:t,y:e},target:{x:t,y:e+s},color:r,isAnimating:"transition"===o})},O=Object(f.jsx)("svg",{id:"p",width:"810",height:"500",overflow:"visible",children:Object(f.jsxs)("g",{id:"ee",children:[Object(f.jsx)("path",{d:"M 750, 234 L 750, 300",stroke:2===l||1===l?d:j,className:n&&l>0?1===l?"edgeForward":2===l?"edgeBackward":"edgePaused":a}),Object(f.jsx)("path",{d:u({source:{x:766,y:315},target:{x:890,y:430}}),stroke:j,fill:"none",className:a}),Object(f.jsx)("path",{d:u({source:{x:766,y:250},target:{x:890,y:150}}),stroke:j,fill:"none",className:a}),r.map((function(e,r){return e.map((function(e,i){var l="edgePaused",d=!1;return n&&"forward"===o&&r===h?(l="edgeForward",d=!0):n&&"backward"===o&&r===h&&(l="edgeBackward",d=!0),e.map((function(e,h){var u=t.isUndefined3d(s,r,i,h),j=u?[]:s[r][i][h],p=u?1:2*Math.abs(j)+.1,b=u?"lightgrey":j>0?"#4BA3C3":"#D62839";if(n&&"update"===o&&!0===t.props.isAnimating){var m=2*c.model[r][i].dWeights[h],O=.01*m;x.r("#nn").select("#p").select("#ee").select("#cpath".concat(r).concat(i).concat(h)).transition().duration(750).ease(x.d).attr("stroke-width",p-m).transition().duration(750).ease(x.e).attr("stroke-width",p-O)}return Object(f.jsx)("path",{id:"cpath".concat(r).concat(i).concat(h),d:e,className:n?l:a,strokeWidth:p,stroke:d?"orange":b,fill:"none"},"".concat(r).concat(i).concat(h))}))}))})),Object(f.jsx)("rect",{x:55,y:234,width:p,height:p,fill:"darkgrey"}),i.map((function(e,a){return e.map((function(e,r){var s=!1,i="backward"===o||"transition"===o;return(n&&a<=h||i||"update"===o)&&(s=!0),Object(f.jsxs)("g",{children:[Object(f.jsx)("rect",{x:e.x,y:e.y,width:p,height:p,fill:x.o(104,104,104).brighter(s?c.model[a][r].actStep+t.props.lr:1),stroke:734===e.x&&234===e.y?"#507BB6":"black",strokeWidth:3}),null!==c&&n&&i&&a>=h-1&&0!==c.model[a][r].dActStep?b(e.x+16,e.y+16,Math.abs(c.model[a][r].dActStep),c.model[a][r].dActStep<0,d):""]},"".concat(a,",").concat(r))}))})),Object(f.jsx)("rect",{x:734,y:300,width:p,height:p,fill:"none",stroke:"black"}),Object(f.jsx)("text",{fontFamily:"sans-serif",fontSize:"12px",x:739,y:318,children:"loss"})]})});return Object(f.jsx)("div",{id:"nn",children:O})}}]),a}(i.Component),g=a(2),y=a.n(g),v=a(13),w=function(t){Object(u.a)(a,t);var e=Object(j.a)(a);function a(t){var n;return Object(h.a)(this,a),(n=e.call(this,t)).state={},n}return Object(d.a)(a,[{key:"plotPoints",value:function(t,e,a){t.selectAll("circle").data(e).enter().append("circle").attr("cx",(function(t){return t.x})).attr("cy",(function(t){return t.y})).attr("r",(function(t,e){return e===a?5:2})).style("fill",(function(t,e){return e===a?"orange":"grey"}))}},{key:"componentDidMount",value:function(){var t=Object(v.a)(y.a.mark((function t(){var e,a,n,r,s,i,c,o,l,h,d,u,j;return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=this.props,a=e.width,n=e.height,r=e.padding,s=e.start,i=e.stop,c=e.id,o=x.r("#nice".concat(c)),(l=o.append("svg").attr("width",a).attr("height",n).style("overflow","visible")).append("rect").attr("width",a).attr("height",n).attr("class","cord"),h=x.p().domain([s,i]).range([0,a-2*r]),d=x.p().domain([s,i]).range([n-2*r,0]),u=x.a().scale(h),j=x.b().scale(d),l.append("g").attr("class","axis").attr("transform","translate(0,".concat(n-2*r,")")).call(u),l.append("g").attr("class","axis").attr("transform","translate("+(a-2*r)+",0)").call(j),l.append("line").attr("x1",0).attr("y1",(n+1)/2).attr("x2",a).attr("y2",(n+1)/2).attr("class","split"),l.append("line").attr("x1",(a+1)/2).attr("y1",0).attr("x2",(a+1)/2).attr("y2",n).attr("class","split"),l.append("path").attr("id","epic").attr("stroke","none").attr("fill","none");case 13:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){for(var t=this.props,e=t.width,a=t.height,n=t.padding,r=t.start,s=t.stop,i=t.X,c=t.y,o=t.yhat,l=t.id,h=t.select,d=x.p().domain([r,s]).range([0,e-2*n]),u=x.p().domain([r,s]).range([a-2*n,0]),j=x.r("#nice".concat(l)).select("svg"),p=[],b=0;b<i.length;b++)p.push({x:d(i[b]),y:u(c[b])});for(var f=[],m=0;m<i.length;m++)f.push([d(i[m]),u(o[m])]);j.selectAll("circle").remove(),this.plotPoints(j,p,h),j.select("#epic").transition().duration(this.props.duration).attr("d",x.j()(f)).attr("stroke","black").attr("fill","none")}},{key:"render",value:function(){var t=this.props.id;return Object(f.jsx)("div",{id:"nice".concat(t)})}}]),a}(i.Component),k=function(t){Object(u.a)(a,t);var e=Object(j.a)(a);function a(){return Object(h.a)(this,a),e.apply(this,arguments)}return Object(d.a)(a,[{key:"plotPoints",value:function(t,e,a){t.selectAll("circle").data(e).enter().append("circle").attr("cx",(function(t){return t.x})).attr("cy",(function(t){return t.y})).attr("r",(function(t,e){return e===a?5:2})).style("fill",(function(t,e){return e===a?"#4BA3C3":"grey"}))}},{key:"animateTruePredictions",value:function(t,e){t.select("#epic").transition().duration(1e3).ease(x.f).attr("d",x.j()(e)).attr("stroke","blue").attr("fill","none")}},{key:"componentDidMount",value:function(){var t=Object(v.a)(y.a.mark((function t(){var e,a,n,r,s,i,c,o,l,h,d,u,j;return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=this.props,a=e.width,n=e.height,r=e.padding,s=e.start,i=e.stop,c=e.id,o=x.r("#animatedPlot".concat(c)),(l=o.append("svg").attr("width",a).attr("height",n).style("overflow","visible")).append("rect").attr("width",a).attr("height",n).attr("class","cord"),h=x.p().domain([s,i]).range([0,a-2*r]),d=x.p().domain([s,i]).range([n-2*r,0]),u=x.a().scale(h),j=x.b().scale(d),l.append("g").attr("class","axis").attr("transform","translate(0,".concat(n-2*r,")")).call(u),l.append("g").attr("class","axis").attr("transform","translate("+(a-2*r)+",0)").call(j),l.append("line").attr("x1",0).attr("y1",(n+1)/2).attr("x2",a).attr("y2",(n+1)/2).attr("class","split"),l.append("line").attr("x1",(a+1)/2).attr("y1",0).attr("x2",(a+1)/2).attr("y2",n).attr("class","split"),l.append("path").attr("id","epic").attr("stroke","none").attr("fill","none");case 13:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"a",value:function(){for(var t=this.props,e=t.width,a=t.height,n=t.padding,r=t.start,s=t.stop,i=t.X,c=t.y,o=t.yhat,l=t.id,h=t.select,d=t.potential,u=x.p().domain([r,s]).range([0,e-2*n]),j=x.p().domain([r,s]).range([a-2*n,0]),p=x.r("#animatedPlot".concat(l)).select("svg"),b=[],f=0;f<i.length;f++)b.push({x:u(i[f]),y:j(c[f])});for(var m=[],O=[],g=[],y=0;y<i.length;y++){var v=u(i[y]);m.push([v,j(o[y])]),g.push([v,j(d[y])]),O.push([v,j(0)])}p.selectAll("circle").remove(),this.plotPoints(p,b,h),"reset"===this.props.status?p.select("#epic").attr("id","epic").attr("stroke","none").attr("fill","none"):"real"===this.props.status?(p.select("#epic").attr("d",x.j()(O)).attr("stroke","black").attr("fill","none"),p.select("#epic").transition().duration(750).attr("d",x.j()(m))):"pred"===this.props.status&&(p.select("#epic").attr("d",x.j()(m)).attr("stroke","orangered").attr("fill","none"),p.select("#epic").transition().duration(750).attr("d",x.j()(g)))}},{key:"shouldComponentUpdate",value:function(){return!this.props.shouldNotRender}},{key:"render",value:function(){this.a();var t=this.props.id;return Object(f.jsx)("div",{id:"animatedPlot".concat(t)})}}]),a}(i.Component),S=function(t){Object(u.a)(a,t);var e=Object(j.a)(a);function a(t){var n;return Object(h.a)(this,a),(n=e.call(this,t)).state={},n}return Object(d.a)(a,[{key:"componentDidMount",value:function(){var t=x.r("#sweet"),e=100,a=300,n=x.p().domain([0,-1]).range([0,300]),r=x.p().domain([1,1]).range([100,0]),s=t.append("svg").attr("width",a).attr("height",e).style("overflow","visible");s.append("rect").attr("width",a).attr("height",e).attr("class","cord");var i=x.a().scale(n),c=x.b().scale(r);s.append("g").attr("class","axis").attr("id","x").attr("transform","translate(0,".concat(100,")")).call(i),s.append("g").attr("class","axis").attr("id","y").attr("transform","translate(300,0)").call(c.ticks(0)),s.append("path").attr("id","line").attr("stroke","none").attr("fill","none")}},{key:"componentDidUpdate",value:function(){for(var t=this.props,e=t.lossArray,a=t.duration,n=e.length-1,r=x.p().domain([0,n]).range([1,300]),s=x.m(e),i=x.l(e),c=x.p().domain([s,i]).range([100,0]),o=x.r("#sweet").select("svg"),l=[],h=0;h<e.length;h++)l.push([r(h),c(e[h])]);var d=x.a().scale(r),u=x.b().scale(c);o.select("#x").attr("transform","translate(0,".concat(100,")")).call(d.ticks(5)),o.select("#y").attr("transform","translate(300,0)").call(u.ticks(5)),o.select("#line").transition().duration(a).attr("d",x.j()(l)).attr("stroke","black").attr("fill","none")}},{key:"render",value:function(){return Object(f.jsx)("div",{id:"sweet"})}}]),a}(i.Component),C=(a(550),a(261)),F=function(t){return Object(f.jsx)(C.InlineMath,{math:t})},A=function(t){return Object(f.jsx)(C.BlockMath,{math:t})},N=a(598),L=a(620),T=a(600),P=a(601),D=a(602),B=a(618),E=a(605),M=a(606),R=a(611),z=a(81),I=a.p+"static/media/structMan.c5ceb161.svg",W=a.p+"static/media/structArt.5830dcf2.svg",q=a.p+"static/media/structNN.a9efe2ac.svg",H=a.p+"static/media/structLin.0d34ce16.svg",U=a.p+"static/media/structAck.485489c4.svg",_=function(){var t="primary";return Object(f.jsx)(B.a,{display:"flex",justifyContent:"center",children:Object(f.jsxs)(B.a,{children:[Object(f.jsx)(B.a,{children:Object(f.jsxs)(N.a,{onClick:function(){z.scroller.scrollTo("article",{duration:1500,delay:100,smooth:!0})},color:t,children:[" ",Object(f.jsx)("img",{alt:"article",src:W})]})}),Object(f.jsxs)(B.a,{children:[Object(f.jsxs)(N.a,{onClick:function(){z.scroller.scrollTo("structMan",{duration:1500,delay:100,smooth:!0,offset:-100})},color:t,children:[Object(f.jsx)("img",{alt:"manual",src:I})," "]}),Object(f.jsx)(N.a,{onClick:function(){z.scroller.scrollTo("structLin",{duration:1500,delay:100,smooth:!0,offset:-100})},color:t,children:Object(f.jsx)("img",{alt:"auto",src:H})})]}),Object(f.jsx)(B.a,{children:Object(f.jsx)(N.a,{onClick:function(){z.scroller.scrollTo("mainTool",{duration:1500,delay:100,smooth:!0,offset:-240})},color:t,children:Object(f.jsx)("img",{alt:"backprop",src:q})})}),Object(f.jsx)(B.a,{children:Object(f.jsx)(N.a,{onClick:function(){z.scroller.scrollTo("acknowledgements",{duration:1500,delay:100,smooth:!0})},color:t,children:Object(f.jsx)("img",{alt:"acknowledgements",src:U})})})]})})},X=a(50),G=a(43),J=function(t){Object(u.a)(a,t);var e=Object(j.a)(a);function a(t){var n;return Object(h.a)(this,a),(n=e.call(this,t)).state={width:400,height:400},n}return Object(d.a)(a,[{key:"componentDidMount",value:function(){var t=Object(v.a)(y.a.mark((function t(){var e,a,n,r,s,i,c,o,l,h,d,u,j,p,b,f,m;return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return p=function(t,e){for(var a=i.X,n=i.y,r=0,s=0;s<i.X.length;s++)r+=Math.pow(t*a[s]+e-n[s],2);return r/(2*a.length)},t.next=3,this.state;case 3:return e=t.sent,a=e.width,n=e.height,r=x.r("#divContour").select("#contour"),t.next=9,this.props;case 9:for(s=t.sent,i=s.data,c=s.darkness,o=a,l=n,h=new Array(o*l),d=.5,u=0;d<l;++d)for(j=.5;j<o;++j,++u)h[u]=p(j/o*10-5,d/l*20);return t.next=16,x.n(c,20,1).map((function(t){return Math.pow(2,t)}));case 16:b=t.sent,f=x.q(x.g(b),x.i),m=x.c().size([o,l]).thresholds(b)(h),r.append("g").attr("fill","none").selectAll("path").data(m).join("path").attr("fill",(function(t){return f(t.value)})).attr("d",x.h()),r.append("circle").attr("cx",a/2).attr("cy",0).attr("r",5).style("fill","none").style("stoke","none");case 21:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var t=this.state,e=t.width,a=t.height,n=this.props,r=n.loss,s=n.ms,i=n.m,c=n.b,o=x.r("#divContour").select("#contour");null!=r?r<1e3&&o.select("circle").transition().duration(200-s).attr("cx",e/2+i/10*e).attr("cy",c/20*a).attr("r",2*r+5).style("fill","red").style("opacity","0.5"):o.select("circle").attr("cx",e/2).attr("cy",0).attr("r",5).style("fill","none").style("stroke","none")}},{key:"render",value:function(){var t=this.state,e=t.width,a=t.height;return Object(f.jsx)("div",{id:"divContour",children:Object(f.jsx)("svg",{style:{width:e,height:a},id:"contour"})})}}]),a}(i.Component),V=a(603),Y=a(604),$=a(607),K=a(608),Z=a(34),Q=function(t){Object(u.a)(a,t);var e=Object(j.a)(a);function a(t){var n;return Object(h.a)(this,a),(n=e.call(this,t)).state={yhat:[],darkness:-8,playButton:!0,linreg:{meanSquaredError:0,rsquared:null,data:{X:[],y:[]},hyperparams:{learningRate:.03,epochs:0,loss:null,speed:200},tunableparams:{m:0,b:0}}},n.generateData=n.generateData.bind(Object(G.a)(n)),n.linearRegression=n.linearRegression.bind(Object(G.a)(n)),n.a=n.a.bind(Object(G.a)(n)),n.handleSlider=n.handleSlider.bind(Object(G.a)(n)),n.reset=n.reset.bind(Object(G.a)(n)),n}return Object(d.a)(a,[{key:"reset",value:function(){this.generateData(),this.setState(Object(X.a)(Object(X.a)({},this.state),{},{playButton:!0,linreg:Object(X.a)(Object(X.a)({},this.state.linreg),{},{rsquared:null,hyperparams:Object(X.a)(Object(X.a)({},this.state.linreg.hyperparams),{},{epochs:0,loss:null}),tunableparams:{m:0,b:0}})}))}},{key:"generateData",value:function(){var t=this;Z.r((function(){var e=[0,1,2,3,4,5],a=[5,4,3,2,1,0],n=Z.q(a),r=Z.g(n).dataSync()[0],s=1/(2*e.length)*Z.o(Z.i(Z.n(r,n),2)).dataSync()[0];t.setState(Object(X.a)(Object(X.a)({},t.state),{},{yhat:[0,0,0,0,0,0],linreg:Object(X.a)(Object(X.a)({},t.state.linreg),{},{meanSquaredError:s,data:{X:e,y:a}})}))}))}},{key:"linearRegression",value:function(){var t=this;Z.r((function(){if(t.state.linreg.hyperparams.epochs>1e3)t.setState({playButton:!t.state.playButton});else{var e=t.state.linreg.tunableparams,a=e.m,n=e.b,r=t.state.linreg.hyperparams.learningRate,s=t.state.linreg.data,i=s.X,c=s.y,o=Z.q(i),l=Z.q(c),h=function(t,e,a){return Z.a(Z.h(t,e),a)}(o,a,n),d=o.shape[0],u=1/d*Z.o(Z.h(Z.n(h,l),o)).dataSync()[0],j=1/d*Z.o(Z.n(h,l)).dataSync()[0],p=function(t,e){return 1/(2*d)*Z.o(Z.i(Z.n(e,t),2)).dataSync()[0]}(l,h);a+=-r*u,n+=-r*j;var b=1-p/t.state.linreg.meanSquaredError,x=t.state.linreg.hyperparams.epochs+1,f=Array.from(h.dataSync());t.setState(Object(X.a)(Object(X.a)({},t.state),{},{yhat:f,linreg:Object(X.a)(Object(X.a)({},t.state.linreg),{},{rsquared:b,tunableparams:{m:a,b:n},hyperparams:Object(X.a)(Object(X.a)({},t.state.linreg.hyperparams),{},{epochs:x,loss:p})})}))}}))}},{key:"a",value:function(){var t=Object(v.a)(y.a.mark((function t(){var e,a,n,r;return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=function(t){return new Promise((function(e){return setTimeout(e,t)}))},a=200;case 2:return n=this.state.linreg.hyperparams.speed,r=a-n,t.next=7,this.linearRegression();case 7:return t.next=9,e(r);case 9:if(!0!==this.state.playButton){t.next=11;break}return t.abrupt("break",13);case 11:t.next=2;break;case 13:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"handleSlider",value:function(t,e){this.setState({linreg:Object(X.a)(Object(X.a)({},this.state.linreg),{},{hyperparams:Object(X.a)(Object(X.a)({},this.state.linreg.hyperparams),{},{speed:e})})})}},{key:"componentDidMount",value:function(){var t=Object(v.a)(y.a.mark((function t(){return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.generateData();case 2:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"render",value:function(){var t,e,a,n=this,r=this.state.linreg.tunableparams,s=r.m,i=r.b,c=this.state.linreg.hyperparams,o=c.loss,l=c.speed,h=c.epochs,d=this.state.linreg.data;return Object(f.jsx)("div",{children:Object(f.jsxs)(B.a,{display:"flex",justifyContent:"center",marginTop:2,children:[Object(f.jsx)(B.a,{marginTop:10,marginRight:10,children:Object(f.jsx)(w,{width:400,height:400,padding:0,start:0,stop:5,X:d.X,y:d.y,yhat:this.state.yhat,id:420,select:-1,duration:0})}),Object(f.jsxs)(T.a,{variant:"outlined",children:[Object(f.jsxs)(P.a,{children:[Object(f.jsx)("h2",{children:"Auto Best Fit"}),Object(f.jsxs)(D.a,{variant:"h4",component:"h2",children:["EPOCH: ",h]}),Object(f.jsx)(D.a,{variant:"h6",component:"h2",style:{color:(a=o,null===a?"#dce0dd":"black")},children:" loss = ".concat((t=o,e=10,null===t?t:t.toPrecision(e)))}),Object(f.jsx)(V.a,{onClick:this.reset,children:Object(f.jsx)(Y.a,{})}),Object(f.jsx)(E.a,{style:{background:this.state.playButton?"#175676":"#D62839",color:"white"},onClick:Object(v.a)(y.a.mark((function t(){return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.setState({playButton:!n.state.playButton});case 2:return t.next=4,n.a();case 4:case"end":return t.stop()}}),t)}))),disableTouchRipple:!0,children:this.state.playButton?Object(f.jsx)(M.a,{}):Object(f.jsx)($.a,{})}),Object(f.jsx)(V.a,{style:{color:200===l?"grey":"#FFC006"},onClick:function(){n.setState({linreg:Object(X.a)(Object(X.a)({},n.state.linreg),{},{hyperparams:Object(X.a)(Object(X.a)({},n.state.linreg.hyperparams),{},{speed:200===l?120:200})})})},children:Object(f.jsx)(K.a,{})})]}),Object(f.jsx)(J,{ms:l,data:d,m:isFinite(s)?s:0,b:isFinite(i)?i:0,loss:o,darkness:this.state.darkness})]})]})})}}]),a}(i.Component),tt=a(621),et=function(t){Object(u.a)(a,t);var e=Object(j.a)(a);function a(t){var n;return Object(h.a)(this,a),(n=e.call(this,t)).state={weight:-.82,bias:-.02,loss:0,domain:[],range:[],line:[],show:!1,width:400,biasColor:"#FFA500",weightColor:"#56A8C7",lossColor:"red"},n}return Object(d.a)(a,[{key:"loss",value:function(t,e,a){return Z.r((function(){var n=Z.q(t),r=Z.q(e);return 1/(2*a)*Z.o(Z.i(Z.n(r,n),2)).dataSync()[0]}))}},{key:"computeLine",value:function(t,e,a){for(var n,r=new Array(a.length),s=0;s<a.length;s++)r[s]=(n=a[s],t*n+e);return r}},{key:"zeros",value:function(t){for(var e=new Array(t),a=0;a<t;a++)e[a]=0;return e}},{key:"range",value:function(t,e,a){for(var n=[],r=t;r<=e;r+=a)n.push(r);return n}},{key:"dataGenerator",value:function(){var t=this.range(-1,1,.1),e=this.computeLine(.65,-.3,t),a=this.computeLine(this.state.weight,this.state.bias,t),n=this.loss(e,a,e.length);this.setState({domain:t,range:e,line:a,loss:n})}},{key:"componentDidMount",value:function(){this.dataGenerator()}},{key:"render",value:function(){var t=this,e=this.state,a=e.domain,n=e.range,r=e.bias,s=e.weight,i=e.line,c=e.loss,o=e.show,l=e.width,h=e.weightColor,d=e.biasColor,u=e.lossColor;return Object(f.jsxs)(B.a,{display:"flex",justifyContent:"center",children:[Object(f.jsx)(B.a,{style:{filter:"blur(".concat(o?0:25,"px)")},children:Object(f.jsx)(w,{width:l,height:l,padding:0,start:-1,stop:1,X:a,y:n,yhat:i,id:69,select:-1,duration:0})}),Object(f.jsx)(B.a,{marginLeft:7,children:Object(f.jsx)(T.a,{variant:"outlined",children:Object(f.jsxs)(P.a,{children:[Object(f.jsx)("h2",{children:"Manual Best Fit"}),Object(f.jsxs)("p",{children:["Manually tune"," ",Object(f.jsx)("em",{style:{color:h},children:"weight"})," ","and ",Object(f.jsx)("em",{style:{color:d},children:"bias"})," ","and try to reach a"," ",Object(f.jsx)("em",{style:{color:u},children:"loss"})," of 0"]}),Object(f.jsx)(tt.a,{style:{color:h},value:s,onChange:function(e,i){var c=t.computeLine(s,r,a),o=t.loss(n,c,n.length);t.setState({weight:i,line:c,loss:o})},min:-1,step:.01,max:1,valueLabelDisplay:"auto"}),Object(f.jsx)(tt.a,{style:{color:d},value:r,onChange:function(e,i){var c=t.computeLine(s,r,a),o=t.loss(n,c,n.length);t.setState({bias:i,line:c,loss:o})},min:-1,step:.01,valueLabelDisplay:"auto",max:1}),Object(f.jsxs)("h3",{children:[F("\\text{neuron}(x) = ")," ",Object(f.jsx)("em",{style:{color:h},children:F("".concat(s))}),F("x + ")," ",Object(f.jsx)("em",{style:{color:d},children:F("".concat(r))})]}),Object(f.jsxs)("h3",{children:[Object(f.jsx)("i",{style:{color:u},children:"loss"})," ",F(" = \\frac{1}{J}\\sum_{i = 1}^J (\\hat{y_i} - y_i)^2 ="),Object(f.jsxs)("em",{style:{color:u},children:[" ",F("".concat(c.toFixed(7)))]})]}),Object(f.jsx)(N.a,{size:"small",variant:"contained",style:{backgroundColor:"#155676",color:"white"},onClick:function(){t.setState({show:!t.state.show})},children:"Click to Reveal Graph"})]})})})]})}}]),a}(i.Component),at=a(609),nt=function(t){Object(u.a)(a,t);var e=Object(j.a)(a);function a(t){var n;return Object(h.a)(this,a),(n=e.call(this,t)).state={input:0,output1:0,output2:0,output3:0,weights:[],biases:[]},n.compute=n.compute.bind(Object(G.a)(n)),n.initParams=n.initParams.bind(Object(G.a)(n)),n}return Object(d.a)(a,[{key:"compute",value:function(t){var e=this.state,a=e.weights,n=e.biases,r=function(t,e,a){return e*t+a},s=r(t,a[0],n[0]).toFixed(3),i=r(s,a[1],n[1]).toFixed(3),c=r(i,a[2],n[2]).toFixed(3);this.setState({input:t,output1:s,output2:i,output3:c})}},{key:"genRandomArray",value:function(t){for(var e=new Array(t),a=0;a<e.length;a++)e[a]=+Math.random().toFixed(2);return e}},{key:"initParams",value:function(){var t=Object(v.a)(y.a.mark((function t(){var e,a;return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=this.genRandomArray(3),a=this.genRandomArray(3),this.setState({weights:e,biases:a});case 3:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){var t=Object(v.a)(y.a.mark((function t(){return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.initParams();case 2:this.compute(34);case 3:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"render",value:function(){var t=this,e=this.state,a=e.input,n=e.output1,r=e.output2,s=e.output3,i=e.weights,c=e.biases,o=a.toFixed(3),l=[{output:n,color:"#8db600"},{output:r,color:"#FF8F00"},{output:s,color:"#56A8C7"}];return Object(f.jsx)(B.a,{display:"flex",children:Object(f.jsx)(B.a,{width:580,children:Object(f.jsxs)(T.a,{variant:"outlined",children:[Object(f.jsxs)(P.a,{children:[Object(f.jsx)(tt.a,{value:this.state.input,onChange:function(e,a){t.compute(a)},color:"secondary"}),Object(f.jsx)(B.a,{display:"flex",justifyContent:"center",children:Object(f.jsx)(B.a,{justifyContent:"center",children:Object(f.jsxs)("svg",{width:500,height:64,children:[Object(f.jsx)("path",{d:"M".concat(36," 16, ",100," 16"),stroke:"#f50557",strokeDasharray:"25, 4",strokeWidth:3*i[0]+.2}),Object(f.jsx)("text",{x:40,y:40,fill:"#f50557",children:o}),l.map((function(t,e){return Object(f.jsxs)("g",{children:[Object(f.jsx)("rect",{x:100+100*e,y:0,width:32,height:32,fill:"lightgrey"}),Object(f.jsx)("text",{x:111+100*e,y:22,children:e+1}),Object(f.jsx)("path",{d:"M".concat(132+100*e," 16, ").concat(200+100*e," 16"),stroke:t.color,strokeDasharray:"25, 4",strokeWidth:e<2?3*i[e+1]+.2:1}),Object(f.jsx)("text",{x:140+100*e,y:40,fill:t.color,children:t.output})]},e)}))]})})}),Object(f.jsxs)(D.a,{variant:"h5",children:["neuron1(",Object(f.jsx)(D.a,{color:"secondary",variant:"inherit",children:o}),") = ",i[0],"(",Object(f.jsx)(D.a,{color:"secondary",variant:"inherit",children:o}),") + ",c[0]," ="," ",Object(f.jsx)(D.a,{style:{color:"#8db600"},variant:"inherit",children:this.state.output1})]}),Object(f.jsxs)(D.a,{variant:"h5",children:["neuron2(",Object(f.jsx)(D.a,{style:{color:"#8db600"},variant:"inherit",children:this.state.output1}),") = ",i[1],"(",Object(f.jsx)(D.a,{style:{color:"#8db600"},variant:"inherit",children:this.state.output1}),") + ",c[1]," ="," ",Object(f.jsx)(D.a,{style:{color:"#FF8F00"},variant:"inherit",children:this.state.output2})]}),Object(f.jsxs)(D.a,{variant:"h5",children:["neuron3(",Object(f.jsx)(D.a,{style:{color:"#FF8F00"},variant:"inherit",children:this.state.output2}),") = ",i[2],"(",Object(f.jsx)(D.a,{style:{color:"#FF8F00"},variant:"inherit",children:this.state.output2}),") + ",c[2]," ="," ",Object(f.jsx)(D.a,{style:{color:"#56A8C7"},variant:"inherit",children:this.state.output3})]})]}),Object(f.jsx)(at.a,{children:Object(f.jsx)(N.a,{size:"small",onClick:Object(v.a)(y.a.mark((function e(){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.initParams();case 2:case"end":return e.stop()}}),e)}))),children:"new Weights and biases"})})]})})})}}]),a}(i.Component),rt=a.p+"static/media/forward.94373b2e.svg",st=a.p+"static/media/summary.c45974a2.svg",it=a.p+"static/media/backward.0c67cde4.svg",ct=function(){var t,e,a="#FFA500",n="#56A8C7",r=function(t,e){return Object(f.jsx)(L.a,{style:{backgroundColor:"#56A8C7",color:"black"},title:Object(f.jsx)(T.a,{children:Object(f.jsx)(P.a,{children:e})}),placement:"top",arrow:!0,children:t})},s=function(t){return Object(f.jsx)(D.a,{variant:"h3",children:Object(f.jsx)("b",{children:t})})},i=function(t){return Object(f.jsx)(D.a,{variant:"h4",children:t})},c=Object(f.jsxs)("div",{children:[Object(f.jsx)("br",{}),s("Jump to a check point"),Object(f.jsxs)(D.a,{variant:"h6",children:["If you want to skip ahead, click on a checkpoint. Otherwise, click ",Object(f.jsx)("b",{children:"Article"})," or scroll to the start of the article."]}),Object(f.jsx)(_,{}),Object(f.jsx)(z.Element,{name:"article",children:s("Introduction")}),Object(f.jsxs)(D.a,{variant:"h6",children:["Most people abstract the idea of backpropagation when learning neural networks because it is by far the most notation heavy part. The goal of this article is to build an intuition for backpropagation in the context of how neural networks"," ",Object(f.jsx)("em",{children:"learn"}),". By marrying explanation, notation, and interactive tools, the aim is to get a understanding of the foundations. Note that throughout the article there will be"," ",r(Object(f.jsx)("span",{children:"highlighted"}),Object(f.jsx)(D.a,{varaint:"h6",children:"Example explanation"}))," ","words that will give extra explanation on mouse over."]}),Object(f.jsx)("br",{}),s("Backpropagation on One Neuron"),i("Getting Started"),Object(f.jsxs)(D.a,{variant:"h6",children:["The goal in a neural network, or any optimization problem for that matter, is to lower and minimize whatever"," ",r(Object(f.jsx)("span",{children:"loss"}),Object(f.jsxs)(D.a,{variant:"body1",children:["Error between predicted values ",F("\\hat{y}")," and true values ",F("y")]}))," ","function we define. For this article, we will be performing regression and using mean squared error loss"," ",r(Object(f.jsx)("span",{children:"MSE"}),Object(f.jsxs)(B.a,{children:[Object(f.jsx)(D.a,{variant:"h6",children:A("\\text{MSE} = \\frac{1}{J}\\sum_{i = 1}^{J}(\\hat{y_i} - y_i)^2")}),Object(f.jsxs)(D.a,{variant:"body1",children:[Object(f.jsx)("b",{children:"Input Variables"}),Object(f.jsx)("br",{}),"length of data ",F("J"),Object(f.jsx)("br",{}),"index ",F("i"),Object(f.jsx)("br",{}),"predicted values ",F("\\hat{y}"),Object(f.jsx)("br",{}),"true values ",F("y")]})]})),"."]}),Object(f.jsxs)(D.a,{variant:"h6",children:["Before hitting the calculus, tune the"," ",r(Object(f.jsx)("span",{children:"weight and bias on one neuron"}),Object(f.jsxs)(B.a,{children:[Object(f.jsx)(D.a,{variant:"h6",children:A("\\text{neuron}(x) = w_0x + b ")}),Object(f.jsxs)(D.a,{variant:"body1",children:[Object(f.jsx)("b",{children:"Neuron as a Function"}),Object(f.jsx)("br",{}),"input ",F("x"),Object(f.jsx)("br",{}),"output ",F("\\text{neuron}(x)"),Object(f.jsx)("br",{}),Object(f.jsx)("b",{children:"Tunable Parameters"}),Object(f.jsx)("br",{}),"weight ",F("w_0"),Object(f.jsx)("br",{}),"bias ",F("b")]})]}))," ","by sliding the sliders under ",Object(f.jsx)("b",{children:"Manual Best Fit"}),". By observing changes in the ",Object(f.jsx)("em",{style:{color:"red"},children:"loss"}),", try to make it reach 0. When you feel like you've lowered the"," ",Object(f.jsx)("em",{style:{color:"red"},children:"loss"})," enough (or need some help), press the"," ",Object(f.jsx)(N.a,{disabled:!0,size:"small",variant:"contained",style:{backgroundColor:"#155676",color:"white"},children:"Click to reveal the graph"})," ","button below."]}),Object(f.jsx)("br",{}),Object(f.jsx)(z.Element,{name:"structMan",children:Object(f.jsx)(et,{})}),Object(f.jsx)("br",{}),i("Reflection"),Object(f.jsx)(D.a,{variant:"h6",children:Object(f.jsx)("b",{children:"The intuiton and logic from the exercise above, is the foundation for what backpropagation and optimization is and aims to achieve."})}),Object(f.jsxs)(D.a,{variant:"h6",children:["\u2003\u2003\u2003\u2003When you start to change the weight, you observe where the loss moves, if it moves up, you move the weight the other direction to lower the loss. This, without the math, is the main principle behind guaging the rate of change and optimizing a nerual network."," ",Object(f.jsx)("b",{children:"Let's apply this method of thinking!"})]}),Object(f.jsx)("br",{}),i("Defining Backpropagation"),Object(f.jsxs)(D.a,{variant:"h6",children:["First to get the"," ",r(Object(f.jsx)("span",{children:"instantaneous rate of change"}),Object(f.jsxs)(B.a,{children:[Object(f.jsx)(D.a,{style:{color:n},variant:"h6",children:A("\\lim_{h \\to 0} \\frac{f(x + h) - f(x)}{h}")}),Object(f.jsx)(D.a,{variant:"h6",style:{color:a},children:A("\\frac{df}{dx}")}),Object(f.jsxs)(D.a,{style:{color:n},variant:"body1",children:["Limit definition of derivative of ",F("f(x)")," with respect to ",F("x")]}),Object(f.jsxs)(D.a,{style:{color:a},variant:"body1",children:["Notation for derivative of ",F("f(x)")," with respect to ",F("x")]})]})),"(derivative), we get our point of interest and another point that is infinitely close and calculate slope, this can be visualized as a tangent line at the point of interest for a function with one variable like ",F("f(x)"),"."]}),Object(f.jsxs)(D.a,{variant:"h6",children:["\u2003\u2003\u2003\u2003In the context of our one neuron neural network, we can compose the whole network as a nested function",A("\\text{loss}(\\text{neuron}(x,w,b),y)")]}),Object(f.jsxs)(D.a,{variant:"h6",children:["Since want to tune the parameters weight ",F("w")," and bias"," ",F("b"),", we want to know how each parameters will affect the loss, or in other words, the"," ",r(Object(f.jsx)("span",{children:"partial derivative"}),Object(f.jsxs)(B.a,{children:[Object(f.jsx)(D.a,{style:{color:n},variant:"h6",children:A("\\lim_{h \\to 0} \\frac{f(x + h, y) - f(x,y)}{h}")}),Object(f.jsx)(D.a,{variant:"h6",style:{color:a},children:A("\\frac{\\partial f}{\\partial x}")}),Object(f.jsxs)(D.a,{style:{color:n},variant:"body1",children:["Limit definition of partial derivative of"," ",F("f(x,y)")," with respect to ",F("x")]}),Object(f.jsxs)(D.a,{style:{color:a},variant:"body1",children:["Notation for partial derivative of ",F("f(x,y)")," ","with respect to ",F("x")]}),Object(f.jsx)(D.a,{style:{color:n},variant:"h6",children:A("\\lim_{h \\to 0} \\frac{f(x, y + h) - f(x,y)}{h}")}),Object(f.jsx)(D.a,{variant:"h6",style:{color:a},children:A("\\frac{\\partial f}{\\partial y}")}),Object(f.jsxs)(D.a,{style:{color:n},variant:"body1",children:["Limit definition of partial Derivative of"," ",F("f(x,y)")," with respect to ",F("y")]}),Object(f.jsxs)(D.a,{style:{color:a},variant:"body1",children:["Notation for partial derivative of ",F("f(x,y)")," ","with respect to ",F("y")]})]})),". of loss with respect to each parameter, also called the"," ",r(Object(f.jsx)("span",{children:"gradient"}),Object(f.jsx)(B.a,{children:Object(f.jsx)(D.a,{variant:"h6",children:A("\\nabla f(x,y) = \\begin{bmatrix} \\frac{\\partial f}{\\partial x} \\\\[4pt] \\frac{\\partial f}{\\partial y} \\\\ \\end{bmatrix}")})})),". After we compute the gradient from getting all the derivatives backwards, we will have the direction of steepest"," ",Object(f.jsx)("em",{children:"ascent"})," on the loss function. But we want to lower loss, therefore we use the opposite direction to get the direction of steepest descent, to perform"," ",r(Object(f.jsx)("span",{children:"gradient descent"}),Object(f.jsxs)(B.a,{children:[Object(f.jsx)(D.a,{variant:"body1",children:F("\\text{param} := \\text{param} -lr \\cdot \\frac{\\partial \\text{loss}}{\\partial \\text{param}}")}),Object(f.jsx)("br",{}),Object(f.jsxs)(D.a,{variant:"body2",children:["Since the gradient of the loss will be the direction of steepest ",Object(f.jsx)("em",{children:"ascent"}),", by going the opposite direction, we go in the direction of steepest"," ",Object(f.jsx)("em",{children:"descent"}),". Learning rate lr then decides how large of a step in the direction of steepest descent would like."]})]})),"."]}),Object(f.jsx)(D.a,{variant:"h4",children:A("\\nabla \\text{loss} = \\begin{bmatrix} \\frac{ \\partial \\text{loss}}{\\partial w} \\\\[4pt] \\frac{ \\partial \\text{loss}}{\\partial b} \\\\ \\end{bmatrix}")}),Object(f.jsx)(D.a,{variant:"h6",children:"In order to calculate these derivatives we must use the chain rule due to the nested nature of neural networks."}),Object(f.jsx)(D.a,{variant:"h6",children:Object(f.jsx)("b",{children:"Below is a color coded example of the chain rule."})}),Object(f.jsxs)(D.a,{variant:"h6",children:["Start by sliding the slider and notice how the output is the input to the next function and so forth."," ",Object(f.jsx)("b",{children:"Then read the explanation below"}),"."]}),Object(f.jsx)(B.a,{display:"flex",justifyContent:"center",children:Object(f.jsx)(B.a,{children:Object(f.jsx)(nt,{})})}),Object(f.jsx)("br",{}),Object(f.jsxs)(D.a,{variant:"h6",children:["Suppose we wanted to see how the"," ",Object(f.jsx)("em",{style:{color:"#F50257"},children:"pink"})," affects the"," ",Object(f.jsx)("em",{style:{color:n},children:"blue"}),". We should start at"," ",Object(f.jsx)("em",{style:{color:n},children:"blue"}),", then",Object(f.jsxs)("ol",{children:[Object(f.jsxs)("li",{children:["observe how ",Object(f.jsx)("em",{style:{color:a},children:"orange"})," ","affects ",Object(f.jsx)("em",{style:{color:n},children:"blue"})," "]}),Object(f.jsxs)("li",{children:["observe how ",Object(f.jsx)("em",{style:{color:"#8db600"},children:"green"})," ","affects ",Object(f.jsx)("em",{style:{color:a},children:"orange"})]}),Object(f.jsxs)("li",{children:["observe how ",Object(f.jsx)("em",{style:{color:"#F50257"},children:"pink"})," ","affects ",Object(f.jsx)("em",{style:{color:"#8db600"},children:"green"})]})]}),"By chaining those values together, we get how the"," ",Object(f.jsx)("em",{style:{color:"#F50257"},children:"pink"})," affects the"," ",Object(f.jsx)("em",{style:{color:n},children:"blue"}),"."]}),Object(f.jsx)("br",{}),Object(f.jsx)(D.a,{variant:"h6",children:"This logic applied to our one neuron neural network looks like"}),Object(f.jsxs)(D.a,{variant:"h6",children:[A("\\frac{ \\partial \\text{loss}}{\\partial w} = \\frac{ \\partial \\text{loss}}{\\partial \\text{neuron}} \\frac{ \\partial \\text{neuron}}{\\partial w} "),A("\\frac{ \\partial \\text{loss}}{\\partial b} = \\frac{ \\partial \\text{loss}}{\\partial \\text{neuron}} \\frac{ \\partial \\text{neuron}}{\\partial b} ")]}),Object(f.jsxs)(D.a,{variant:"h6",children:["These chains can be broken up into more intermediate derivatives all the way down to their primatives (basis of",(t="https://en.wikipedia.org/wiki/Automatic_differentiation",e="automatic differentiation",Object(f.jsx)(N.a,{size:"small",style:{color:a},href:t,target:"_blank",rel:"noopener noreferrer",children:e})),"). ",Object(f.jsx)("b",{children:"The main takeaway"})," is that we first observe how the neuron output affected the loss output"," ",F(" \\frac{ \\partial \\text{loss}}{\\partial \\text{neuron}}"),", but then we need to explain how the neuron output was affected by the parameter"," ",F(" \\frac{ \\partial \\text{neuron}}{\\partial \\text{parameter}}")," ","and can combine these to observe how the paramter affected the loss"," ",F(" \\frac{ \\partial \\text{loss}}{\\partial \\text{parameter}}"),". And notice how we compute these derivatives going backward, which has the added benefit of reusing values computed in the forward propagation."]}),Object(f.jsx)("br",{}),i("Concrete Example"),Object(f.jsxs)(D.a,{variant:"h6",children:["Let's go through a concrete example of a forward and backward pass. We will define the input as ",F("x_0 = 2.1"),", the weight as ",F("w_0 = 1"),", and the bias as ",F("b = 0"),". This is just one training example."]}),Object(f.jsx)("img",{alt:"forward pass",width:"100%",src:rt}),Object(f.jsxs)(D.a,{variant:"h6",children:["Now we can go backwards and compute partial derivatives with the chain rule to get the gradient ",F("\\nabla \\text{loss}")]}),Object(f.jsx)("img",{alt:"backward pass",width:"100%",src:it}),Object(f.jsxs)(D.a,{variant:"h6",children:[A("\\frac{\\partial \\text{loss}}{\\partial w_0} = -7.98"),A("\\frac{\\partial \\text{loss}}{\\partial b} = -3.8")]}),Object(f.jsxs)(D.a,{variant:"h6",children:["Then, we update the parameters to opposite gradient to descend loss ( ), in this case learning rate is ",F("\\text{lr} = 0.01"),A("w_0 := w_0 - \\text{lr} \\cdot \\frac{\\partial \\text{loss}}{\\partial w_0} = (1) - (0.01) \\cdot (-7.98) = 1.0798"),A("b := b - \\text{lr} \\cdot \\frac{\\partial \\text{loss}}{\\partial b} = (0) - (0.01) \\cdot (-3.8) = 0.038 "),"Re calculate forward pass with new weight and bias",A("\\text{loss} = ((1.0798)(2.1) + 0.038) - 4)^2 = 2.87")]}),Object(f.jsxs)(D.a,{variant:"h6",children:["Total loss savings of ",F("3.61 - 2.87 = 0.74")]}),Object(f.jsx)("br",{}),i("See it in Action"),Object(f.jsxs)(D.a,{variant:"h6",children:["To see the what we just did (forward, backward, update) on more data and on the entire batch as opposed to a single training example, press"," ",Object(f.jsx)(E.a,{style:{background:"#175676",color:"white"},size:"small",children:Object(f.jsx)(M.a,{})})," ","to start the training process under ",Object(f.jsx)("b",{children:"Auto Best Fit"}),". Watch how as the line gets better fit, the red dot descends the loss contour."]}),Object(f.jsx)(z.Element,{name:"structLin",children:Object(f.jsx)(Q,{})}),Object(f.jsx)("br",{}),s("Scaling up Neurons and Layers"),i("The Changes"),Object(f.jsxs)(D.a,{variant:"h6",children:["To fit more interesting data that is non-linear (e.g. sine wave or quadratic), we need to add complexity to vary output to make sure we are not contrained to only linear outputs. We can do this by adding more neurons, more layers, and activation functions. If you think of our entire neural network as a function, then by adding more neurons and more layers we are creating a more nested function. Not only does this create more parameters that we can tune to vary the output, it also maintains the property of"," ",r(Object(f.jsx)("span",{children:"differentiability"}),Object(f.jsx)(B.a,{children:Object(f.jsx)(D.a,{variant:"h6",children:"The derivative exists for all inputs"})})),": important so we can compute the gradient. And by adding non-linear activation functions with points of deactivation, certain neurons may have no effect on the output while others may become more activated, contributing to outputs that don't have to follow linear constraints. We will be using the"," ",r(Object(f.jsx)("span",{children:"ReLU"}),Object(f.jsxs)(B.a,{children:[Object(f.jsxs)(D.a,{variant:"h6",children:[Object(f.jsx)("b",{children:"Re"}),"ctified ",Object(f.jsx)("b",{children:"L"}),"inear ",Object(f.jsx)("b",{children:"U"}),"nit"]}),Object(f.jsx)(D.a,{variant:"h6",children:F(" \\text{ReLU}(x) = \\left\\{ \\begin{array}{ll} 0 & x\\leq 0  \\\\ x & x > 0 \\\\ \\end{array} \\right. ")})]}))," ","activation function in the hidden layers."]}),Object(f.jsx)(B.a,{display:"flex",justifyContent:"center",children:Object(f.jsx)(B.a,{children:Object(f.jsx)("img",{alt:"summary",src:st,width:"100%"})})}),Object(f.jsxs)(D.a,{variant:"h6",children:[Object(f.jsx)("b",{children:"Above"})," is an example of a neural network with one input, three hidden layers with eight neurons each, and one output neuron. The output of each neuron is fed into the neurons of the next layer and so forth (like a nested function). Each link represents a weight and a corresponding input into the respective neuron, notice how the more neurons we add, the more links there are and the more parameters we can tune to get our desired output."]}),Object(f.jsx)("br",{}),i("Training Process"),Object(f.jsx)(D.a,{variant:"h6",children:Object(f.jsxs)("ol",{children:[Object(f.jsx)("li",{children:"Forward propagation resulting in an output and loss"}),Object(f.jsx)("li",{children:"Backward propagation using the chain rule to compute the gradient"}),Object(f.jsx)("li",{children:"Descend the loss by performing gradient descent"})]})}),Object(f.jsxs)(D.a,{variant:"h6",children:[Object(f.jsx)("b",{children:"The process doesn't change from the single neuron example!"})," ","Since the network is deeper, we have to calculate more derivatives going backwards and have to tune more parameters with gradient descent, but the logic stays the same."]}),Object(f.jsxs)(D.a,{variant:"h6",children:["\u2003\u2003\u2003\u2003A great way to visualize backpropagation in a large network is with vertical arrows representing which direction we need to nudge the neuron output in order to lower loss:"," ",F("-\\frac{\\partial \\text{loss}}{\\partial \\text{activation} }")]}),Object(f.jsx)("br",{}),Object(f.jsxs)(D.a,{variant:"h4",children:[Object(f.jsx)("b",{children:"Backprop Tool"})," Quick Start"]}),Object(f.jsx)(D.a,{variant:"h6",children:Object(f.jsxs)("ol",{children:[Object(f.jsxs)("li",{children:["Press"," ",Object(f.jsx)(E.a,{style:{background:"#175676",color:"white"},size:"small",children:Object(f.jsx)(M.a,{fontSize:"small"})})," ","to start training"]}),Object(f.jsxs)("li",{children:["Then press"," ",Object(f.jsx)(N.a,{variant:"contained",size:"small",children:"EPOCH"})," ","to see backpropagation animation"]}),Object(f.jsxs)("li",{children:["To go back to fitting mode click"," ",Object(f.jsx)(N.a,{variant:"contained",size:"small",children:"EPOCH"})," ","again"]})]})}),Object(f.jsxs)(D.a,{variant:"h6",children:[Object(f.jsx)("b",{children:" Click on "}),Object(f.jsx)(R.a,{variant:"small",style:{color:"#FFA500"}})," ",Object(f.jsx)("b",{children:"to reveal extra descriptions"})]}),Object(f.jsx)("br",{})]});return Object(f.jsx)(B.a,{justifyContent:"center",display:"flex",children:Object(f.jsx)(B.a,{maxWidth:"60%",children:c})})},ot=a(20),lt=a(262),ht=a.n(lt),dt=a(622),ut=a(619),jt=a(613),pt=a(615),bt=a(612),xt=a(614),ft=a.p+"static/media/controlcenter.eedf70bb.gif",mt=a.p+"static/media/singleSummary.8525cefd.svg",Ot=a.p+"static/media/epochMode.c8cab6a6.png",gt=a.p+"static/media/key.84fb58e0.svg",yt=function(){function t(e,a){Object(h.a)(this,t),this.weights=e,this.bias=a}return Object(d.a)(t,[{key:"mult",value:function(t,e){return t.map((function(t,a){return t*e[a]}))}},{key:"dMult",value:function(t,e){return this.mult(t,e)}},{key:"sum",value:function(t){return t.reduce((function(t,e){return t+e}))}},{key:"dSum",value:function(t,e){for(var a=[],n=0;n<e;n++)a.push(t);return a}},{key:"linear",value:function(t){return t}},{key:"forward",value:function(t,e){var a=this.weights,n=this.bias,r=this.mult,s=this.sum,i=r(t,a),c=s(i)+n,o=e(c);this.inputs=t,this.multStep=i,this.sumStep=c,this.actStep=o,this.output=o}},{key:"backward",value:function(t,e){var a=this.inputs,n=this.weights,r=this.actStep,s=this.dSum,i=this.mult,c=this.sum,o=e(r)*t,l=s(o,a.length),h=o,d=i(l,a),u=i(l,n),j=c(u);this.dvalue=t,this.dActStep=o,this.dSumStep=l,this.dBias=h,this.dWeights=d,this.dInputs=u,this.dInputsSum=j}}]),t}(),vt=function(){function t(){Object(h.a)(this,t)}return Object(d.a)(t,[{key:"forward",value:function(t,e){var a=t-e,n=this.output=Math.pow(t-e,2);this.subStep=a,this.squareStep=n,this.output=n}},{key:"backward",value:function(){this.dInputs=2*this.subStep}}]),t}(),wt=function(){function t(e,a,n){Object(h.a)(this,t),this.model=[],this.loss=new vt,this.shape=e;for(var r=0;r<a.length;r++){for(var s=[],i=0;i<a[r].length;i++)s.push(new yt(a[r][i],n[r][i]));this.model.push(s)}}return Object(d.a)(t,[{key:"sum",value:function(t){return t.reduce((function(t,e){return t+e}))}},{key:"add",value:function(t,e){var a=t.length,n=e.length;if(n!==a)return console.error("".concat(a," does not match ").concat(n,", so returned empty array")),[];for(var r=new Array(a),s=0;s<t.length;s++)r[s]=t[s]+e[s];return r}},{key:"zeros",value:function(t){for(var e=new Array(t),a=0;a<t;a++)e[a]=0;return e}},{key:"dReLU",value:function(t){return t>0?1:0}},{key:"dLinear",value:function(t){return 1}},{key:"ReLU",value:function(t){return Math.max(0,t)}},{key:"linear",value:function(t){return t}},{key:"forward",value:function(t,e){for(var a=[t],n=this.model.length,r=0;r<n-1;r++){for(var s=[],i=0;i<this.model[r].length;i++)this.model[r][i].forward(a,this.ReLU),s.push(this.model[r][i].output);a=s}this.model[n-1][0].forward(a,this.linear),this.yhat=this.model[n-1][0].output,this.loss.forward(this.yhat,e)}},{key:"backward",value:function(){var t=this.add,e=this.zeros;this.loss.backward();var a=[this.loss.dInputs],n=this.model.length;this.model[n-1][0].backward(a[0],this.dLinear),a=this.model[n-1][0].dInputs;for(var r=n-2;r>=0;r--){for(var s=e(this.model[r][0].inputs.length),i=0;i<this.model[r].length;i++)this.model[r][i].backward(a[i],this.dReLU),s=t(s,this.model[r][i].dInputs);a=s}}},{key:"update",value:function(t){for(var e=function(t,e,a){return t-e*a},a=0;a<this.model.length;a++)for(var n=0;n<this.model[a].length;n++)for(var r=0;r<this.model[a][n].dWeights.length;r++){var s=e(this.model[a][n].weights[r],t,this.model[a][n].dWeights[r]),i=e(this.model[a][n].bias,t,this.model[a][n].dBias);this.model[a][n].weights[r]=s,this.model[a][n].bias=i}}},{key:"throttleForward",value:function(t,e,a,n){var r=this.model[e][t].output+a;this.model[e][t].output=r;for(var s=[],i=0;i<this.model[e].length;i++)s.push(this.model[e][i].output);for(var c=this.model.length,o=e+1;o<c-1;o++){for(var l=[],h=0;h<this.model[o].length;h++)this.model[o][h].forward(s,this.ReLU),l.push(this.model[o][h].output);s=l}this.model[c-1][0].forward(s,this.linear),this.yhat=this.model[c-1][0].output,this.loss.forward(this.yhat,n)}}]),t}();function kt(t,e){for(var a=[],n=0;n<t.length;n++){for(var r=e[n+1],s=[],i=0;i<r;i++){for(var c=[],o=i;o<t[n].length;o+=r)c.push(t[n][o]);s.push(c)}a.push(s)}return a}function St(t,e){for(var a=0;a<t.length;a++)for(var n=0;n<t[a].length;n++)t[a][n]=+t[a][n].toFixed(e);return t}function Ct(t){for(var e=[],a=0;a<t.length;a++)for(var n=0;n<t[a].length;n++)e.push(t[a][n]);return e}function Ft(t){return Math.floor(Math.random()*Math.floor(t))}function At(t){return Array.from(t.dataSync())}function Nt(t,e){return{xScale:x.p().domain(t.domain).range(t.range),yScale:x.p().domain(e.domain).range(e.range)}}function Lt(t){return x.k().x((function(e){return e.x+t})).y((function(e){return e.y+t}))}function Tt(t,e,a,n,r,s,i){var c=[],o=[];c.push([n]),o.push(n);for(var l=1;l<t.length-1;l++){for(var h=[],d=0;d<t[l];d++){var u={x:s(e[l])-a/2,y:i(92-12*d)-a/2};h.push(u),o.push(u)}c.push(h)}return o.push(r),c.push([r]),{flattenedNeurons:o,shapedNeurons:c}}function Pt(t,e,a){for(var n=[],r=[],s=[],i=1;i<t.length;i++){s=[];for(var c=0;c<t[i];c++){n=[];for(var o=0;o<t[i-1];o++)n.push(a({source:e[i-1][o],target:e[i][c]}));s.push(n)}r.push(s)}return r}var Dt=function(t){Object(u.a)(a,t);var e=Object(j.a)(a);function a(t){var n;return Object(h.a)(this,a),(n=e.call(this,t)).state={tensorFlowNN:null,miniNN:null,X:[],y:[],yhat:[],shape:[1,8,8,8,1],lr:.001,epoch:0,cpyEpoch:0,biasesData:[],weightsData:[],lossArray:[],loss:null,scale:5,rects:[],weights:[],shapedWeights:[],shapedRects:[],shapedLinks:[],direction:"edgePaused",curve:"sin",controls:{playing:!1,speed:100},sliderVal:2,mode:!1,stopRender:!1,keyFrameLayer:0,keyFrameLoss:0,keyFrameScatter:0,subEpoch:"",isAnimating:!1,lossSavings:0,lossDifference:0,singleInputExample:0,singleLabelExample:0,newOutput:0,controlCenterHelp:!1,customizationHelp:!1,neuralNetworkHelp:!1,scatterHelp:!1,lossHelp:!1,lossChange:0,potentialYhat:[],singleInputIndex:-1,shouldNotRender:!1,status:"reset",zoom:1},n.initNeuralNetwork=n.initNeuralNetwork.bind(Object(G.a)(n)),n.run=n.run.bind(Object(G.a)(n)),n.genTensorData=n.genTensorData.bind(Object(G.a)(n)),n.mutate=n.mutate.bind(Object(G.a)(n)),n.train=n.train.bind(Object(G.a)(n)),n.printParameters=n.printParameters.bind(Object(G.a)(n)),n.reset=n.reset.bind(Object(G.a)(n)),n.resetParameters=n.resetParameters.bind(Object(G.a)(n)),n.asyncPause=n.asyncPause.bind(Object(G.a)(n)),n.changeModelLr=n.changeModelLr.bind(Object(G.a)(n)),n.anim=n.anim.bind(Object(G.a)(n)),n.randomInputGeneration=n.randomInputGeneration.bind(Object(G.a)(n)),n}return Object(d.a)(a,[{key:"randomInputGeneration",value:function(t,e,a,n,s,i,c){var o=r.getRandomInt(50),l=t[o],h=e[o],d=r.formatWeightArray(a,s),u=new wt(s,d,n),j=new wt(s,d,n);u.forward(l,h),u.backward(),j.forward(l,h),j.backward(),j.update(i),j.forward(l,h);var p=j.yhat,b=j.loss.output,x=b,f=u.loss.output-b,m=function(t){for(var e=t.length,a=new Array(e),n=0;n<e;n++)j.forward(t[n],0),a[n]=j.yhat;return a}(t);this.setState(Object(X.a)(Object(X.a)({},this.state),{},{miniNN:u,potentialYhat:m,mode:!0,lossSavings:x,lossDifference:f,singleInputIndex:o,singleInputExample:l,singleLabelExample:h,newOutput:p,controls:Object(X.a)(Object(X.a)({},this.state.controls),{},{playing:!1})}))}},{key:"anim",value:function(){var t=Object(v.a)(y.a.mark((function t(){var e,a,n,r,s;return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=this.state.shape,a=750,n=function(t){return new Promise((function(e){return setTimeout(e,t)}))},this.setState({subEpoch:"forward",status:"reset",isAnimating:!0,lossChange:0,cpyEpoch:this.state.epoch,keyFrameScatter:0}),r=0;case 5:if(!(r<e.length)){t.next=14;break}if(this.setState({keyFrameLayer:r}),r!==e.length-1){t.next=9;break}return t.abrupt("continue",11);case 9:return t.next=11,n(a);case 11:r++,t.next=5;break;case 14:return this.setState({keyFrameLoss:1,keyFrameScatter:1,status:"real",shouldNotRender:!0}),t.next=17,n(a);case 17:return this.setState({keyFrameLoss:2,shouldNotRender:!0}),t.next=20,n(a);case 20:this.setState({keyFrameLoss:3}),this.setState({lossChange:this.state.miniNN.loss.output}),this.setState({subEpoch:"backward",keyFrameScatter:2}),s=e.length-1;case 24:if(!(s>=0)){t.next=31;break}return this.setState({keyFrameLayer:s}),t.next=28,n(a);case 28:s--,t.next=24;break;case 31:return this.setState({keyFrameLayer:-1}),t.next=34,n(a);case 34:return this.setState({subEpoch:"transition"}),t.next=37,n(1e3);case 37:return this.setState({subEpoch:"update",shouldNotRender:!1}),t.next=40,n(1e3);case 40:this.setState({isAnimating:!1,lossChange:this.state.lossSavings,keyFrameScatter:4,cpyEpoch:this.state.cpyEpoch+1,status:"pred"});case 41:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"initNeuralNetwork",value:function(t){var e=this.state.controls.playing;if(e){if(e){var a=this.state,n=a.weightsData,i=a.shape,c=r.flatten(n),o=r.formatWeightArray(n,i);this.setState({weights:c,shapedWeights:o})}}else{var l=32,h=s.generateLinearScale({domain:[0,100],range:[50,750]},{domain:[0,100],range:[500,0]}),d=h.xScale,u=h.yScale,j={x:55,y:234},p={x:734,y:234},b=s.generateLink(16),x=s.generateNeuronPlacement(t,[0,25,50,75,0],l,j,p,d,u),f=x.flattenedNeurons,m=x.shapedNeurons,O=s.generateLinksPlacement(t,m,b);m.splice(0,1),this.setState({shapedLinks:O,rects:f,shapedRects:m})}}},{key:"changeModelLr",value:function(t){var e=this;Z.r((function(){e.setState({lr:t})}))}},{key:"run",value:function(){var t=Object(v.a)(y.a.mark((function t(){var e;return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=!this.state.controls.playing,this.mutate("controls","playing",e),!0!==e){t.next=5;break}return t.next=5,this.train(this.state.X,this.state.y);case 5:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"mutate",value:function(t,e,a){var n=this;Z.r((function(){var r=Object(X.a)({},n.state);t in r&&e in r[t]?(r[t][e]=a,n.setState({state:r})):console.error("Could not be found in state")}))}},{key:"addModel",value:function(t){var e=this;return Z.r((function(){var a=e.state.shape;t.add(Z.d.dense({inputShape:[1],units:a[1],activation:"relu",useBias:!0}));for(var n=2;n<a.length-1;n++)t.add(Z.d.dense({units:a[n],activation:"relu",useBias:!0}));return t.add(Z.d.dense({units:1,activation:"linear",useBias:!0})),t}))}},{key:"modelCompile",value:function(t){var e=Z.k();return this.addModel(e),e.compile({optimizer:Z.s.sgd(t),loss:"meanSquaredError"}),e}},{key:"train",value:function(){var t=Object(v.a)(y.a.mark((function t(e,a){var n,s,i,c,o,l,h,d,u=this;return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=Z.r((function(){return Z.q(e)})),s=Z.r((function(){return Z.q(a)})),i=Z.r((function(){return u.state.tensorFlowNN})),c=function(t){return new Promise((function(e){return setTimeout(e,t)}))},o=this.state.controls.playing;case 5:if(!1===o){t.next=17;break}return this.setState({stopRender:!0}),l=this.state.controls,h=l.playing,d=l.speed,o=h,t.next=11,i.fit(n,s,{epochs:1,batchSize:1});case 11:return Z.r((function(){var t=i.predict(n),e=r.tensorToArray(t),s=Z.f.meanSquaredError(a,e).dataSync()[0];u.printParameters(i,s,e,u.state.epoch+1)})),this.setState({stopRender:!1}),t.next=15,c(d);case 15:t.next=5;break;case 17:this.setState({tensorFlowNN:i}),Z.c(n),Z.c(s);case 20:case"end":return t.stop()}}),t,this)})));return function(e,a){return t.apply(this,arguments)}}()},{key:"genTensorData",value:function(){var t=Object(v.a)(y.a.mark((function t(e,a,n){var s=this;return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Z.j();case 2:Z.r((function(){var t=Z.e(-s.state.scale,s.state.scale,n),i=Z.h(e(t),a),c=Z.t(t),o=r.tensorToArray(t),l=r.tensorToArray(i),h=r.tensorToArray(c);s.setState({X:o,y:l,yhat:h})}));case 3:case"end":return t.stop()}}),t)})));return function(e,a,n){return t.apply(this,arguments)}}()},{key:"printParameters",value:function(t,e,a,n){for(var r=[],s=[],i=0;i<t.getWeights().length;i++)(i%2===0?r:s).push(Array.from(t.getWeights()[i].dataSync()));var c=[].concat(Object(ot.a)(this.state.lossArray),[e]);this.setState({biasesData:s,weightsData:r,loss:e,yhat:a,epoch:n,lossArray:c}),this.initNeuralNetwork(this.state.shape)}},{key:"asyncPause",value:function(){var t=Object(v.a)(y.a.mark((function t(){return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.setState({controls:Object(X.a)(Object(X.a)({},this.state.controls),{},{playing:!1})});case 1:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"resetParameters",value:function(){var t=Object(v.a)(y.a.mark((function t(e){var a,n,r,s=this;return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return Z.c(this.state.tensorFlowNN),a=this.state.curve,Z.r((function(){"sin"===a?n=Z.m:"tanh"===a?n=Z.p:"cos"===a&&(n=Z.b)})),t.next=5,this.genTensorData(n,e,50);case 5:r=Z.r((function(){return s.modelCompile(s.state.lr)})),this.setState({epoch:0,loss:null,weights:[],miniNN:null,tensorFlowNN:r,shapedWeights:[],lossArray:[]}),Z.c(undefined);case 8:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"reset",value:function(){var t=Object(v.a)(y.a.mark((function t(e){return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.asyncPause(),this.resetParameters(e);case 2:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"correctZoom",value:function(t){var e=.25/474;return Math.min(1,e*t+.26845991561181437-.2)}},{key:"componentDidMount",value:function(){var t=Object(v.a)(y.a.mark((function t(){var e,a,n,r=this;return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:Z.l("cpu"),this.genTensorData(Z.m,this.state.scale,50),this.initNeuralNetwork(this.state.shape),e=Z.r((function(){return r.modelCompile(r.state.lr)})),a=document.body.clientWidth,n=this.correctZoom(a),this.setState({tensorFlowNN:e,zoom:n});case 7:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"shouldComponentUpdate",value:function(){return!this.state.stopRender}},{key:"render",value:function(){var t=this,e=this.state,a=e.X,n=e.y,r=e.shape,s=e.scale,i=e.miniNN,c=e.weightsData,o=e.biasesData,l=e.yhat,h=e.rects,d=e.weights,u=e.mode,j=e.epoch,p=e.curve,b=e.lr,x=e.loss,m=e.controls,g=e.shapedWeights,C=e.shapedLinks,F=e.shapedRects,A=e.keyFrameLayer,z=e.keyFrameLoss,I=e.subEpoch,W=e.isAnimating,q=e.singleInputExample,H=e.singleLabelExample,U=e.lossSavings,_=e.controlCenterHelp,G=e.customizationHelp,J=e.neuralNetworkHelp,K=e.lossChange,Q=(e.scatterHelp,e.keyFrameScatter),tt=e.zoom,et=m.playing,nt=m.speed,rt=[{label:"sin",eqn:Z.m,scale:5},{label:"cos",eqn:Z.b,scale:5},{label:"tanh",eqn:Z.p,scale:5}],it=Object(f.jsx)(E.a,{style:{background:this.state.controls.playing?"#D62839":"#175676",color:"white"},disableTouchRipple:!0,onClick:function(){return t.run()},children:et?Object(f.jsx)($.a,{}):Object(f.jsx)(M.a,{})}),ct=Object(f.jsxs)(at.a,{children:[Object(f.jsx)(L.a,{title:"reset",arrow:!0,children:Object(f.jsx)(V.a,{disabled:et,onClick:function(){t.reset(s)},children:Object(f.jsx)(Y.a,{})})}),it,Object(f.jsx)(L.a,{title:"speed up",arrow:!0,children:Object(f.jsx)(V.a,{style:{color:0===nt?"#FFC006":"grey"},onClick:function(){t.setState({controls:Object(X.a)(Object(X.a)({},m),{},{speed:0===nt?100:0})})},children:Object(f.jsx)(bt.a,{})})})]}),ot=Object(f.jsx)(B.a,{marginTop:2,children:Object(f.jsxs)(at.a,{children:[Object(f.jsxs)(N.a,{onClick:Object(v.a)(y.a.mark((function e(){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.anim();case 2:case"end":return e.stop()}}),e)}))),disabled:W,style:{color:W?"lightgrey":"black"},variant:"outlined",children:[Object(f.jsx)(Y.a,{})," ","  ","REPLAY"]}),Object(f.jsx)(N.a,{onClick:Object(v.a)(y.a.mark((function e(){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.randomInputGeneration(a,n,c,o,r,b,u),e.next=3,t.anim();case 3:case"end":return e.stop()}}),e)}))),style:{color:W?"lightgrey":"#4BA3C3"},disabled:W,variant:"outlined",children:"New Training Example"})]})}),lt=Object(f.jsxs)(B.a,{width:400,marginLeft:10,children:[Object(f.jsx)(T.a,{variant:"outlined",children:Object(f.jsxs)(P.a,{children:[Object(f.jsxs)(D.a,{variant:"caption",style:{color:"#4BA3C3"},children:["Control Center",Object(f.jsx)(V.a,{size:"small",style:{color:"orange"},onClick:function(){t.setState({controlCenterHelp:!0})},children:Object(f.jsx)(R.a,{})})]}),Object(f.jsx)("div",{}),Object(f.jsx)(L.a,{title:Object(f.jsx)(D.a,{variant:"h6",children:Object(f.jsx)("b",{children:u?"Click to go back to fitting":"Click to see backpropagation"})}),arrow:!0,placement:"top-start",children:Object(f.jsx)(N.a,{disabled:null==x||W,variant:"contained",onClick:Object(v.a)(y.a.mark((function e(){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!u){e.next=5;break}t.setState({subEpoch:"",mode:!u}),t.run(),e.next=8;break;case 5:return t.randomInputGeneration(a,n,c,o,r,b,u),e.next=8,t.anim();case 8:case"end":return e.stop()}}),e)}))),children:Object(f.jsxs)(D.a,{variant:"h4",children:["Epoch: ",u?this.state.cpyEpoch:j]})})}),u?Object(f.jsxs)(at.a,{children:[Object(f.jsx)(D.a,{style:{color:"orange"},variant:"h6",children:"Phase:"}),Object(f.jsx)(N.a,{disabled:!0,style:{color:"forward"===I?"orange":"grey"},children:"Forward"}),Object(f.jsx)(N.a,{disabled:!0,style:{color:"backward"===I?"orange":"grey"},children:"Backward"}),Object(f.jsx)(N.a,{disabled:!0,style:{color:"update"===I?"orange":"grey"},children:"Update"})]}):"",Object(f.jsx)(D.a,{variant:"h6",children:null==x||u?"":"Loss: ".concat(x.toPrecision(6))}),Object(f.jsx)(D.a,{variant:"h6",style:{color:"#4BA3C3"},children:u?"Training Example: (".concat(q.toPrecision(3),", ").concat(H.toPrecision(3),")"):""}),Object(f.jsxs)(D.a,{variant:"h5",style:{color:Q<3?"black":"orangered"},children:[u&&0!==K?Q<3?"loss: ":"new loss: ":"",u&&0!==K?Object(f.jsx)(ht.a,{value:K,formatValue:function(t){return t.toPrecision(6)},duration:750}):""]}),Object(f.jsxs)(D.a,{style:{color:"grey"},variant:"caption",children:[Q>3&&u?"loss decrease: ":"",Q>3&&u?Object(f.jsx)(ht.a,{value:this.state.lossDifference,formatValue:function(t){return t.toPrecision(6)},duration:750}):""]}),u?ot:ct,Object(f.jsx)(at.a,{})]})}),Object(f.jsx)(B.a,{marginTop:5,children:Object(f.jsx)(T.a,{variant:"outlined",children:Object(f.jsxs)(P.a,{children:[Object(f.jsxs)(D.a,{variant:"caption",style:{color:"#4BA3C3"},children:["Customization ",Object(f.jsx)(V.a,{size:"small",style:{color:"orange"},onClick:function(){t.setState({customizationHelp:!0})},children:Object(f.jsx)(R.a,{})})]}),Object(f.jsxs)(at.a,{children:[Object(f.jsx)(D.a,{variant:"caption",children:"Learning Rate"}),[1e-4,.001,.003,.005].map((function(e,a){return Object(f.jsx)(dt.a,{disabled:et||u,label:"".concat(e),style:{color:b===e?"white":"grey",background:b===e?"#175676":"lightgrey"},onClick:function(){Z.r((function(){t.changeModelLr(e),t.reset(s)}))}},a)}))]}),Object(f.jsxs)(at.a,{children:[Object(f.jsx)(D.a,{variant:"caption",children:"Data Set"}),rt.map((function(e,a){return Object(f.jsx)(dt.a,{disabled:et||u,label:e.label,style:{color:p===e.label?"white":"grey",background:p===e.label?"#175676":"lightgrey"},onClick:function(){t.setState({shape:r,curve:e.label}),t.reset(s),Z.r((function(){t.genTensorData(e.eqn,e.scale,50)}))}},a)}))]}),Object(f.jsxs)(at.a,{children:[Object(f.jsx)(D.a,{variant:"caption",children:"Layer"}),Object(f.jsx)(N.a,{disabled:et||u,onClick:function(){var e=r;e.length<5&&(e[e.length-1]=8,e.push(1),t.setState({shape:e}),t.initNeuralNetwork(e),t.reset(s))},children:"+"}),Object(f.jsx)(N.a,{disabled:et||u,onClick:function(){var e=r;e.length>3&&(e.splice(e.length-2,1),t.setState({shape:e}),t.initNeuralNetwork(e),t.reset(s))},children:"\u2013"})]})]})})})]}),yt=Object(f.jsxs)(B.a,{marginLeft:10,children:[Object(f.jsx)(B.a,{children:u?Object(f.jsx)(k,{width:300,height:300,padding:0,start:-s,stop:s,X:a,y:n,yhat:l,potential:this.state.potentialYhat,id:2,select:this.state.singleInputIndex,times:this.state.keyFrameScatter,shouldNotRender:this.state.shouldNotRender,status:this.state.status}):Object(f.jsx)(w,{width:300,height:300,padding:0,start:-s,stop:s,X:a,y:n,yhat:l,id:1,duration:200,select:-1})}),Object(f.jsx)(B.a,{marginTop:10,children:Object(f.jsx)(S,{lossArray:this.state.lossArray,duration:100})})]}),vt=Object(f.jsxs)(B.a,{children:[Object(f.jsx)(O,{miniNN:i,input:q,label:H,shapedWeights:g,shapedLinks:C,shapedRects:F,shape:r,biases:o,weights:d,rects:h,playing:et?0===nt?"edgeForward":"edgeSlowed":"edgePaused",show:et,mode:u,backward:this.state.direction,keyFrameLayer:A,keyFrameLoss:z,subEpoch:I,lossSavings:U,isAnimating:W,lr:b}),Object(f.jsx)(V.a,{size:"small",style:{color:"orange",position:"relative",bottom:"500px",left:"100px"},onClick:function(){t.setState({neuralNetworkHelp:!0})},children:Object(f.jsx)(R.a,{})})]});return Object(f.jsxs)("div",{id:"app",children:[Object(f.jsx)(T.a,{variant:"outlined",style:{background:"#FAFAFA",outlineColor:"white",paddingBottom:"1em"},children:Object(f.jsxs)(P.a,{style:{transform:"scale(".concat(tt,")")},children:[Object(f.jsxs)(B.a,{display:"flex",justifyContent:"center",children:[Object(f.jsx)(B.a,{marginRight:90,children:Object(f.jsx)("img",{src:gt,alt:"key"})}),Object(f.jsx)(B.a,{children:Object(f.jsx)(D.a,{variant:"h2",children:Object(f.jsx)("b",{children:"Backprop Tool"})})})]}),Object(f.jsxs)(B.a,{className:"regular",display:"flex",justifyContent:"center",marginTop:2,children:[vt,yt,lt]})]})}),Object(f.jsxs)(ut.a,{PaperProps:{style:{backgroundColor:"#F7F7F7"}},open:_,children:[Object(f.jsx)(jt.a,{children:Object(f.jsx)(V.a,{onClick:function(){t.setState({controlCenterHelp:!1})},children:Object(f.jsx)(xt.a,{})})}),Object(f.jsxs)(pt.a,{children:[Object(f.jsx)("img",{src:ft,alt:"how to use control center",width:"100%"}),Object(f.jsx)(B.a,{display:"flex",justifyContent:"center",children:Object(f.jsx)(B.a,{marginBottom:1,children:Object(f.jsx)(D.a,{variant:"h6",children:Object(f.jsxs)("ol",{children:[Object(f.jsxs)("li",{children:["Press"," ",Object(f.jsx)(E.a,{style:{background:"#175676",color:"white"},size:"small",children:Object(f.jsx)(M.a,{fontSize:"small"})})," ","to start training"]}),Object(f.jsxs)("li",{children:["Then press"," ",Object(f.jsx)(N.a,{variant:"contained",size:"small",children:"EPOCH"})," ","to see backpropagation animation"]}),Object(f.jsxs)("li",{children:["To go back to fitting mode click"," ",Object(f.jsx)(N.a,{variant:"contained",size:"small",children:"EPOCH"})," ","again"]})]})})})}),Object(f.jsx)("img",{src:Ot,width:"100%"})]})]}),Object(f.jsxs)(ut.a,{PaperProps:{style:{backgroundColor:"#F7F7F7"}},open:G,children:[Object(f.jsx)(jt.a,{children:Object(f.jsx)(V.a,{onClick:function(){t.setState({customizationHelp:!1})},children:Object(f.jsx)(xt.a,{})})}),Object(f.jsx)(pt.a,{children:Object(f.jsx)(B.a,{display:"flex",justifyContent:"center",children:Object(f.jsxs)(B.a,{marginBottom:5,children:[Object(f.jsx)(D.a,{variant:"h4",children:"Fixed"}),Object(f.jsxs)(D.a,{variant:"h6",children:["By default, this Neural Network stays fixed with",Object(f.jsxs)("ol",{children:[Object(f.jsx)("li",{children:"one input neuron, at least one hidden layer of eight ReLU neurons, and an output layer with one linear neuron."}),Object(f.jsx)("li",{children:"Stochastic Gradient Descent (one training example per epoch)"})]})]}),Object(f.jsx)(D.a,{variant:"h4",children:"Variable"}),Object(f.jsxs)(D.a,{variant:"h6",children:["You have the ability to change",Object(f.jsxs)("ol",{children:[Object(f.jsx)("li",{children:"Learning Rate (0.0001, 0.001, 0.003, or 0.005)"}),Object(f.jsx)("li",{children:"Data set (sine wave, cosine wave, or tanh curve)"}),Object(f.jsx)("li",{children:"Hidden layer neurons (min 1 and max 3)"})]})]})]})})})]}),Object(f.jsxs)(ut.a,{PaperProps:{style:{backgroundColor:"#FAFAFA"}},open:J,children:[Object(f.jsx)(jt.a,{children:Object(f.jsx)(V.a,{onClick:function(){t.setState({neuralNetworkHelp:!1})},children:Object(f.jsx)(xt.a,{})})}),Object(f.jsxs)(pt.a,{children:[Object(f.jsx)(B.a,{display:"flex",justifyContent:"center",children:Object(f.jsx)(B.a,{children:Object(f.jsx)("img",{src:st,alt:"summary",width:"400"})})}),Object(f.jsx)(B.a,{display:"flex",justifyContent:"center",children:Object(f.jsxs)(B.a,{marginBottom:5,children:[Object(f.jsx)(D.a,{variant:"h6",children:"Neural Network"}),Object(f.jsx)(D.a,{variant:"body1",children:"Each square is a neuron in the neural network. To see the types of neurons check the key located right above the neural network."})]})}),Object(f.jsx)("img",{src:mt,alt:"singleSummary",width:"100%"}),Object(f.jsx)(B.a,{display:"flex",justifyContent:"center",children:Object(f.jsxs)(B.a,{marginBottom:5,children:[Object(f.jsxs)(D.a,{variant:"body1",children:["During a single epoch after clicking"," ",Object(f.jsx)(N.a,{size:"small",variant:"contained",children:"EPOCH"})," ",", each arrow will represent the direction to nudge the output to lower loss."]}),Object(f.jsx)(D.a,{variant:"body1",children:"The fill color shows the activation output, brighter is more active."})]})})]})]})]})}}]),a}(i.Component),Bt=(i.Component,a(616)),Et=function(t){Object(u.a)(a,t);var e=Object(j.a)(a);function a(){return Object(h.a)(this,a),e.apply(this,arguments)}return Object(d.a)(a,[{key:"componentDidMount",value:function(){b.a.initialize("UA-192166007-1"),b.a.pageview("/")}},{key:"render",value:function(){var t=function(t,e,a){return Object(f.jsx)(N.a,{style:{color:a?"#56A8C7":"#FFA500"},href:t,target:"_blank",rel:"noopener noreferrer",children:e})},e=Object(f.jsx)("div",{children:Object(f.jsx)("img",{src:p,alt:"header with title",width:"100%"})}),a=Object(f.jsx)(B.a,{display:"flex",justifyContent:"center",children:Object(f.jsxs)(B.a,{width:"60%",marginTop:4,children:[Object(f.jsx)(D.a,{variant:"h3",children:Object(f.jsx)("b",{children:"Acknowledgements"})}),Object(f.jsxs)(D.a,{variant:"body1",children:[t("https://playground.tensorflow.org/","TensorFlow Playground",!1),"by",t("https://smilkov.com/","Daniel Smilkov",!0),t("http://shancarter.com/","shan carter",!0),Object(f.jsxs)("ul",{children:[Object(f.jsx)("li",{children:"Inspiration for the representation of the neural network"}),Object(f.jsx)("li",{children:"Adapted d3 code for the loss graph\u2019s and best fit graphs axis scaling"}),Object(f.jsx)("li",{children:"Adapted css code for the links keyframe animation"})]})]}),Object(f.jsx)("br",{}),Object(f.jsxs)(D.a,{variant:"body1",children:[t("https://www.youtube.com/watch?v=Ilg3gGewQ5U","What is backpropagation really doing?",!1),"by",t("https://www.3blue1brown.com/","3Blue1Brown",!0),Object(f.jsxs)("ul",{children:[Object(f.jsx)("li",{children:"Inspiration to use arrows to represent where to nudge outputs to lower loss"}),Object(f.jsx)("li",{children:"Inspiration for weights color scheme"})]})]}),Object(f.jsx)("br",{}),Object(f.jsxs)(D.a,{variant:"body1",children:[t("https://poloclub.github.io/cnn-explainer/","CNN explainer",!1),"by",t("https://zijie.wang/","Jay Wang",!0),t("https://www.linkedin.com/in/robert-turko/","Robert Turko",!0),t("https://oshaikh.com/","Omar Shaikh",!0),t("https://haekyu.com/","Haekyu Park",!0),t("http://nilakshdas.com/","Nilaksh Das",!0),t("https://fredhohman.com/","Fred Hohman",!0),t("https://minsuk.com/","Minsuk Kahng",!0),t("https://www.cc.gatech.edu/~dchau/","Polo Chau",!0),Object(f.jsxs)("ul",{children:[Object(f.jsx)("li",{children:"Inspiration for the article format with components"}),Object(f.jsx)("li",{children:"Inspiration for the name backprop explainer"})]})]}),Object(f.jsx)("br",{}),Object(f.jsx)(D.a,{variant:"h4",children:Object(f.jsx)("b",{children:"How was this made?"})}),Object(f.jsxs)(D.a,{variant:"body1",children:["Made with",t("https://d3js.org/","d3.js",!1),"and",t("https://reactjs.org/","react.js",!1),"for interactive visualization components,",t("https://www.tensorflow.org/js","tensorflow.js",!1),"for neural network training and fast math operations, and",t("https://katex.org/",n.$("\\KaTeX"),!1),"to render ",n.$("\\LaTeX")," math equations."]}),Object(f.jsx)("br",{}),Object(f.jsx)(D.a,{variant:"h4",children:Object(f.jsx)("b",{children:"Found any errors?"})}),Object(f.jsxs)(D.a,{variant:"body1",children:["If you found in error in an explanation, equation, or in one of the interactive components please create an issue on Github",Object(f.jsx)(V.a,{href:"https://github.com/xnought/backprop-explainer",children:Object(f.jsx)(Bt.a,{})})]}),Object(f.jsx)("br",{}),Object(f.jsx)(D.a,{variant:"h4",children:Object(f.jsx)("b",{children:"Who made this?"})}),Object(f.jsxs)(D.a,{variant:"body1",children:["Created by",t("http://donnybertucci.com/","Donny bertucci",!0)]}),Object(f.jsxs)(D.a,{variant:"body1",children:["Project advised by",t("http://minsuk.com/","Minsuk Kahng",!0)]}),Object(f.jsx)("br",{})]})});return Object(f.jsxs)("div",{children:[e,Object(f.jsx)(ct,{}),Object(f.jsx)(z.Element,{name:"mainTool",children:Object(f.jsx)(Dt,{})}),Object(f.jsx)(z.Element,{name:"acknowledgements",children:a}),Object(f.jsx)("br",{})]})}}]),a}(i.Component),Mt=(a(579),function(t){t&&t instanceof Function&&a.e(3).then(a.bind(null,625)).then((function(e){var a=e.getCLS,n=e.getFID,r=e.getFCP,s=e.getLCP,i=e.getTTFB;a(t),n(t),r(t),s(t),i(t)}))});l.a.render(Object(f.jsx)(c.a.StrictMode,{children:Object(f.jsx)(Et,{})}),document.getElementById("root")),Mt()}},[[580,1,2]]]);
//# sourceMappingURL=main.56f1beea.chunk.js.map