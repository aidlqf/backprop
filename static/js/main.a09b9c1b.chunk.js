(this["webpackJsonpbackprop-explainer"]=this["webpackJsonpbackprop-explainer"]||[]).push([[0],{131:function(e,t,a){},545:function(e,t){},546:function(e,t){},554:function(e,t){},561:function(e,t){},562:function(e,t){},563:function(e,t,a){},564:function(e,t,a){"use strict";a.r(t);var n={};a.r(n),a.d(n,"formatWeightArray",(function(){return je})),a.d(n,"toFunc2DArray",(function(){return be})),a.d(n,"flatten",(function(){return fe})),a.d(n,"getRandomInt",(function(){return xe})),a.d(n,"tensorToArray",(function(){return ge}));var r={};a.r(r),a.d(r,"generateLinearScale",(function(){return me})),a.d(r,"generateLink",(function(){return ye})),a.d(r,"generateNeuronPlacement",(function(){return ve})),a.d(r,"generateLinksPlacement",(function(){return Oe}));var s=a(11),i=a.n(s),o=a(63),c=a.n(o),l=a(4),h=a(10),u=a(14),d=a(15),p=a.p+"static/media/header.f51054ca.svg",j=a(255),b=a(33),f=(a(131),a(9));var x=function(){var e=100;return Object(f.jsx)("div",{children:Object(f.jsxs)("svg",{width:e,height:10,className:"grad",overflow:"visible",children:[Object(f.jsx)("text",{fill:"grey",fontFamily:"sans-serif",fontSize:"10px",x:0,y:-13,children:"Color and stroke"}),Object(f.jsx)("text",{fill:"grey",fontFamily:"sans-serif",fontSize:"10px",x:0,y:-4,children:"indicate weight"}),Object(f.jsx)("text",{fontSize:"12px",fill:"grey",x:-.5,y:18,children:"|"}),Object(f.jsx)("text",{fontSize:"13px",fill:"grey",x:-2.5,y:28,children:"\u2013"}),Object(f.jsx)("text",{fontSize:"12px",fill:"grey",x:48,y:18,children:"|"}),Object(f.jsx)("text",{fontSize:"13px",fill:"grey",x:45.5,y:30,children:"0"}),Object(f.jsx)("text",{fontSize:"12px",fill:"grey",x:98,y:18,children:"|"}),Object(f.jsx)("text",{fontSize:"13px",fill:"grey",x:95.5,y:28,children:"+"})]})})},g=function(e){var t=e.source,a=e.target,n=e.color,r=e.isAnimating;return Object(f.jsxs)("g",{children:[Object(f.jsx)("defs",{children:Object(f.jsx)("marker",{id:"head",orient:"auto",markerWidth:"3",markerHeight:"4",refX:"0.1",refY:"2",children:Object(f.jsx)("path",{d:"M0,0 V4 L2,2 Z",fill:n})})}),Object(f.jsx)("path",{className:r?"absorb":"arrow",id:"arrow-line",markerEnd:"url(#head)",fill:"none",stroke:n,d:"M".concat(t.x,",").concat(t.y,", ").concat(a.x,", ").concat(a.y)})]})},m=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={},n}return Object(h.a)(a,[{key:"flatten",value:function(e){for(var t=[],a=0;a<e.length;a++)for(var n=0;n<e[a].length;n++)t.push(e[a][n]);return t}},{key:"isEmpty",value:function(e){return 0===e.length}},{key:"isUndefined",value:function(e){return"undefined"===typeof e}},{key:"isUndefined3d",value:function(e,t,a,n){return this.isUndefined(e[t])||this.isUndefined(e[t][a])||this.isUndefined(e[t][a][n])}},{key:"render",value:function(){var e=this,t=this.props,a=t.playing,n=t.mode,r=t.shapedLinks,s=t.shapedWeights,i=t.shapedRects,o=t.miniNN,c=t.subEpoch,l=t.keyFrameLoss,h=t.keyFrameLayer,u=(t.input,t.label,t.children,b.k().x((function(e){return e.x})).y((function(e){return e.y}))),d="black",p=32,j=function(e,t,a,n,r){var s=n?-a:a;return Object(f.jsx)(g,{source:{x:e,y:t},target:{x:e,y:t+s},color:r,isAnimating:"transition"===c})},m=Object(f.jsx)("svg",{id:"p",width:"810",height:"500",overflow:"visible",children:Object(f.jsxs)("g",{id:"ee",children:[Object(f.jsx)("path",{d:"M 750, 234 L 750, 300",stroke:2===l||1===l?"orange":d,className:n&&l>0?1===l?"edgeForward":2===l?"edgeBackward":"edgePaused":a}),Object(f.jsx)("path",{d:u({source:{x:766,y:315},target:{x:890,y:430}}),stroke:d,fill:"none",className:a}),Object(f.jsx)("path",{d:u({source:{x:766,y:250},target:{x:890,y:150}}),stroke:d,fill:"none",className:a}),r.map((function(t,r){return t.map((function(t,i){var l="edgePaused",u="orange",d=!1;return n&&"forward"===c&&r===h?(l="edgeForward",d=!0,u="orange"):n&&"backward"===c&&r===h&&(l="edgeBackward",d=!0),t.map((function(t,h){var p=e.isUndefined3d(s,r,i,h),j=p?[]:s[r][i][h],x=p?1:2*Math.abs(j)+.1,g=p?"lightgrey":j>0?"#4BA3C3":"#D62839";if(n&&"update"===c&&!0===e.props.isAnimating){var m=2*o.model[r][i].dWeights[h],y=.01*m;b.r("#nn").select("#p").select("#ee").select("#cpath".concat(r).concat(i).concat(h)).transition().duration(750).ease(b.d).attr("stroke-width",x-m).transition().duration(750).ease(b.e).attr("stroke-width",x-y)}return Object(f.jsx)("path",{id:"cpath".concat(r).concat(i).concat(h),d:t,className:n?l:a,strokeWidth:x,stroke:d?u:g,fill:"none"},h)}))}))})),Object(f.jsx)("rect",{x:34,y:234,width:p,height:p,fill:"darkgrey"}),i.map((function(t,a){return t.map((function(t,r){var s=!1,i="backward"===c||"transition"===c;return(n&&a<=h||i||"update"===c)&&(s=!0),Object(f.jsxs)("g",{children:[Object(f.jsx)("rect",{x:t.x,y:t.y,width:p,height:p,fill:b.o(104,104,104).brighter(s?o.model[a][r].actStep+e.props.lr:1),stroke:"black",strokeWidth:2,className:"bar"}),null!==o&&n&&i&&a>=h-1?j(t.x+16,t.y+16,Math.abs(o.model[a][r].dActStep),o.model[a][r].dActStep<0,"orange"):""]})}))})),Object(f.jsx)("rect",{x:734,y:300,width:p,height:p,fill:"none",stroke:"black"}),Object(f.jsx)("text",{fontFamily:"sans-serif",fontSize:"12px",x:739,y:318,children:"loss"})]})});return Object(f.jsxs)("div",{id:"nn",children:[m,Object(f.jsx)(x,{})]})}}]),a}(s.Component),y=a(2),v=a.n(y),O=a(13),w=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={},n}return Object(h.a)(a,[{key:"plotPoints",value:function(e,t,a){e.selectAll("circle").data(t).enter().append("circle").attr("cx",(function(e){return e.x})).attr("cy",(function(e){return e.y})).attr("r",(function(e,t){return t===a?5:2})).style("fill",(function(e,t){return t===a?"orange":"grey"}))}},{key:"componentDidMount",value:function(){var e=Object(O.a)(v.a.mark((function e(){var t,a,n,r,s,i,o,c,l,h,u,d,p;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.props,a=t.width,n=t.height,r=t.padding,s=t.start,i=t.stop,o=t.id,c=b.r("#nice".concat(o)),(l=c.append("svg").attr("width",a).attr("height",n).style("overflow","visible")).append("rect").attr("width",a).attr("height",n).attr("class","cord"),h=b.p().domain([s,i]).range([0,a-2*r]),u=b.p().domain([s,i]).range([n-2*r,0]),d=b.a().scale(h),p=b.b().scale(u),l.append("g").attr("class","axis").attr("transform","translate(0,".concat(n-2*r,")")).call(d),l.append("g").attr("class","axis").attr("transform","translate("+(a-2*r)+",0)").call(p),l.append("line").attr("x1",0).attr("y1",(n+1)/2).attr("x2",a).attr("y2",(n+1)/2).attr("class","split"),l.append("line").attr("x1",(a+1)/2).attr("y1",0).attr("x2",(a+1)/2).attr("y2",n).attr("class","split"),l.append("path").attr("id","epic").attr("stroke","none").attr("fill","none");case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){for(var e=this.props,t=e.width,a=e.height,n=e.padding,r=e.start,s=e.stop,i=e.X,o=e.y,c=e.yhat,l=e.id,h=e.select,u=b.p().domain([r,s]).range([0,t-2*n]),d=b.p().domain([r,s]).range([a-2*n,0]),p=b.r("#nice".concat(l)).select("svg"),j=[],f=0;f<i.length;f++)j.push({x:u(i[f]),y:d(o[f])});for(var x=[],g=0;g<i.length;g++)x.push([u(i[g]),d(c[g])]);p.selectAll("circle").remove(),this.plotPoints(p,j,h),p.select("#epic").transition().duration(this.props.duration).attr("d",b.j()(x)).attr("stroke","black").attr("fill","none")}},{key:"render",value:function(){var e=this.props.id;return Object(f.jsx)("div",{id:"nice".concat(e)})}}]),a}(s.Component),k=(a(0),function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){return Object(l.a)(this,a),t.call(this,e)}return Object(h.a)(a,[{key:"plotPoints",value:function(e,t,a){e.selectAll("circle").data(t).enter().append("circle").attr("cx",(function(e){return e.x})).attr("cy",(function(e){return e.y})).attr("r",(function(e,t){return t===a?5:2})).style("fill",(function(e,t){return t===a?"#4BA3C3":"grey"}))}},{key:"animateTruePredictions",value:function(e,t){e.select("#epic").transition().duration(1e3).ease(b.f).attr("d",b.j()(t)).attr("stroke","blue").attr("fill","none")}},{key:"animatePotentialPredictions",value:function(){}},{key:"componentDidMount",value:function(){var e=Object(O.a)(v.a.mark((function e(){var t,a,n,r,s,i,o,c,l,h,u,d,p;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.props,a=t.width,n=t.height,r=t.padding,s=t.start,i=t.stop,o=t.id,c=b.r("#animatedPlot".concat(o)),(l=c.append("svg").attr("width",a).attr("height",n).style("overflow","visible")).append("rect").attr("width",a).attr("height",n).attr("class","cord"),h=b.p().domain([s,i]).range([0,a-2*r]),u=b.p().domain([s,i]).range([n-2*r,0]),d=b.a().scale(h),p=b.b().scale(u),l.append("g").attr("class","axis").attr("transform","translate(0,".concat(n-2*r,")")).call(d),l.append("g").attr("class","axis").attr("transform","translate("+(a-2*r)+",0)").call(p),l.append("line").attr("x1",0).attr("y1",(n+1)/2).attr("x2",a).attr("y2",(n+1)/2).attr("class","split"),l.append("line").attr("x1",(a+1)/2).attr("y1",0).attr("x2",(a+1)/2).attr("y2",n).attr("class","split"),l.append("path").attr("id","epic").attr("stroke","none").attr("fill","none");case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"a",value:function(){for(var e=this.props,t=e.width,a=e.height,n=e.padding,r=e.start,s=e.stop,i=e.X,o=e.y,c=e.yhat,l=e.id,h=e.select,u=e.potential,d=e.times,p=b.p().domain([r,s]).range([0,t-2*n]),j=b.p().domain([r,s]).range([a-2*n,0]),f=b.r("#animatedPlot".concat(l)).select("svg"),x=[],g=0;g<i.length;g++)x.push({x:p(i[g]),y:j(o[g])});for(var m=[],y=[],v=[],O=0;O<i.length;O++){var w=p(i[O]);m.push([w,j(c[O])]),v.push([w,j(u[O])]),y.push([w,j(0)])}f.selectAll("circle").remove(),this.plotPoints(f,x,h),0===d&&f.select("#epic").attr("id","epic").attr("stroke","none").attr("fill","none"),2===d||2!==d&&(1===this.props.times?(f.select("#epic").attr("d",b.j()(y)).attr("stroke","black").attr("fill","none"),f.select("#epic").transition().duration(1e3).attr("d",b.j()(m))):4===this.props.times&&(f.select("#epic").attr("d",b.j()(y)).attr("stroke","orangered").attr("fill","none"),f.select("#epic").transition().duration(1e3).attr("d",b.j()(v))))}},{key:"render",value:function(){this.a();var e=this.props.id;return Object(f.jsx)("div",{id:"animatedPlot".concat(e)})}}]),a}(s.Component)),S=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={},n}return Object(h.a)(a,[{key:"componentDidMount",value:function(){var e=b.r("#sweet"),t=100,a=300,n=b.p().domain([0,-1]).range([0,300]),r=b.p().domain([1,1]).range([100,0]),s=e.append("svg").attr("width",a).attr("height",t).style("overflow","visible");s.append("rect").attr("width",a).attr("height",t).attr("class","cord");var i=b.a().scale(n),o=b.b().scale(r);s.append("g").attr("class","axis").attr("id","x").attr("transform","translate(0,".concat(100,")")).call(i),s.append("g").attr("class","axis").attr("id","y").attr("transform","translate(300,0)").call(o.ticks(0)),s.append("path").attr("id","line").attr("stroke","none").attr("fill","none")}},{key:"componentDidUpdate",value:function(){for(var e=this.props,t=e.lossArray,a=e.duration,n=t.length-1,r=b.p().domain([0,n]).range([1,300]),s=b.m(t),i=b.l(t),o=b.p().domain([s,i]).range([100,0]),c=b.r("#sweet").select("svg"),l=[],h=0;h<t.length;h++)l.push([r(h),o(t[h])]);var u=b.a().scale(r),d=b.b().scale(o);c.select("#x").attr("transform","translate(0,".concat(100,")")).call(u.ticks(5)),c.select("#y").attr("transform","translate(300,0)").call(d.ticks(5)),c.select("#line").transition().duration(a).attr("d",b.j()(l)).attr("stroke","black").attr("fill","none")}},{key:"render",value:function(){return Object(f.jsx)("div",{id:"sweet"})}}]),a}(s.Component),C=(a(557),a(253)),F=function(e){return Object(f.jsx)(C.InlineMath,{math:e})},E=function(e){return Object(f.jsx)(C.BlockMath,{math:e})},N=a(42),L=a(600),M=a(582),A=a(584),P=a(603),z=(s.Component,a(585)),B=a(586),T=a(587),D=(s.Component,a.p,a.p+"static/media/forward.94373b2e.svg"),I=a.p+"static/media/backward.0c67cde4.svg",R=a(34),W=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={weight:-.82,bias:-.02,loss:0,domain:[],range:[],line:[],show:!1},n}return Object(h.a)(a,[{key:"loss",value:function(e,t,a){return R.r((function(){var n=R.q(e),r=R.q(t);return 1/(2*a)*R.o(R.i(R.n(r,n),2)).dataSync()[0]}))}},{key:"computeLine",value:function(e,t,a){for(var n,r=new Array(a.length),s=0;s<a.length;s++)r[s]=(n=a[s],e*n+t);return r}},{key:"zeros",value:function(e){for(var t=new Array(e),a=0;a<e;a++)t[a]=0;return t}},{key:"range",value:function(e,t,a){for(var n=[],r=e;r<=t;r+=a)n.push(r);return n}},{key:"dataGenerator",value:function(){var e=this.range(-1,1,.1),t=this.computeLine(.65,-.3,e),a=this.computeLine(this.state.weight,this.state.bias,e),n=this.loss(t,a,t.length);this.setState({domain:e,range:t,line:a,loss:n})}},{key:"componentDidMount",value:function(){this.dataGenerator()}},{key:"render",value:function(){var e=this,t=this.state,a=t.domain,n=t.range,r=t.bias,s=t.weight,i=t.line,o=t.loss,c=t.show;return Object(f.jsxs)(L.a,{display:"flex",justifyContent:"center",children:[Object(f.jsx)(L.a,{style:{filter:"blur(".concat(c?0:25,"px)")},children:Object(f.jsx)(w,{width:400,height:400,padding:0,start:-1,stop:1,X:a,y:n,yhat:i,id:69,select:-1,duration:0})}),Object(f.jsx)(L.a,{marginLeft:7,children:Object(f.jsx)(M.a,{variant:"outlined",children:Object(f.jsxs)(A.a,{children:[Object(f.jsx)("h2",{children:"Manual Best Fit"}),Object(f.jsxs)("p",{children:["Manually tune"," ",Object(f.jsx)("em",{style:{color:"#4050B5"},children:"weight"})," and"," ",Object(f.jsx)("em",{style:{color:"#F50257"},children:"bias"})," and try to reach a"," ",Object(f.jsx)("em",{style:{color:"red"},children:"loss"})," of 0"]}),Object(f.jsx)(P.a,{value:s,onChange:function(t,i){var o=e.computeLine(s,r,a),c=e.loss(n,o,n.length);e.setState({weight:i,line:o,loss:c})},min:-1,step:.01,max:1,valueLabelDisplay:"auto",color:"primary"}),Object(f.jsx)(P.a,{value:r,onChange:function(t,i){var o=e.computeLine(s,r,a),c=e.loss(n,o,n.length);e.setState({bias:i,line:o,loss:c})},min:-1,step:.01,valueLabelDisplay:"auto",max:1,color:"secondary"}),Object(f.jsxs)("h3",{children:[F("\\text{neuron}(x) = ")," ",Object(f.jsx)("em",{style:{color:"#4050B5"},children:F("".concat(s))}),F("x + ")," ",Object(f.jsx)("em",{style:{color:"#F50257"},children:F("".concat(r))})]}),Object(f.jsxs)("h3",{children:["MSE loss:"," ",F("\\frac{1}{J}\\sum_{i = 0}^J (\\hat{y} - y)^2 ="),Object(f.jsxs)("em",{style:{color:"darkred"},children:[" ",F("".concat(o.toFixed(7)))]})]}),Object(f.jsx)(T.a,{size:"small",variant:"contained",color:"primary",onClick:function(){e.setState({show:!e.state.show})},children:"Click to Reveal Graph"})]})})})]})}}]),a}(s.Component),_=a(50),q=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={width:400,height:400},n}return Object(h.a)(a,[{key:"componentDidMount",value:function(){var e=Object(O.a)(v.a.mark((function e(){var t,a,n,r,s,i,o,c,l,h,u,d,p,j,f,x,g;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return j=function(e,t){for(var a=i.X,n=i.y,r=0,s=0;s<i.X.length;s++)r+=Math.pow(e*a[s]+t-n[s],2);return r/(2*a.length)},e.next=3,this.state;case 3:return t=e.sent,a=t.width,n=t.height,r=b.r("#divContour").select("#contour"),e.next=9,this.props;case 9:for(s=e.sent,i=s.data,o=s.darkness,c=a,l=n,h=new Array(c*l),u=.5,d=0;u<l;++u)for(p=.5;p<c;++p,++d)h[d]=j(p/c*10-5,u/l*20);return e.next=16,b.n(o,20,1).map((function(e){return Math.pow(2,e)}));case 16:f=e.sent,x=b.q(b.g(f),b.i),g=b.c().size([c,l]).thresholds(f)(h),r.append("g").attr("fill","none").selectAll("path").data(g).join("path").attr("fill",(function(e){return x(e.value)})).attr("d",b.h()),r.append("circle").attr("cx",a/2).attr("cy",0).attr("r",5).style("fill","none").style("stoke","none");case 21:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=this.state,t=e.width,a=e.height,n=this.props,r=n.loss,s=n.ms,i=n.m,o=n.b,c=b.r("#divContour").select("#contour");null!=r?r<1e3&&c.select("circle").transition().duration(200-s).attr("cx",t/2+i/10*t).attr("cy",o/20*a).attr("r",2*r+5).style("fill","red").style("opacity","0.5"):c.select("circle").attr("cx",t/2).attr("cy",0).attr("r",5).style("fill","none").style("stroke","none")}},{key:"render",value:function(){var e=this.state,t=e.width,a=e.height;return Object(f.jsx)("div",{id:"divContour",children:Object(f.jsx)("svg",{style:{width:t,height:a},id:"contour"})})}}]),a}(s.Component),H=a(588),U=a(590),X=a(589),G=a(591),V=a(592),Y=a(593),J=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={yhat:[],darkness:-8,playButton:!0,linreg:{meanSquaredError:0,rsquared:null,data:{X:[],y:[]},hyperparams:{learningRate:.03,epochs:0,loss:null,speed:200},tunableparams:{m:0,b:0}}},n.generateData=n.generateData.bind(Object(N.a)(n)),n.linearRegression=n.linearRegression.bind(Object(N.a)(n)),n.a=n.a.bind(Object(N.a)(n)),n.handleSlider=n.handleSlider.bind(Object(N.a)(n)),n.reset=n.reset.bind(Object(N.a)(n)),n}return Object(h.a)(a,[{key:"reset",value:function(){this.generateData(),this.setState(Object(_.a)(Object(_.a)({},this.state),{},{playButton:!0,linreg:Object(_.a)(Object(_.a)({},this.state.linreg),{},{rsquared:null,hyperparams:Object(_.a)(Object(_.a)({},this.state.linreg.hyperparams),{},{epochs:0,loss:null}),tunableparams:{m:0,b:0}})}))}},{key:"generateData",value:function(){var e=this;R.r((function(){var t=[0,1,2,3,4,5],a=[5,4,3,2,1,0],n=R.q(a),r=R.g(n).dataSync()[0],s=1/(2*t.length)*R.o(R.i(R.n(r,n),2)).dataSync()[0];e.setState(Object(_.a)(Object(_.a)({},e.state),{},{yhat:[0,0,0,0,0,0],linreg:Object(_.a)(Object(_.a)({},e.state.linreg),{},{meanSquaredError:s,data:{X:t,y:a}})}))}))}},{key:"linearRegression",value:function(){var e=this;R.r((function(){if(e.state.linreg.hyperparams.epochs>1e3)e.setState({playButton:!e.state.playButton});else{var t=e.state.linreg.tunableparams,a=t.m,n=t.b,r=e.state.linreg.hyperparams.learningRate,s=e.state.linreg.data,i=s.X,o=s.y,c=R.q(i),l=R.q(o),h=function(e,t,a){return R.a(R.h(e,t),a)}(c,a,n),u=c.shape[0],d=1/u*R.o(R.h(R.n(h,l),c)).dataSync()[0],p=1/u*R.o(R.n(h,l)).dataSync()[0],j=function(e,t){return 1/(2*u)*R.o(R.i(R.n(t,e),2)).dataSync()[0]}(l,h);a+=-r*d,n+=-r*p;var b=1-j/e.state.linreg.meanSquaredError,f=e.state.linreg.hyperparams.epochs+1,x=Array.from(h.dataSync());e.setState(Object(_.a)(Object(_.a)({},e.state),{},{yhat:x,linreg:Object(_.a)(Object(_.a)({},e.state.linreg),{},{rsquared:b,tunableparams:{m:a,b:n},hyperparams:Object(_.a)(Object(_.a)({},e.state.linreg.hyperparams),{},{epochs:f,loss:j})})}))}}))}},{key:"a",value:function(){var e=Object(O.a)(v.a.mark((function e(){var t,a,n,r;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=function(e){return new Promise((function(t){return setTimeout(t,e)}))},a=200;case 2:return n=this.state.linreg.hyperparams.speed,r=a-n,e.next=7,this.linearRegression();case 7:return e.next=9,t(r);case 9:if(!0!==this.state.playButton){e.next=11;break}return e.abrupt("break",13);case 11:e.next=2;break;case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"handleSlider",value:function(e,t){this.setState({linreg:Object(_.a)(Object(_.a)({},this.state.linreg),{},{hyperparams:Object(_.a)(Object(_.a)({},this.state.linreg.hyperparams),{},{speed:t})})})}},{key:"componentDidMount",value:function(){var e=Object(O.a)(v.a.mark((function e(){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.generateData();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e,t,a,n=this,r=this.state.linreg.tunableparams,s=r.m,i=r.b,o=this.state.linreg.hyperparams,c=o.loss,l=o.speed,h=o.epochs,u=this.state.linreg,d=(u.rsquared,u.data);return Object(f.jsx)("div",{children:Object(f.jsxs)(L.a,{display:"flex",justifyContent:"center",marginTop:2,children:[Object(f.jsx)(L.a,{marginTop:10,marginRight:10,children:Object(f.jsx)(w,{width:400,height:400,padding:0,start:0,stop:5,X:d.X,y:d.y,yhat:this.state.yhat,id:420,select:-1,duration:0})}),Object(f.jsxs)(M.a,{variant:"outlined",children:[Object(f.jsxs)(A.a,{children:[Object(f.jsx)("h2",{children:"Full Process Best Fit"}),Object(f.jsxs)(z.a,{variant:"h4",component:"h2",children:["EPOCH: ",h]}),Object(f.jsx)(z.a,{variant:"h6",component:"h2",style:{color:(a=c,null===a?"#dce0dd":"black")},children:" loss = ".concat((e=c,t=10,null===e?e:e.toPrecision(t)))}),Object(f.jsx)(H.a,{onClick:this.reset,children:Object(f.jsx)(X.a,{})}),Object(f.jsx)(U.a,{style:{background:this.state.playButton?"#175676":"#D62839",color:"white"},onClick:Object(O.a)(v.a.mark((function e(){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.setState({playButton:!n.state.playButton});case 2:return e.next=4,n.a();case 4:case"end":return e.stop()}}),e)}))),disableTouchRipple:!0,children:this.state.playButton?Object(f.jsx)(G.a,{}):Object(f.jsx)(V.a,{})}),Object(f.jsx)(H.a,{style:{color:200===l?"grey":"#FFC006"},onClick:function(){n.setState({linreg:Object(_.a)(Object(_.a)({},n.state.linreg),{},{hyperparams:Object(_.a)(Object(_.a)({},n.state.linreg.hyperparams),{},{speed:200===l?120:200})})})},children:Object(f.jsx)(Y.a,{})})]}),Object(f.jsx)(q,{ms:l,data:d,m:isFinite(s)?s:0,b:isFinite(i)?i:0,loss:c,darkness:this.state.darkness})]})]})})}}]),a}(s.Component),Z=function(){var e=Object(f.jsxs)("div",{children:[Object(f.jsx)(z.a,{variant:"h3",children:"Table of Contents"}),Object(f.jsx)(T.a,{disabled:!0,size:"small",color:"secondary",children:"Color Legend:"}),Object(f.jsx)(T.a,{size:"small",style:{pointerEvents:"none"},children:"Section"}),Object(f.jsx)(T.a,{size:"small",color:"primary",style:{pointerEvents:"none"},children:"Static Text"}),Object(f.jsx)(T.a,{size:"small",color:"secondary",style:{pointerEvents:"none"},children:"Interactive Tool"}),Object(f.jsxs)("ol",{children:[Object(f.jsx)("li",{children:Object(f.jsx)(T.a,{size:"large",children:"Introduction"})}),Object(f.jsxs)("li",{children:[Object(f.jsx)(T.a,{size:"large",children:"backpropagation on one neuron"}),Object(f.jsxs)("ol",{type:"a",children:[Object(f.jsx)("li",{children:Object(f.jsx)(T.a,{color:"secondary",size:"small",children:"Manual Best Fit"})}),Object(f.jsx)("li",{children:Object(f.jsx)(T.a,{color:"primary",size:"small",children:"Explanation"})}),Object(f.jsx)("li",{children:Object(f.jsx)(T.a,{color:"primary",size:"small",children:"Math Example"})}),Object(f.jsx)("li",{children:Object(f.jsx)(T.a,{color:"secondary",size:"small",children:"Training Best Fit"})})]})]}),Object(f.jsxs)("li",{children:[Object(f.jsx)(T.a,{size:"large",children:"Scaling up"}),Object(f.jsxs)("ol",{type:"a",children:[Object(f.jsx)("li",{children:Object(f.jsx)(T.a,{color:"primary",size:"small",children:"Explanation"})}),Object(f.jsx)("li",{children:Object(f.jsx)(T.a,{color:"primary",size:"small",children:"Math Example"})}),Object(f.jsx)("li",{children:Object(f.jsx)(T.a,{color:"secondary",size:"small",children:"Full Neural Network Backpropagation Explainer"})})]})]})]})]}),t=Object(f.jsxs)("div",{children:[Object(f.jsx)(z.a,{variant:"h3",children:"Introduction"}),Object(f.jsx)("p",{children:"Most people abstract the idea of backpropagation when learning neural networks because it is by far the most notation heavy part. The goal of this article is to marry the notation with some interactive tools to better understand a very important idea."}),Object(f.jsx)("p",{children:"Our goal in a neural network is to lower whatever loss function we define. For this article, we will be performing regression and using mean squared error loss (MSE)."}),E("\\text{MSE} = \\frac{1}{J}\\sum_{i=0}^{J}(\\hat{y} - y)^2"),Object(f.jsx)(z.a,{variant:"h3",children:"Backpropogation on One Neuron"}),Object(f.jsx)("p",{children:"Before hitting the calculus, try to lower loss the best you can by adjusting the weight and bias on this one neuron network. When you feel like you\u2019ve lowered the loss enough (or need some help), reveal the graph."}),Object(f.jsx)("br",{}),Object(f.jsx)(W,{}),Object(f.jsx)("br",{}),Object(f.jsx)("p",{children:"The intuition from this one scenario essentially explains all of backpropagation and optimization. It is really that simple!"}),Object(f.jsx)("p",{children:"When you start to change the weight, you observe where the loss moves, if it moves up, you probably move the weight the other direction to lower the loss. This, without the math, is the main principle behind optimizing a nerual network."}),Object(f.jsxs)("p",{children:["The change you observed from the ouput of the loss function is the rate of change. For a more accurate instantaneous rate of change we essentially do the slope formula but have the change the second point approach 0. For Example,",E("\\lim_{h \\to 0} \\frac{f(x + h) - f(x)}{h} = \\frac{df}{dx}")]}),Object(f.jsxs)("p",{children:["Where ",F("\\frac{df}{dx}")," is the derivative of ",F("f")," with respect to ",F("x"),", or in plain english: how the output of"," ",F("f")," is affected by the variable ",F("x"),". In the context of our one neuron network, if I represent weight as ",F("w_0")," bias as ",F("b"),", the neuron as ",F("n")," and mean squared error loss"," ",F("\\text{MSE}"),E("\\lim_{h \\to 0} \\frac{\\text{MSE}(n(w_0 + h,b)) - \\text{MSE}(n(w_0,b))}{h} = \\frac{\\partial \\text{MSE}}{\\partial w_0}"),E("\\lim_{h \\to 0} \\frac{\\text{MSE}(n(w_0,b+h)) - \\text{MSE}(n(w_0,b))}{h} = \\frac{\\partial \\text{MSE}}{\\partial b}")]}),Object(f.jsxs)("p",{children:["Where ",F("\\frac{\\partial \\text{MSE}}{\\partial w_0}")," is the partial derivative of ",F("\\text{MSE}")," with respect to"," ",F("w_0")," or in plain english: how the output of"," ",F("\\text{MSE}")," is affected by the variable ",F("w_0"),"."]}),Object(f.jsxs)("p",{children:["Where ",F("\\frac{\\partial \\text{MSE}}{\\partial b}")," is the partial derivative of ",F("\\text{MSE}")," with respect to"," ",F("b")," or in plain english: how the output of"," ",F("\\text{MSE}")," is affected by the variable ",F("b"),"."]}),Object(f.jsxs)("p",{children:["Now we have a way to compute how each parameter affects the output loss ",F("\\text{MSE}"),". Which is also called the gradient of ",F("\\text{MSE}"),".And can use the intuiton we gained from the interactive exercise before, and use the partial derivatives of loss with respect to each parameter to tune those paramters into lowering the loss."]}),Object(f.jsxs)("p",{children:["Backpropagation is the term we use to describe the calculuating of the partial derivatives of with respect to each paramter because of the direction we travel to compute the derivatives. In essence, we first need to forward propagate: push the input through the network, get an output and loss. We then can go backwards and compute how each value in the forward pass affected the loss using the chain rule in calculus. The chain rule is very intutive and essentially takes into account how nested function affect each other.",E("\\frac{\\partial \\text{MSE}}{\\partial w_0} = \\frac{\\partial \\text{MSE}}{\\partial n(w_0,b)} \\cdot \\frac{\\partial n(w_0,b)}{\\partial w_0} "),E("\\frac{\\partial \\text{MSE}}{\\partial b} = \\frac{\\partial \\text{MSE}}{\\partial n(w_0,b)} \\cdot \\frac{\\partial n(w_0,b)}{\\partial b} ")]}),Object(f.jsxs)("p",{children:["Where how ",F("\\frac{\\partial \\text{MSE}}{\\partial w_0}")," ","(how ",F("w_0")," affects loss) is broken up into how the input of loss (the output of the neuron) affects loss compounded with how the weight affects the output of the neuron. Essnetially we are chaining rates of change due to the nested nature of the function."]}),Object(f.jsxs)(z.a,{variant:"h6",children:["Let's go through a concrete example of a forward and backward pass. We will define the input as ",F("x_0 = 2.1"),", the weight as ",F("w_0 = 1"),", and the bias as ",F("b = 0")," "]}),Object(f.jsx)("img",{width:"100%",src:D}),Object(f.jsxs)(z.a,{variant:"h6",children:["Now we can go backwards and compute partial derivatives with the chain rule to get the gradient ",F("\\nabla \\text{loss}")]}),Object(f.jsx)("img",{width:"100%",src:I}),Object(f.jsxs)(z.a,{variant:"h6",children:[E("\\frac{\\partial \\text{loss}}{\\partial w_0} = -7.98"),E("\\frac{\\partial \\text{loss}}{\\partial b} = -3.8")]}),Object(f.jsxs)(z.a,{variant:"h6",children:["Reassign the parameters to opposite gradient to descend loss, in this case learning rate is ",F("\\text{lr} = 0.01"),E("w_0 := w_0 - \\text{lr} \\cdot \\frac{\\partial \\text{loss}}{\\partial w_0} = (1) - (0.01) \\cdot (-7.98) = 1.0798"),E("b := b - \\text{lr} \\cdot \\frac{\\partial \\text{loss}}{\\partial b} = (0) - (0.01) \\cdot (-3.8) = 0.038 "),"Re calculate forward pass with new weight and bias",E("\\text{loss} = ((1.0798)(2.1) + 0.038) - 4)^2 = 2.87")]}),Object(f.jsxs)(z.a,{variant:"h6",children:["Total loss savings of ",F("3.61 - 2.87 = 0.74")]}),Object(f.jsx)("p",{children:"To see this in action over many epochs try out playing the next component which computes forward, backward and update per epoch. Automatically."}),Object(f.jsx)(J,{}),Object(f.jsx)("h1",{children:"Scaling up to larger networks"}),Object(f.jsx)("p",{children:"When scaling up to more neurons with more layers, the principles stay the same. The only difference now is we are going further back with chain rule to calculate more derivatives."}),Object(f.jsx)("p",{children:"And to spice things up, we\u2019ll add the activation function ReLU to neurons on the hidden layers so we can fit some non-linear data as opposed to boring linear data."}),Object(f.jsxs)("ul",{children:[Object(f.jsx)("li",{children:"First feed the values through the network. Forward Propagation."}),Object(f.jsx)("li",{children:"Calculate the derivative of loss with respect to each variable (going backwards using the chain rule)"}),Object(f.jsx)("li",{children:"update the parameters with gradient descent"})]}),Object(f.jsx)("p",{children:"Now that you see the underlying logic, Use the explainer tool below. Start by pressing play to train the network and click EPOCH when you want to see the whole process (forward, backward, update) at that particular epoch. If you need help or are confused press on the associated question mark."}),Object(f.jsx)("p",{children:"In explainer mode, make sure to color each neuron, this represents the activation (output of the neuron), and in the backwards propagation the orange arrow which represents the computed derivative of loss with respect to the activation."})]});return Object(f.jsx)(L.a,{justifyContent:"center",display:"flex",children:Object(f.jsxs)(L.a,{maxWidth:"65%",children:[e,t]})})},K=a(20),Q=a(254),$=a.n(Q),ee=a(602),te=a(604),ae=a(601),ne=a(596),re=a(598),se=a(595),ie=a(597),oe=a.p+"static/media/controlcenter.3793afef.gif",ce=a.p+"static/media/customization.05bd2f71.gif",le=a.p+"static/media/nn.984f5d8c.png",he=a.p+"static/media/scatter.1bf50e5e.gif",ue=function(){function e(t,a){Object(l.a)(this,e),this.weights=t,this.bias=a}return Object(h.a)(e,[{key:"mult",value:function(e,t){return e.map((function(e,a){return e*t[a]}))}},{key:"dMult",value:function(e,t){return this.mult(e,t)}},{key:"sum",value:function(e){return e.reduce((function(e,t){return e+t}))}},{key:"dSum",value:function(e,t){for(var a=[],n=0;n<t;n++)a.push(e);return a}},{key:"linear",value:function(e){return e}},{key:"forward",value:function(e,t){var a=this.weights,n=this.bias,r=this.mult,s=this.sum,i=r(e,a),o=s(i)+n,c=t(o);this.inputs=e,this.multStep=i,this.sumStep=o,this.actStep=c,this.output=c}},{key:"backward",value:function(e,t){var a=this.inputs,n=this.weights,r=this.actStep,s=this.dSum,i=this.mult,o=this.sum,c=t(r)*e,l=s(c,a.length),h=c,u=i(l,a),d=i(l,n),p=o(d);this.dvalue=e,this.dActStep=c,this.dSumStep=l,this.dBias=h,this.dWeights=u,this.dInputs=d,this.dInputsSum=p}}]),e}(),de=function(){function e(){Object(l.a)(this,e)}return Object(h.a)(e,[{key:"forward",value:function(e,t){var a=e-t,n=this.output=Math.pow(e-t,2);this.subStep=a,this.squareStep=n,this.output=n}},{key:"backward",value:function(){this.dInputs=2*this.subStep}}]),e}(),pe=function(){function e(t,a,n){Object(l.a)(this,e),this.model=[],this.loss=new de,this.shape=t;for(var r=0;r<a.length;r++){for(var s=[],i=0;i<a[r].length;i++)s.push(new ue(a[r][i],n[r][i]));this.model.push(s)}}return Object(h.a)(e,[{key:"sum",value:function(e){return e.reduce((function(e,t){return e+t}))}},{key:"add",value:function(e,t){var a=e.length,n=t.length;if(n!=a)return console.error("".concat(a," does not match ").concat(n,", so returned empty array")),[];for(var r=new Array(a),s=0;s<e.length;s++)r[s]=e[s]+t[s];return r}},{key:"zeros",value:function(e){for(var t=new Array(e),a=0;a<e;a++)t[a]=0;return t}},{key:"dReLU",value:function(e){return e>0?1:0}},{key:"dLinear",value:function(e){return 1}},{key:"ReLU",value:function(e){return Math.max(0,e)}},{key:"linear",value:function(e){return e}},{key:"forward",value:function(e,t){for(var a=[e],n=this.model.length,r=0;r<n-1;r++){for(var s=[],i=0;i<this.model[r].length;i++)this.model[r][i].forward(a,this.ReLU),s.push(this.model[r][i].output);a=s}this.model[n-1][0].forward(a,this.linear),this.yhat=this.model[n-1][0].output,this.loss.forward(this.yhat,t)}},{key:"backward",value:function(){this.sum;var e=this.add,t=this.zeros;this.loss.backward();var a=[this.loss.dInputs],n=this.model.length;this.model[n-1][0].backward(a[0],this.dLinear),a=this.model[n-1][0].dInputs;for(var r=n-2;r>=0;r--){for(var s=t(this.model[r][0].inputs.length),i=0;i<this.model[r].length;i++)this.model[r][i].backward(a[i],this.dReLU),s=e(s,this.model[r][i].dInputs);a=s}}},{key:"update",value:function(e){for(var t=function(e,t,a){return e-t*a},a=0;a<this.model.length;a++)for(var n=0;n<this.model[a].length;n++)for(var r=0;r<this.model[a][n].dWeights.length;r++){var s=t(this.model[a][n].weights[r],e,this.model[a][n].dWeights[r]),i=t(this.model[a][n].bias,e,this.model[a][n].dBias);this.model[a][n].weights[r]=s,this.model[a][n].bias=i}}},{key:"throttleForward",value:function(e,t,a,n){var r=this.model[t][e].output+a;this.model[t][e].output=r;for(var s=[],i=0;i<this.model[t].length;i++)s.push(this.model[t][i].output);for(var o=this.model.length,c=t+1;c<o-1;c++){for(var l=[],h=0;h<this.model[c].length;h++)this.model[c][h].forward(s,this.ReLU),l.push(this.model[c][h].output);s=l}this.model[o-1][0].forward(s,this.linear),this.yhat=this.model[o-1][0].output,this.loss.forward(this.yhat,n)}}]),e}();function je(e,t){for(var a=[],n=0;n<e.length;n++){for(var r=t[n+1],s=[],i=0;i<r;i++){for(var o=[],c=i;c<e[n].length;c+=r)o.push(e[n][c]);s.push(o)}a.push(s)}return a}function be(e,t){for(var a=0;a<e.length;a++)for(var n=0;n<e[a].length;n++)e[a][n]=+e[a][n].toFixed(t);return e}function fe(e){for(var t=[],a=0;a<e.length;a++)for(var n=0;n<e[a].length;n++)t.push(e[a][n]);return t}function xe(e){return Math.floor(Math.random()*Math.floor(e))}function ge(e){return Array.from(e.dataSync())}function me(e,t){return{xScale:b.p().domain(e.domain).range(e.range),yScale:b.p().domain(t.domain).range(t.range)}}function ye(e){return b.k().x((function(t){return t.x+e})).y((function(t){return t.y+e}))}function ve(e,t,a,n,r,s,i){var o=[],c=[];o.push([n]),c.push(n);for(var l=1;l<e.length-1;l++){for(var h=[],u=0;u<e[l];u++){var d={x:s(t[l])-a/2,y:i(92-12*u)-a/2};h.push(d),c.push(d)}o.push(h)}return c.push(r),o.push([r]),{flattenedNeurons:c,shapedNeurons:o}}function Oe(e,t,a){for(var n=[],r=[],s=[],i=1;i<e.length;i++){s=[];for(var o=0;o<e[i];o++){n=[];for(var c=0;c<e[i-1];c++)n.push(a({source:t[i-1][c],target:t[i][o]}));s.push(n)}r.push(s)}return r}var we=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={tensorFlowNN:null,miniNN:null,X:[],y:[],yhat:[],shape:[1,8,8,1],lr:.001,epoch:0,cpyEpoch:0,biasesData:[],weightsData:[],lossArray:[],loss:null,scale:5,rects:[],weights:[],shapedWeights:[],shapedRects:[],shapedLinks:[],direction:"edgePaused",curve:"sin",controls:{playing:!1,speed:100},sliderVal:2,mode:!1,stopRender:!1,keyFrameLayer:0,keyFrameLoss:0,keyFrameScatter:0,subEpoch:"",isAnimating:!1,lossSavings:0,lossDifference:0,singleInputExample:0,singleLabelExample:0,newOutput:0,controlCenterHelp:!1,customizationHelp:!1,neuralNetworkHelp:!1,scatterHelp:!1,lossHelp:!1,lossChange:0,potentialYhat:[],singleInputIndex:-1},n.initNeuralNetwork=n.initNeuralNetwork.bind(Object(N.a)(n)),n.run=n.run.bind(Object(N.a)(n)),n.genTensorData=n.genTensorData.bind(Object(N.a)(n)),n.mutate=n.mutate.bind(Object(N.a)(n)),n.train=n.train.bind(Object(N.a)(n)),n.printParameters=n.printParameters.bind(Object(N.a)(n)),n.reset=n.reset.bind(Object(N.a)(n)),n.resetParameters=n.resetParameters.bind(Object(N.a)(n)),n.asyncPause=n.asyncPause.bind(Object(N.a)(n)),n.changeModelLr=n.changeModelLr.bind(Object(N.a)(n)),n.anim=n.anim.bind(Object(N.a)(n)),n.randomInputGeneration=n.randomInputGeneration.bind(Object(N.a)(n)),n}return Object(h.a)(a,[{key:"randomInputGeneration",value:function(e,t,a,r,s,i,o){var c=n.getRandomInt(50),l=e[c],h=t[c],u=n.formatWeightArray(a,s),d=new pe(s,u,r),p=new pe(s,u,r);d.forward(l,h),d.backward(),p.forward(l,h),p.backward(),p.update(i),p.forward(l,h);var j=p.yhat,b=p.loss.output,f=b,x=d.loss.output-b,g=function(e){for(var t=e.length,a=new Array(t),n=0;n<t;n++)p.forward(e[n],0),a[n]=p.yhat;return a}(e);this.setState(Object(_.a)(Object(_.a)({},this.state),{},{miniNN:d,potentialYhat:g,mode:!0,lossSavings:f,lossDifference:x,singleInputIndex:c,singleInputExample:l,singleLabelExample:h,newOutput:j,controls:Object(_.a)(Object(_.a)({},this.state.controls),{},{playing:!1})}))}},{key:"anim",value:function(){var e=Object(O.a)(v.a.mark((function e(){var t,a,n,r,s;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.state.shape,a=750,n=function(e){return new Promise((function(t){return setTimeout(t,e)}))},this.setState({subEpoch:"forward",isAnimating:!0,lossChange:0,cpyEpoch:this.state.epoch,keyFrameScatter:0}),r=0;case 5:if(!(r<t.length)){e.next=14;break}if(this.setState({keyFrameLayer:r}),r!==t.length-1){e.next=9;break}return e.abrupt("continue",11);case 9:return e.next=11,n(a);case 11:r++,e.next=5;break;case 14:return this.setState({keyFrameLoss:1}),e.next=17,n(a);case 17:return this.setState({keyFrameLoss:2}),e.next=20,n(a);case 20:this.setState({keyFrameLoss:3}),this.setState({lossChange:this.state.miniNN.loss.output,keyFrameScatter:1}),this.setState({subEpoch:"backward",keyFrameScatter:2}),s=t.length-1;case 24:if(!(s>=0)){e.next=31;break}return this.setState({keyFrameLayer:s}),e.next=28,n(a);case 28:s--,e.next=24;break;case 31:return this.setState({keyFrameLayer:-1}),e.next=34,n(a);case 34:return this.setState({subEpoch:"transition"}),e.next=37,n(1e3);case 37:return this.setState({subEpoch:"update"}),e.next=40,n(1e3);case 40:this.setState({isAnimating:!1,lossChange:this.state.lossSavings,keyFrameScatter:4,cpyEpoch:this.state.cpyEpoch+1});case 41:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"initNeuralNetwork",value:function(e){var t=this.state.controls.playing;if(t){if(t){var a=this.state,s=a.weightsData,i=a.shape,o=n.flatten(s),c=n.formatWeightArray(s,i);this.setState({weights:o,shapedWeights:c})}}else{var l=32,h=r.generateLinearScale({domain:[0,100],range:[50,750]},{domain:[0,100],range:[500,0]}),u=h.xScale,d=h.yScale,p={x:34,y:234},j={x:734,y:234},b=r.generateLink(16),f=r.generateNeuronPlacement(e,[0,25,50,75,0],l,p,j,u,d),x=f.flattenedNeurons,g=f.shapedNeurons,m=r.generateLinksPlacement(e,g,b);g.splice(0,1),this.setState({shapedLinks:m,rects:x,shapedRects:g})}}},{key:"changeModelLr",value:function(e){var t=this;R.r((function(){t.setState({lr:e})}))}},{key:"run",value:function(){var e=Object(O.a)(v.a.mark((function e(){var t;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=!this.state.controls.playing,this.mutate("controls","playing",t),!0!==t){e.next=5;break}return e.next=5,this.train(this.state.X,this.state.y);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"mutate",value:function(e,t,a){var n=this;R.r((function(){var r=Object(_.a)({},n.state);e in r&&t in r[e]?(r[e][t]=a,n.setState({state:r})):console.error("Could not be found in state")}))}},{key:"addModel",value:function(e){var t=this;return R.r((function(){var a=t.state.shape;e.add(R.d.dense({inputShape:[1],units:a[1],activation:"relu",useBias:!0}));for(var n=2;n<a.length-1;n++)e.add(R.d.dense({units:a[n],activation:"relu",useBias:!0}));return e.add(R.d.dense({units:1,activation:"linear",useBias:!0})),e}))}},{key:"modelCompile",value:function(e){var t=R.k();return this.addModel(t),t.compile({optimizer:R.s.sgd(e),loss:"meanSquaredError"}),t}},{key:"train",value:function(){var e=Object(O.a)(v.a.mark((function e(t,a){var r,s,i,o,c,l,h,u,d=this;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=R.r((function(){return R.q(t)})),s=R.r((function(){return R.q(a)})),i=R.r((function(){return d.state.tensorFlowNN})),o=function(e){return new Promise((function(t){return setTimeout(t,e)}))},c=this.state.controls.playing;case 5:if(!1===c){e.next=17;break}return this.setState({stopRender:!0}),l=this.state.controls,h=l.playing,u=l.speed,c=h,e.next=11,i.fit(r,s,{epochs:1,batchSize:1});case 11:return R.r((function(){var e=i.predict(r),t=n.tensorToArray(e),s=R.f.meanSquaredError(a,t).dataSync()[0];d.printParameters(i,s,t,d.state.epoch+1)})),this.setState({stopRender:!1}),e.next=15,o(u);case 15:e.next=5;break;case 17:this.setState({tensorFlowNN:i}),R.c(r),R.c(s);case 20:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"genTensorData",value:function(){var e=Object(O.a)(v.a.mark((function e(t,a,r){var s=this;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,R.j();case 2:R.r((function(){var e=R.e(-s.state.scale,s.state.scale,r),i=R.h(t(e),a),o=R.t(e),c=n.tensorToArray(e),l=n.tensorToArray(i),h=n.tensorToArray(o);s.setState({X:c,y:l,yhat:h})}));case 3:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}()},{key:"printParameters",value:function(e,t,a,n){for(var r=[],s=[],i=0;i<e.getWeights().length;i++)(i%2===0?r:s).push(Array.from(e.getWeights()[i].dataSync()));var o=[].concat(Object(K.a)(this.state.lossArray),[t]);this.setState({biasesData:s,weightsData:r,loss:t,yhat:a,epoch:n,lossArray:o}),this.initNeuralNetwork(this.state.shape)}},{key:"asyncPause",value:function(){var e=Object(O.a)(v.a.mark((function e(){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.setState({controls:Object(_.a)(Object(_.a)({},this.state.controls),{},{playing:!1})});case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"resetParameters",value:function(){var e=Object(O.a)(v.a.mark((function e(t){var a,n,r,s=this;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return R.c(this.state.tensorFlowNN),a=this.state.curve,R.r((function(){"sin"===a?n=R.m:"tanh"===a?n=R.p:"cos"===a&&(n=R.b)})),e.next=5,this.genTensorData(n,t,50);case 5:r=R.r((function(){return s.modelCompile(s.state.lr)})),this.setState({epoch:0,loss:null,weights:[],miniNN:null,tensorFlowNN:r,shapedWeights:[],lossArray:[]}),R.c(undefined);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"reset",value:function(){var e=Object(O.a)(v.a.mark((function e(t){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.asyncPause(),this.resetParameters(t);case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){var e=Object(O.a)(v.a.mark((function e(){var t,a=this;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:R.l("cpu"),this.genTensorData(R.m,this.state.scale,50),this.initNeuralNetwork(this.state.shape),t=R.r((function(){return a.modelCompile(.01)})),this.setState({tensorFlowNN:t});case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"shouldComponentUpdate",value:function(){return!this.state.stopRender}},{key:"render",value:function(){var e=this,t=this.state,a=t.X,n=t.y,r=t.shape,s=t.scale,i=t.miniNN,o=t.weightsData,c=t.biasesData,l=t.yhat,h=t.rects,u=t.weights,d=t.mode,p=t.epoch,j=t.curve,b=t.lr,x=t.loss,g=t.controls,y=t.shapedWeights,C=t.shapedLinks,F=t.shapedRects,E=t.keyFrameLayer,N=t.keyFrameLoss,D=t.subEpoch,I=t.isAnimating,W=t.singleInputExample,q=t.singleLabelExample,J=t.lossSavings,Z=t.controlCenterHelp,K=t.customizationHelp,Q=t.neuralNetworkHelp,ue=t.lossChange,de=t.scatterHelp,pe=t.keyFrameScatter,je=g.playing,be=g.speed,fe=[{label:"sin",eqn:R.m,scale:5},{label:"cos",eqn:R.b,scale:5},{label:"tanh",eqn:R.p,scale:5}],xe=Object(f.jsx)(U.a,{style:{background:this.state.controls.playing?"#D62839":"#175676",color:"white"},disableTouchRipple:!0,onClick:function(){return e.run()},children:je?Object(f.jsx)(V.a,{}):Object(f.jsx)(G.a,{})}),ge=Object(f.jsxs)(B.a,{children:[Object(f.jsx)(ee.a,{title:"reset",arrow:!0,children:Object(f.jsx)(H.a,{disabled:je,onClick:function(){e.reset(s)},children:Object(f.jsx)(X.a,{})})}),xe,Object(f.jsx)(ee.a,{title:"slomo",arrow:!0,children:Object(f.jsx)(H.a,{style:{color:0===be?"grey":"#FFC006"},onClick:function(){e.setState({controls:Object(_.a)(Object(_.a)({},g),{},{speed:0===be?100:0})})},children:Object(f.jsx)(Y.a,{})})})]}),me=Object(f.jsx)(L.a,{marginTop:2,children:Object(f.jsxs)(B.a,{children:[Object(f.jsxs)(T.a,{onClick:Object(O.a)(v.a.mark((function t(){return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.anim();case 2:case"end":return t.stop()}}),t)}))),disabled:I,style:{color:I?"lightgrey":"black"},variant:"outlined",children:[Object(f.jsx)(X.a,{})," ","  ","REPLAY"]}),Object(f.jsx)(T.a,{onClick:Object(O.a)(v.a.mark((function t(){return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.randomInputGeneration(a,n,o,c,r,b,d),t.next=3,e.anim();case 3:case"end":return t.stop()}}),t)}))),style:{color:I?"lightgrey":"#4BA3C3"},disabled:I,variant:"outlined",children:"New Training Example"})]})}),ye=Object(f.jsxs)(L.a,{width:400,marginLeft:10,children:[Object(f.jsx)(M.a,{variant:"outlined",children:Object(f.jsxs)(A.a,{children:[Object(f.jsxs)(z.a,{variant:"caption",style:{color:"#4BA3C3"},children:["Control Center",Object(f.jsx)(H.a,{size:"small",style:{color:"orange"},onClick:function(){e.setState({controlCenterHelp:!0})},children:Object(f.jsx)(se.a,{})})]}),Object(f.jsx)("div",{}),Object(f.jsx)(ee.a,{title:Object(f.jsx)(z.a,{variant:"h6",children:d?"Click: Back":"Click: Epoch Mode"}),arrow:!0,placement:"right-start",open:null!==x||d&&!I,children:Object(f.jsx)(T.a,{disabled:null==x||I,onClick:Object(O.a)(v.a.mark((function t(){return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!d){t.next=5;break}e.setState({subEpoch:""}),e.setState({mode:!d}),t.next=8;break;case 5:return e.randomInputGeneration(a,n,o,c,r,b,d),t.next=8,e.anim();case 8:case"end":return t.stop()}}),t)}))),children:Object(f.jsxs)(z.a,{variant:"h4",children:["Epoch: ",d?this.state.cpyEpoch:p]})})}),d?Object(f.jsxs)(B.a,{children:[Object(f.jsx)(z.a,{style:{color:"orange"},variant:"h6",children:"Phase:"}),Object(f.jsx)(T.a,{disabled:!0,style:{color:"forward"===D?"orange":"grey"},children:"Forward"}),Object(f.jsx)(T.a,{disabled:!0,style:{color:"backward"===D?"orange":"grey"},children:"Backward"}),Object(f.jsx)(T.a,{disabled:!0,style:{color:"update"===D?"orange":"grey"},children:"Update"})]}):"",Object(f.jsx)(z.a,{variant:"h6",children:null==x||d?"":"Loss: ".concat(x.toPrecision(6))}),Object(f.jsx)(z.a,{variant:"h6",style:{color:"#4BA3C3"},children:d?"Training Example: (".concat(W.toPrecision(3),", ").concat(q.toPrecision(3),")"):""}),Object(f.jsxs)(z.a,{variant:"h5",style:{color:pe<3?"black":"orangered"},children:[d&&0!=ue?pe<3?"loss: ":"new loss: ":"",d&&0!=ue?Object(f.jsx)($.a,{value:ue,formatValue:function(e){return e.toPrecision(6)},duration:750}):""]}),Object(f.jsxs)(z.a,{style:{color:"grey"},variant:"caption",children:[pe>3&&d?"loss decrease: ":"",pe>3&&d?Object(f.jsx)($.a,{value:this.state.lossDifference,formatValue:function(e){return e.toPrecision(6)},duration:750}):""]}),d?me:ge,Object(f.jsx)(B.a,{})]})}),Object(f.jsx)(L.a,{marginTop:5,children:Object(f.jsx)(M.a,{variant:"outlined",children:Object(f.jsxs)(A.a,{children:[Object(f.jsxs)(z.a,{variant:"caption",style:{color:"#4BA3C3"},children:["Customization ",Object(f.jsx)(H.a,{size:"small",style:{color:"orange"},onClick:function(){e.setState({customizationHelp:!0})},children:Object(f.jsx)(se.a,{})})]}),Object(f.jsxs)(B.a,{children:[Object(f.jsx)(z.a,{variant:"caption",children:"Learning Rate"}),[.001,.005,.01,.05,.1].map((function(t,a){return Object(f.jsx)(te.a,{disabled:je||d,label:"".concat(t),style:{color:b===t?"white":"grey",background:b===t?"#175676":"lightgrey"},onClick:function(){R.r((function(){e.changeModelLr(t),e.reset(s)}))}},a)}))]}),Object(f.jsxs)(B.a,{children:[Object(f.jsx)(z.a,{variant:"caption",children:"Data Set"}),fe.map((function(t,a){return Object(f.jsx)(te.a,{disabled:je||d,label:t.label,style:{color:j===t.label?"white":"grey",background:j===t.label?"#175676":"lightgrey"},onClick:function(){e.setState({shape:r,curve:t.label}),e.reset(s),R.r((function(){e.genTensorData(t.eqn,t.scale,50)}))}},a)}))]}),Object(f.jsxs)(B.a,{children:[Object(f.jsx)(z.a,{variant:"caption",children:"Neurons"}),Object(f.jsx)(P.a,{style:{color:"#175676"},defaultValue:2,disabled:je||d,"aria-labelledby":"discrete-slider",valueLabelDisplay:"auto",step:1,marks:!0,onChange:function(t,a){e.setState({sliderVal:a})},min:1,max:8}),Object(f.jsx)(T.a,{disabled:je||d,onClick:function(){var t=r;t.length<5&&(t[t.length-1]=e.state.sliderVal,t.push(1),e.setState({shape:t}),e.initNeuralNetwork(t),e.reset(s))},children:"+"}),Object(f.jsx)(T.a,{disabled:je||d,onClick:function(){var t=r;t.length>2&&(t.splice(t.length-2,1),e.setState({shape:t}),e.initNeuralNetwork(t),e.reset(s))},children:"\u2013"})]})]})})})]}),ve=Object(f.jsxs)(L.a,{marginLeft:10,children:[Object(f.jsxs)(L.a,{children:[d?Object(f.jsx)(k,{width:300,height:300,padding:0,start:-s,stop:s,X:a,y:n,yhat:l,potential:this.state.potentialYhat,id:2,select:this.state.singleInputIndex,times:this.state.keyFrameScatter}):Object(f.jsx)(w,{width:300,height:300,padding:0,start:-s,stop:s,X:a,y:n,yhat:l,id:1,duration:100,select:-1}),Object(f.jsx)(H.a,{size:"small",style:{color:"orange",position:"relative",bottom:"300px",right:"40px"},onClick:function(){e.setState({scatterHelp:!0})},children:Object(f.jsx)(se.a,{})})]}),Object(f.jsx)(L.a,{marginTop:10,children:Object(f.jsx)(S,{lossArray:this.state.lossArray,duration:100})})]}),Oe=Object(f.jsxs)(L.a,{children:[Object(f.jsx)(m,{miniNN:i,input:W,label:q,shapedWeights:y,shapedLinks:C,shapedRects:F,shape:r,biases:c,weights:u,rects:h,playing:je?0===be?"edgeForward":"edgeSlowed":"edgePaused",show:je,mode:d,backward:this.state.direction,keyFrameLayer:E,keyFrameLoss:N,subEpoch:D,lossSavings:J,isAnimating:I,lr:b}),Object(f.jsx)(H.a,{size:"small",style:{color:"orange",position:"relative",bottom:"500px",left:"100px"},onClick:function(){e.setState({neuralNetworkHelp:!0})},children:Object(f.jsx)(se.a,{})})]});return Object(f.jsxs)("div",{id:"app",children:[Object(f.jsx)(M.a,{variant:"outlined",style:{background:"#FAFAFA",outlineColor:"white",paddingBottom:"1em"},children:Object(f.jsx)(A.a,{children:Object(f.jsxs)(L.a,{className:"regular",display:"flex",justifyContent:"center",marginTop:10,children:[Oe,ve,ye]})})}),Object(f.jsxs)(ae.a,{PaperProps:{style:{backgroundColor:"#F7F7F7"}},open:Z,children:[Object(f.jsx)(ne.a,{children:Object(f.jsx)(H.a,{onClick:function(){e.setState({controlCenterHelp:!1})},children:Object(f.jsx)(ie.a,{})})}),Object(f.jsxs)(re.a,{children:[Object(f.jsx)("img",{src:oe,alt:"how to use control center",width:"100%"}),Object(f.jsxs)(z.a,{variant:"caption",children:["The ",Object(f.jsx)("em",{children:"control"})," center is where you"," ",Object(f.jsx)("em",{children:"control"})," the flow of the program. You can play, pause, slow down and reset."]}),Object(f.jsx)(L.a,{display:"flex",justifyContent:"center",children:Object(f.jsxs)(L.a,{marginBottom:5,children:[Object(f.jsx)(z.a,{variant:"h6",children:"What is an Epoch?"}),Object(f.jsx)(z.a,{variant:"body2",children:"An epoch is single iteration of training."}),Object(f.jsx)(z.a,{variant:"h6",children:"What is Loss?"}),Object(f.jsx)(z.a,{variant:"body2",children:"Loss tells you the error of the current predicitions. Lower is better."}),Object(f.jsx)(z.a,{variant:"h6",children:"How Do I go into Backpropogation Mode?"}),Object(f.jsx)(z.a,{variant:"body2",children:"Click on the EPOCH"})]})})]})]}),Object(f.jsxs)(ae.a,{PaperProps:{style:{backgroundColor:"#F7F7F7"}},open:K,children:[Object(f.jsx)(ne.a,{children:Object(f.jsx)(H.a,{onClick:function(){e.setState({customizationHelp:!1})},children:Object(f.jsx)(ie.a,{})})}),Object(f.jsxs)(re.a,{children:[Object(f.jsx)("img",{src:ce,alt:"how to use control center",width:"100%"}),Object(f.jsxs)(z.a,{variant:"caption",children:["The ",Object(f.jsx)("em",{children:"customization"})," is where you"," ",Object(f.jsx)("em",{children:"customize"})," data, learning rate, and model shape."]}),Object(f.jsx)(L.a,{display:"flex",justifyContent:"center",children:Object(f.jsxs)(L.a,{marginBottom:5,children:[Object(f.jsx)(z.a,{variant:"h6",children:"What is an Learning Rate?"}),Object(f.jsx)(z.a,{variant:"body2",children:"Learning rate roughly translates to the magnitiude of change each time parameters are updated. You could think of it as how big your steps are down a gradient."}),Object(f.jsx)(z.a,{variant:"body2",children:"The learning rate is applied to the opposite gradient after backpropogation."}),Object(f.jsx)(z.a,{variant:"h6",children:"Why would I change learning rate?"}),Object(f.jsx)(z.a,{variant:"body2",children:"Depending on the shape of the model and the amount of data,a higher learning rate could allow your model to take less epochs to reach the target loss. But if the learning rate is too large, you will never reach the minimum of loss that you want."})]})})]})]}),Object(f.jsxs)(ae.a,{PaperProps:{style:{backgroundColor:"#FAFAFA"}},open:Q,children:[Object(f.jsx)(ne.a,{children:Object(f.jsx)(H.a,{onClick:function(){e.setState({neuralNetworkHelp:!1})},children:Object(f.jsx)(ie.a,{})})}),Object(f.jsxs)(re.a,{children:[Object(f.jsx)("img",{src:le,alt:"how to use control center",width:"100%"}),Object(f.jsx)(L.a,{display:"flex",justifyContent:"center",children:Object(f.jsxs)(L.a,{marginBottom:5,children:[Object(f.jsx)(z.a,{variant:"h6",children:"Summary"}),Object(f.jsx)(z.a,{variant:"body2",children:"Each grey square with a black outline is a neuron. Each connection indicates where the inputs travel. The thikness and the color of each connection also indicate the weight associated."}),Object(f.jsx)(z.a,{variant:"body2",children:"As the weights change, there will be a visible change in stroke size."})]})})]})]}),Object(f.jsxs)(ae.a,{PaperProps:{style:{backgroundColor:"#F7F7F7"}},open:de,children:[Object(f.jsx)(ne.a,{children:Object(f.jsx)(H.a,{onClick:function(){e.setState({scatterHelp:!1})},children:Object(f.jsx)(ie.a,{})})}),Object(f.jsxs)(re.a,{children:[Object(f.jsx)("img",{src:he,alt:"fitment",width:"100%"}),Object(f.jsx)(L.a,{display:"flex",justifyContent:"center",children:Object(f.jsxs)(L.a,{marginBottom:5,children:[Object(f.jsx)(z.a,{variant:"h6",children:"Summary"}),Object(f.jsx)(z.a,{variant:"body2",children:"The black line represents the current predictions of the neural network."}),Object(f.jsx)(z.a,{variant:"body2",children:"Each gray dot is a xy coordinate that represents the input and input label."})]})})]})]})]})}}]),a}(s.Component),ke=(s.Component,function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={},n}return Object(h.a)(a,[{key:"componentDidMount",value:function(){j.a.initialize("UA-192166007-1"),j.a.pageview("/")}},{key:"render",value:function(){var e=Object(f.jsxs)("div",{children:[Object(f.jsx)("img",{src:p,width:"100%"}),Object(f.jsx)(z.a,{style:{position:"relative",bottom:200,left:100,color:"white"},variant:"h2",children:Object(f.jsx)("b",{children:"How Neural Networks Learn "})}),Object(f.jsx)(z.a,{style:{position:"relative",bottom:200,left:100,color:"white"},variant:"h6",children:"Learn backpropogation and optimization with interactive tools"})]}),t=Object(f.jsx)("div",{children:Object(f.jsx)("h1",{children:"Reserve this space under the main tool for refereces, credit acknowledgements"})});return Object(f.jsxs)("div",{children:[e,Object(f.jsx)(Z,{}),Object(f.jsx)(we,{}),t]})}}]),a}(s.Component)),Se=(a(563),function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,607)).then((function(t){var a=t.getCLS,n=t.getFID,r=t.getFCP,s=t.getLCP,i=t.getTTFB;a(e),n(e),r(e),s(e),i(e)}))});c.a.render(Object(f.jsx)(i.a.StrictMode,{children:Object(f.jsx)(ke,{})}),document.getElementById("root")),Se()}},[[564,1,2]]]);
//# sourceMappingURL=main.a09b9c1b.chunk.js.map